theory SecureDrop begin

// Function signature and definition of the equational theory E

builtins: diffie-hellman
functions: H/4, adec/2, aenc/2, decap/2, encap/2, fst/1, kdf/1,
           pair/2, pk/1, pqpk/1, sdec/2, senc/2, sign/2, snd/1, true/0,
           verify/3
equations:
    adec(aenc(x.1, pk(x.2)), x.2) = x.1,
    decap(encap(k, pqpk(sk)), sk) = k,
    fst(<x.1, x.2>) = x.1,
    sdec(senc(x.1, x.2), x.2) = x.1,
    snd(<x.1, x.2>) = x.2,
    verify(sign(x.1, x.2), x.1, pk(x.2)) = true



heuristic: o "./oracles/malicious_server.py"









rule (modulo E) PQAttackerStart[color=#ff6961]:
   [ ] --[ PQAttack( ), SomeCompromise( ) ]-> [ !PQAttacker( ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) PQAttacker[color=#ff6961]:
   [ !PQAttacker( ), !NonPQSecKey( k ) ] --> [ Out( k ) ]

  /* has exactly the trivial AC variant */

restriction PQAttacker:
  "∀ #compr #t.
    ((PQAttack( ) @ #compr) ∧ (PrePQAttack( ) @ #t)) ⇒ (#t < #compr)"
  // safety formula

rule (modulo E) Register_Newsroom_Key[color=#ff7f50]:
   [ Fr( ~ltk ) ]
  --[ PrePQAttack( ) ]->
   [
   !Ltk_Newsroom( $A, ~ltk ), !Pk_Newsroom( $A, pk(~ltk) ),
   Out( pk(~ltk) ), !NonPQSecKey( ~ltk )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Reveal_Newsroom_Key[color=#ff6961]:
   [ !Ltk_Newsroom( A, ~ltk ) ]
  --[ Reveal_Newsroom_Key( A ), SomeCompromise( ) ]->
   [ Out( ~ltk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Register_Source_Passphrase[color=#ff7f50]:
   [ Fr( ~passphrase ) ]
  --[ Register_Source( 'g'^kdf(<'DH', ~passphrase>) ), PrePQAttack( )
  ]->
   [
   !Ltk_Source_Passphrase( $A, ~passphrase ),
   Ltk_Source_DH_Key_Reveal( $A, kdf(<'DH', ~passphrase>) ),
   Ltk_Source_PKE_Key_Reveal( $A, kdf(<'PKE', ~passphrase>) ),
   Ltk_Source_KEM_Key_Reveal( $A, kdf(<'KEM', ~passphrase>) ),
   !NonPQSecKey( kdf(<'DH', ~passphrase>) ),
   !NonPQSecKey( kdf(<'PKE', ~passphrase>) ),
   Out( <'g'^kdf(<'DH', ~passphrase>), pk(kdf(<'PKE', ~passphrase>)), 
         pqpk(kdf(<'KEM', ~passphrase>))>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Reveal_Source_DH_Key[color=#ff6961]:
   [ Ltk_Source_DH_Key_Reveal( $A, s_dh_sk ) ]
  --[
  Reveal_Source_DH_Key( $A ), Reveal_Source_DH_Key( 'g'^s_dh_sk ),
  SomeCompromise( )
  ]->
   [ Out( s_dh_sk ) ]

  /*
  rule (modulo AC) Reveal_Source_DH_Key[color=#ff6961]:
     [ Ltk_Source_DH_Key_Reveal( $A, s_dh_sk ) ]
    --[
    Reveal_Source_DH_Key( $A ), Reveal_Source_DH_Key( z ),
    SomeCompromise( )
    ]->
     [ Out( s_dh_sk ) ]
    variants (modulo AC)
    1. s_dh_sk
             = s_dh_sk.4
       z     = 'g'^s_dh_sk.4
    
    2. s_dh_sk
             = one
       z     = 'g'
  */

rule (modulo E) Reveal_Source_PKE_Key[color=#ff6961]:
   [ Ltk_Source_PKE_Key_Reveal( $A, s_pke_sk ) ]
  --[
  Reveal_Source_PKE_Key( $A ), Reveal_Source_PKE_Key( pk(s_pke_sk) ),
  SomeCompromise( )
  ]->
   [ Out( s_pke_sk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Reveal_Source_KEM_Key[color=#ff6961]:
   [ Ltk_Source_KEM_Key_Reveal( $A, s_kem_sk ) ]
  --[
  Reveal_Source_KEM_Key( $A ),
  Reveal_Source_KEM_Key( pqpk(s_kem_sk) ), SomeCompromise( )
  ]->
   [ Out( s_kem_sk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Journalist_Enrollment[color=#ff7f50]:
   [ !Ltk_Newsroom( $NR, ~nr_sk ), Fr( ~j_sig_sk ), Fr( ~j_dh_sk ) ]
  --[ Journalist_Verified( $NR, $J ), OnlyOnce( $J ), PrePQAttack( )
  ]->
   [
   Out( <<pk(~j_sig_sk), 'g'^~j_dh_sk>, 
         sign(<'signature', pk(~j_sig_sk), 'g'^~j_dh_sk>, ~nr_sk)>
   ),
   !Journalist_Enrolled( $NR, $J ),
   !Journalist_Signature( $NR, $J, <pk(~j_sig_sk), 'g'^~j_dh_sk>,
                          sign(<'signature', pk(~j_sig_sk), 'g'^~j_dh_sk>, ~nr_sk)
   ),
   !Ltk_Journalist_SIG_Key( $J, ~j_sig_sk ),
   !Ltk_Journalist_DH_Key( $J, ~j_dh_sk ), !NonPQSecKey( ~j_sig_sk ),
   !NonPQSecKey( ~j_dh_sk )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Reveal_Journalist_SIG_Key[color=#ff6961]:
   [ !Ltk_Journalist_SIG_Key( $A, ~j_sig_sk ) ]
  --[
  Reveal_Journalist_SIG_Key( $A ),
  Reveal_Journalist_SIG_Key( pk(~j_sig_sk) ), SomeCompromise( )
  ]->
   [ Out( ~j_sig_sk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Reveal_Journalist_DH_Key[color=#ff6961]:
   [ !Ltk_Journalist_DH_Key( $A, ~j_dh_sk ) ]
  --[
  Reveal_Journalist_DH_Key( $A ),
  Reveal_Journalist_DH_Key( 'g'^~j_dh_sk ), SomeCompromise( )
  ]->
   [ Out( ~j_dh_sk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Journalist_Register_Ephemeral_Key[color=#ff7f50]:
   [
   !Ltk_Journalist_SIG_Key( $J, ~j_sig_sk ), Fr( ~j_edh_sk ),
   Fr( ~j_epke_sk ), Fr( ~j_ekem_sk )
   ]
  --[ PrePQAttack( ) ]->
   [
   Out( <<'g'^~j_edh_sk, pk(~j_epke_sk), pqpk(~j_ekem_sk)>, 
         sign(<'ephemeral', 'g'^~j_edh_sk, pk(~j_epke_sk), pqpk(~j_ekem_sk)
              >,
              ~j_sig_sk)
        >
   ),
   Journalist_Ephemeral_Key( $J, ~j_edh_sk, ~j_epke_sk, ~j_ekem_sk ),
   Journalist_EDH_Key_Reveal( $J, ~j_edh_sk ),
   Journalist_EPKE_Key_Reveal( $J, ~j_epke_sk ),
   Journalist_EKEM_Key_Reveal( $J, ~j_ekem_sk ),
   !NonPQSecKey( ~j_edh_sk ), !NonPQSecKey( ~j_epke_sk )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Reveal_Journalist_EDH_Key[color=#ff6961]:
   [ Journalist_EDH_Key_Reveal( $A, ~j_edh_sk ) ]
  --[
  Reveal_Journalist_EDH_Key( $A ),
  Reveal_Journalist_EDH_Key( 'g'^~j_edh_sk ), SomeCompromise( )
  ]->
   [ Out( ~j_edh_sk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Reveal_Journalist_EPKE_Key[color=#ff6961]:
   [ Journalist_EPKE_Key_Reveal( $J, ~j_epke_sk ) ]
  --[
  Reveal_Journalist_EPKE_Key( $A ),
  Reveal_Journalist_EPKE_Key( pk(~j_epke_sk) ), SomeCompromise( )
  ]->
   [ Out( ~j_epke_sk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Reveal_Journalist_EKEM_Key[color=#ff6961]:
   [ Journalist_EKEM_Key_Reveal( $J, ~j_ekem_sk ) ]
  --[
  Reveal_Journalist_EKEM_Key( $A ),
  Reveal_Journalist_EKEM_Key( pqpk(~j_ekem_sk) ), SomeCompromise( )
  ]->
   [ Out( ~j_ekem_sk ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Source_Send[color=#6495ed]:
   [
   !Ltk_Source_Passphrase( $S, ~passphrase ),
   !Pk_Newsroom( $NR, nr_pk ),
   In( <<j_sig_pk, j_dh_pk>, sig_j_pk, 
        <j_edh_pk, j_epke_pk, j_ekem_pk>, sig_je_pk>
   ),
   Fr( ~me_sk ), Fr( ~msg ), Fr( ~k_pq )
   ]
  --[
  Eq( verify(sig_j_pk, <'signature', j_sig_pk, j_dh_pk>, nr_pk), true
  ),
  Eq( verify(sig_je_pk,
             <'ephemeral', j_edh_pk, j_epke_pk, j_ekem_pk>, j_sig_pk),
      true
  ),
  Source_Sent( 'g'^kdf(<'DH', ~passphrase>), j_sig_pk, j_edh_pk,
               j_ekem_pk, $NR,
               <'msg_s2j', ~msg, 'g'^kdf(<'DH', ~passphrase>), 
                pk(kdf(<'PKE', ~passphrase>)), pqpk(kdf(<'KEM', ~passphrase>)), 
                j_sig_pk, $NR>
  ),
  PrePQAttack( )
  ]->
   [
   Out( <
         aenc(<'cipher_s2j', 'g'^kdf(<'DH', ~passphrase>), 'g'^~me_sk, 
               encap(~k_pq, j_ekem_pk)>,
              j_epke_pk), 
         senc(<'msg_s2j', ~msg, 'g'^kdf(<'DH', ~passphrase>), 
               pk(kdf(<'PKE', ~passphrase>)), pqpk(kdf(<'KEM', ~passphrase>)), 
               j_sig_pk, $NR>,
              H(kdf(<j_edh_pk^kdf(<'DH', ~passphrase>), j_edh_pk^~me_sk, 
                     'g'^~me_sk, j_edh_pk, 'g'^kdf(<'DH', ~passphrase>)>),
                'g'^~me_sk, ~k_pq, encap(~k_pq, j_ekem_pk)))
        >
   ),
   !NonPQSecKey( ~me_sk )
   ]

  /*
  rule (modulo AC) Source_Send[color=#6495ed]:
     [
     !Ltk_Source_Passphrase( $S, ~passphrase ),
     !Pk_Newsroom( $NR, nr_pk ),
     In( <<j_sig_pk, j_dh_pk>, sig_j_pk, 
          <j_edh_pk, j_epke_pk, j_ekem_pk>, sig_je_pk>
     ),
     Fr( ~me_sk ), Fr( ~msg ), Fr( ~k_pq )
     ]
    --[
    Eq( z.2, true ), Eq( z.3, true ),
    Source_Sent( 'g'^kdf(<'DH', ~passphrase>), j_sig_pk, j_edh_pk,
                 j_ekem_pk, $NR,
                 <'msg_s2j', ~msg, 'g'^kdf(<'DH', ~passphrase>), 
                  pk(kdf(<'PKE', ~passphrase>)), pqpk(kdf(<'KEM', ~passphrase>)), 
                  j_sig_pk, $NR>
    ),
    PrePQAttack( )
    ]->
     [
     Out( <
           aenc(<'cipher_s2j', 'g'^kdf(<'DH', ~passphrase>), 'g'^~me_sk, 
                 encap(~k_pq, j_ekem_pk)>,
                j_epke_pk), 
           senc(<'msg_s2j', ~msg, 'g'^kdf(<'DH', ~passphrase>), 
                 pk(kdf(<'PKE', ~passphrase>)), pqpk(kdf(<'KEM', ~passphrase>)), 
                 j_sig_pk, $NR>,
                H(kdf(<z, z.1, 'g'^~me_sk, j_edh_pk, 'g'^kdf(<'DH', ~passphrase>)
                      >),
                  'g'^~me_sk, ~k_pq, encap(~k_pq, j_ekem_pk)))
          >
     ),
     !NonPQSecKey( ~me_sk )
     ]
    variants (modulo AC)
     1. ~me_sk
              = ~me_sk.36
        ~passphrase
              = ~passphrase.38
        j_dh_pk
              = j_dh_pk.39
        j_edh_pk
              = j_edh_pk.40
        j_ekem_pk
              = j_ekem_pk.41
        j_epke_pk
              = j_epke_pk.42
        j_sig_pk
              = j_sig_pk.43
        nr_pk = nr_pk.44
        sig_j_pk
              = sig_j_pk.45
        sig_je_pk
              = sig_je_pk.46
        z     = j_edh_pk.40^kdf(<'DH', ~passphrase.38>)
        z.1   = j_edh_pk.40^~me_sk.36
        z.2   = verify(sig_j_pk.45, <'signature', j_sig_pk.43, j_dh_pk.39>,
                       nr_pk.44)
        z.3   = verify(sig_je_pk.46,
                       <'ephemeral', j_edh_pk.40, j_epke_pk.42, j_ekem_pk.41>,
                       j_sig_pk.43)
    
     2. ~me_sk
              = ~me_sk.43
        ~passphrase
              = ~passphrase.45
        j_dh_pk
              = j_dh_pk.46
        j_edh_pk
              = z.60^inv(kdf(<'DH', ~passphrase.45>))
        j_ekem_pk
              = j_ekem_pk.48
        j_epke_pk
              = j_epke_pk.49
        j_sig_pk
              = j_sig_pk.50
        nr_pk = nr_pk.51
        sig_j_pk
              = sig_j_pk.52
        sig_je_pk
              = sig_je_pk.53
        z     = z.60
        z.1   = z.60^(~me_sk.43*inv(kdf(<'DH', ~passphrase.45>)))
        z.2   = verify(sig_j_pk.52, <'signature', j_sig_pk.50, j_dh_pk.46>,
                       nr_pk.51)
        z.3   = verify(sig_je_pk.53,
                       <'ephemeral', z.60^inv(kdf(<'DH', ~passphrase.45>)), j_epke_pk.49, 
                        j_ekem_pk.48>,
                       j_sig_pk.50)
    
     3. ~me_sk
              = ~me_sk.44
        ~passphrase
              = ~passphrase.46
        j_dh_pk
              = j_dh_pk.47
        j_edh_pk
              = z.62^inv(~me_sk.44)
        j_ekem_pk
              = j_ekem_pk.49
        j_epke_pk
              = j_epke_pk.50
        j_sig_pk
              = j_sig_pk.51
        nr_pk = nr_pk.52
        sig_j_pk
              = sig_j_pk.53
        sig_je_pk
              = sig_je_pk.54
        z     = z.62^(inv(~me_sk.44)*kdf(<'DH', ~passphrase.46>))
        z.1   = z.62
        z.2   = verify(sig_j_pk.53, <'signature', j_sig_pk.51, j_dh_pk.47>,
                       nr_pk.52)
        z.3   = verify(sig_je_pk.54,
                       <'ephemeral', z.62^inv(~me_sk.44), j_epke_pk.50, j_ekem_pk.49>,
                       j_sig_pk.51)
    
     4. ~me_sk
              = ~me_sk.402
        ~passphrase
              = ~passphrase.404
        j_dh_pk
              = j_dh_pk.405
        j_edh_pk
              = x.798^x.799
        j_ekem_pk
              = j_ekem_pk.407
        j_epke_pk
              = j_epke_pk.408
        j_sig_pk
              = j_sig_pk.409
        nr_pk = nr_pk.410
        sig_j_pk
              = sig_j_pk.411
        sig_je_pk
              = sig_je_pk.412
        z     = x.798^(x.799*kdf(<'DH', ~passphrase.404>))
        z.1   = x.798^(~me_sk.402*x.799)
        z.2   = verify(sig_j_pk.411,
                       <'signature', j_sig_pk.409, j_dh_pk.405>, nr_pk.410)
        z.3   = verify(sig_je_pk.412,
                       <'ephemeral', x.798^x.799, j_epke_pk.408, j_ekem_pk.407>,
                       j_sig_pk.409)
    
     5. ~me_sk
              = ~me_sk.404
        ~passphrase
              = ~passphrase.406
        j_dh_pk
              = j_dh_pk.407
        j_edh_pk
              = j_edh_pk.408
        j_ekem_pk
              = j_ekem_pk.409
        j_epke_pk
              = j_epke_pk.410
        j_sig_pk
              = pk(x.803)
        nr_pk = nr_pk.412
        sig_j_pk
              = sig_j_pk.413
        sig_je_pk
              = sign(<'ephemeral', j_edh_pk.408, j_epke_pk.410, j_ekem_pk.409>,
                     x.803)
        z     = j_edh_pk.408^kdf(<'DH', ~passphrase.406>)
        z.1   = j_edh_pk.408^~me_sk.404
        z.2   = verify(sig_j_pk.413, <'signature', pk(x.803), j_dh_pk.407>,
                       nr_pk.412)
        z.3   = true
    
     6. ~me_sk
              = ~me_sk.404
        ~passphrase
              = ~passphrase.406
        j_dh_pk
              = j_dh_pk.407
        j_edh_pk
              = x.802^inv((x.803*kdf(<'DH', ~passphrase.406>)))
        j_ekem_pk
              = j_ekem_pk.409
        j_epke_pk
              = j_epke_pk.410
        j_sig_pk
              = j_sig_pk.411
        nr_pk = nr_pk.412
        sig_j_pk
              = sig_j_pk.413
        sig_je_pk
              = sig_je_pk.414
        z     = x.802^inv(x.803)
        z.1   = x.802^(~me_sk.404*inv((x.803*kdf(<'DH', ~passphrase.406>)))
                      )
        z.2   = verify(sig_j_pk.413,
                       <'signature', j_sig_pk.411, j_dh_pk.407>, nr_pk.412)
        z.3   = verify(sig_je_pk.414,
                       <'ephemeral', x.802^inv((x.803*kdf(<'DH', ~passphrase.406>))), 
                        j_epke_pk.410, j_ekem_pk.409>,
                       j_sig_pk.411)
    
     7. ~me_sk
              = ~me_sk.404
        ~passphrase
              = ~passphrase.406
        j_dh_pk
              = j_dh_pk.407
        j_edh_pk
              = x.802^(x.803*inv(kdf(<'DH', ~passphrase.406>)))
        j_ekem_pk
              = j_ekem_pk.409
        j_epke_pk
              = j_epke_pk.410
        j_sig_pk
              = j_sig_pk.411
        nr_pk = nr_pk.412
        sig_j_pk
              = sig_j_pk.413
        sig_je_pk
              = sig_je_pk.414
        z     = x.802^x.803
        z.1   = x.802^(~me_sk.404*x.803*inv(kdf(<'DH', ~passphrase.406>)))
        z.2   = verify(sig_j_pk.413,
                       <'signature', j_sig_pk.411, j_dh_pk.407>, nr_pk.412)
        z.3   = verify(sig_je_pk.414,
                       <'ephemeral', x.802^(x.803*inv(kdf(<'DH', ~passphrase.406>))), 
                        j_epke_pk.410, j_ekem_pk.409>,
                       j_sig_pk.411)
    
     8. ~me_sk
              = ~me_sk.405
        ~passphrase
              = ~passphrase.407
        j_dh_pk
              = j_dh_pk.408
        j_edh_pk
              = x.801^x.802
        j_ekem_pk
              = j_ekem_pk.410
        j_epke_pk
              = j_epke_pk.411
        j_sig_pk
              = pk(x.805)
        nr_pk = nr_pk.413
        sig_j_pk
              = sig_j_pk.414
        sig_je_pk
              = sign(<'ephemeral', x.801^x.802, j_epke_pk.411, j_ekem_pk.410>,
                     x.805)
        z     = x.801^(x.802*kdf(<'DH', ~passphrase.407>))
        z.1   = x.801^(~me_sk.405*x.802)
        z.2   = verify(sig_j_pk.414, <'signature', pk(x.805), j_dh_pk.408>,
                       nr_pk.413)
        z.3   = true
    
     9. ~me_sk
              = ~me_sk.405
        ~passphrase
              = ~passphrase.407
        j_dh_pk
              = j_dh_pk.408
        j_edh_pk
              = x.803^(x.804*inv((x.805*kdf(<'DH', ~passphrase.407>))))
        j_ekem_pk
              = j_ekem_pk.410
        j_epke_pk
              = j_epke_pk.411
        j_sig_pk
              = j_sig_pk.412
        nr_pk = nr_pk.413
        sig_j_pk
              = sig_j_pk.414
        sig_je_pk
              = sig_je_pk.415
        z     = x.803^(x.804*inv(x.805))
        z.1   = x.803^(~me_sk.405*x.804*
                       inv((x.805*kdf(<'DH', ~passphrase.407>))))
        z.2   = verify(sig_j_pk.414,
                       <'signature', j_sig_pk.412, j_dh_pk.408>, nr_pk.413)
        z.3   = verify(sig_je_pk.415,
                       <'ephemeral', 
                        x.803^(x.804*inv((x.805*kdf(<'DH', ~passphrase.407>)))), 
                        j_epke_pk.411, j_ekem_pk.410>,
                       j_sig_pk.412)
    
    10. ~me_sk
              = ~me_sk.405
        ~passphrase
              = ~passphrase.407
        j_dh_pk
              = j_dh_pk.408
        j_edh_pk
              = x.805^inv((~me_sk.405*kdf(<'DH', ~passphrase.407>)))
        j_ekem_pk
              = j_ekem_pk.410
        j_epke_pk
              = j_epke_pk.411
        j_sig_pk
              = j_sig_pk.412
        nr_pk = nr_pk.413
        sig_j_pk
              = sig_j_pk.414
        sig_je_pk
              = sig_je_pk.415
        z     = x.805^inv(~me_sk.405)
        z.1   = x.805^inv(kdf(<'DH', ~passphrase.407>))
        z.2   = verify(sig_j_pk.414,
                       <'signature', j_sig_pk.412, j_dh_pk.408>, nr_pk.413)
        z.3   = verify(sig_je_pk.415,
                       <'ephemeral', 
                        x.805^inv((~me_sk.405*kdf(<'DH', ~passphrase.407>))), 
                        j_epke_pk.411, j_ekem_pk.410>,
                       j_sig_pk.412)
    
    11. ~me_sk
              = ~me_sk.406
        ~passphrase
              = ~passphrase.408
        j_dh_pk
              = j_dh_pk.409
        j_edh_pk
              = j_edh_pk.410
        j_ekem_pk
              = j_ekem_pk.411
        j_epke_pk
              = j_epke_pk.412
        j_sig_pk
              = j_sig_pk.413
        nr_pk = pk(x.807)
        sig_j_pk
              = sign(<'signature', j_sig_pk.413, j_dh_pk.409>, x.807)
        sig_je_pk
              = sig_je_pk.416
        z     = j_edh_pk.410^kdf(<'DH', ~passphrase.408>)
        z.1   = j_edh_pk.410^~me_sk.406
        z.2   = true
        z.3   = verify(sig_je_pk.416,
                       <'ephemeral', j_edh_pk.410, j_epke_pk.412, j_ekem_pk.411>,
                       j_sig_pk.413)
    
    12. ~me_sk
              = ~me_sk.406
        ~passphrase
              = ~passphrase.408
        j_dh_pk
              = j_dh_pk.409
        j_edh_pk
              = j_edh_pk.410
        j_ekem_pk
              = j_ekem_pk.411
        j_epke_pk
              = j_epke_pk.412
        j_sig_pk
              = pk(x.806)
        nr_pk = pk(x.807)
        sig_j_pk
              = sign(<'signature', pk(x.806), j_dh_pk.409>, x.807)
        sig_je_pk
              = sign(<'ephemeral', j_edh_pk.410, j_epke_pk.412, j_ekem_pk.411>,
                     x.806)
        z     = j_edh_pk.410^kdf(<'DH', ~passphrase.408>)
        z.1   = j_edh_pk.410^~me_sk.406
        z.2   = true
        z.3   = true
    
    13. ~me_sk
              = ~me_sk.406
        ~passphrase
              = ~passphrase.408
        j_dh_pk
              = j_dh_pk.409
        j_edh_pk
              = z.423^inv(kdf(<'DH', ~passphrase.408>))
        j_ekem_pk
              = j_ekem_pk.411
        j_epke_pk
              = j_epke_pk.412
        j_sig_pk
              = pk(x.807)
        nr_pk = nr_pk.414
        sig_j_pk
              = sig_j_pk.415
        sig_je_pk
              = sign(<'ephemeral', z.423^inv(kdf(<'DH', ~passphrase.408>)), 
                      j_epke_pk.412, j_ekem_pk.411>,
                     x.807)
        z     = z.423
        z.1   = z.423^(~me_sk.406*inv(kdf(<'DH', ~passphrase.408>)))
        z.2   = verify(sig_j_pk.415, <'signature', pk(x.807), j_dh_pk.409>,
                       nr_pk.414)
        z.3   = true
    
    14. ~me_sk
              = ~me_sk.406
        ~passphrase
              = ~passphrase.408
        j_dh_pk
              = j_dh_pk.409
        j_edh_pk
              = x.806^inv((~me_sk.406*x.807))
        j_ekem_pk
              = j_ekem_pk.411
        j_epke_pk
              = j_epke_pk.412
        j_sig_pk
              = j_sig_pk.413
        nr_pk = nr_pk.414
        sig_j_pk
              = sig_j_pk.415
        sig_je_pk
              = sig_je_pk.416
        z     = x.806^(inv((~me_sk.406*x.807))*kdf(<'DH', ~passphrase.408>)
                      )
        z.1   = x.806^inv(x.807)
        z.2   = verify(sig_j_pk.415,
                       <'signature', j_sig_pk.413, j_dh_pk.409>, nr_pk.414)
        z.3   = verify(sig_je_pk.416,
                       <'ephemeral', x.806^inv((~me_sk.406*x.807)), j_epke_pk.412, 
                        j_ekem_pk.411>,
                       j_sig_pk.413)
    
    15. ~me_sk
              = ~me_sk.406
        ~passphrase
              = ~passphrase.408
        j_dh_pk
              = j_dh_pk.409
        j_edh_pk
              = x.806^inv((~me_sk.406*x.807*kdf(<'DH', ~passphrase.408>)))
        j_ekem_pk
              = j_ekem_pk.411
        j_epke_pk
              = j_epke_pk.412
        j_sig_pk
              = j_sig_pk.413
        nr_pk = nr_pk.414
        sig_j_pk
              = sig_j_pk.415
        sig_je_pk
              = sig_je_pk.416
        z     = x.806^inv((~me_sk.406*x.807))
        z.1   = x.806^inv((x.807*kdf(<'DH', ~passphrase.408>)))
        z.2   = verify(sig_j_pk.415,
                       <'signature', j_sig_pk.413, j_dh_pk.409>, nr_pk.414)
        z.3   = verify(sig_je_pk.416,
                       <'ephemeral', 
                        x.806^inv((~me_sk.406*x.807*kdf(<'DH', ~passphrase.408>))), 
                        j_epke_pk.412, j_ekem_pk.411>,
                       j_sig_pk.413)
    
    16. ~me_sk
              = ~me_sk.406
        ~passphrase
              = ~passphrase.408
        j_dh_pk
              = j_dh_pk.409
        j_edh_pk
              = x.806^(x.807*inv(~me_sk.406))
        j_ekem_pk
              = j_ekem_pk.411
        j_epke_pk
              = j_epke_pk.412
        j_sig_pk
              = j_sig_pk.413
        nr_pk = nr_pk.414
        sig_j_pk
              = sig_j_pk.415
        sig_je_pk
              = sig_je_pk.416
        z     = x.806^(x.807*inv(~me_sk.406)*kdf(<'DH', ~passphrase.408>))
        z.1   = x.806^x.807
        z.2   = verify(sig_j_pk.415,
                       <'signature', j_sig_pk.413, j_dh_pk.409>, nr_pk.414)
        z.3   = verify(sig_je_pk.416,
                       <'ephemeral', x.806^(x.807*inv(~me_sk.406)), j_epke_pk.412, 
                        j_ekem_pk.411>,
                       j_sig_pk.413)
    
    17. ~me_sk
              = ~me_sk.406
        ~passphrase
              = ~passphrase.408
        j_dh_pk
              = j_dh_pk.409
        j_edh_pk
              = x.806^(x.807*inv((~me_sk.406*kdf(<'DH', ~passphrase.408>))))
        j_ekem_pk
              = j_ekem_pk.411
        j_epke_pk
              = j_epke_pk.412
        j_sig_pk
              = j_sig_pk.413
        nr_pk = nr_pk.414
        sig_j_pk
              = sig_j_pk.415
        sig_je_pk
              = sig_je_pk.416
        z     = x.806^(x.807*inv(~me_sk.406))
        z.1   = x.806^(x.807*inv(kdf(<'DH', ~passphrase.408>)))
        z.2   = verify(sig_j_pk.415,
                       <'signature', j_sig_pk.413, j_dh_pk.409>, nr_pk.414)
        z.3   = verify(sig_je_pk.416,
                       <'ephemeral', 
                        x.806^(x.807*inv((~me_sk.406*kdf(<'DH', ~passphrase.408>)))), 
                        j_epke_pk.412, j_ekem_pk.411>,
                       j_sig_pk.413)
    
    18. ~me_sk
              = ~me_sk.407
        ~passphrase
              = ~passphrase.409
        j_dh_pk
              = j_dh_pk.410
        j_edh_pk
              = z.424^inv(kdf(<'DH', ~passphrase.409>))
        j_ekem_pk
              = j_ekem_pk.412
        j_epke_pk
              = j_epke_pk.413
        j_sig_pk
              = j_sig_pk.414
        nr_pk = pk(x.809)
        sig_j_pk
              = sign(<'signature', j_sig_pk.414, j_dh_pk.410>, x.809)
        sig_je_pk
              = sig_je_pk.417
        z     = z.424
        z.1   = z.424^(~me_sk.407*inv(kdf(<'DH', ~passphrase.409>)))
        z.2   = true
        z.3   = verify(sig_je_pk.417,
                       <'ephemeral', z.424^inv(kdf(<'DH', ~passphrase.409>)), 
                        j_epke_pk.413, j_ekem_pk.412>,
                       j_sig_pk.414)
    
    19. ~me_sk
              = ~me_sk.407
        ~passphrase
              = ~passphrase.409
        j_dh_pk
              = j_dh_pk.410
        j_edh_pk
              = z.424^inv(kdf(<'DH', ~passphrase.409>))
        j_ekem_pk
              = j_ekem_pk.412
        j_epke_pk
              = j_epke_pk.413
        j_sig_pk
              = pk(x.808)
        nr_pk = pk(x.809)
        sig_j_pk
              = sign(<'signature', pk(x.808), j_dh_pk.410>, x.809)
        sig_je_pk
              = sign(<'ephemeral', z.424^inv(kdf(<'DH', ~passphrase.409>)), 
                      j_epke_pk.413, j_ekem_pk.412>,
                     x.808)
        z     = z.424
        z.1   = z.424^(~me_sk.407*inv(kdf(<'DH', ~passphrase.409>)))
        z.2   = true
        z.3   = true
    
    20. ~me_sk
              = ~me_sk.407
        ~passphrase
              = ~passphrase.409
        j_dh_pk
              = j_dh_pk.410
        j_edh_pk
              = x.804^x.805
        j_ekem_pk
              = j_ekem_pk.412
        j_epke_pk
              = j_epke_pk.413
        j_sig_pk
              = j_sig_pk.414
        nr_pk = pk(x.809)
        sig_j_pk
              = sign(<'signature', j_sig_pk.414, j_dh_pk.410>, x.809)
        sig_je_pk
              = sig_je_pk.417
        z     = x.804^(x.805*kdf(<'DH', ~passphrase.409>))
        z.1   = x.804^(~me_sk.407*x.805)
        z.2   = true
        z.3   = verify(sig_je_pk.417,
                       <'ephemeral', x.804^x.805, j_epke_pk.413, j_ekem_pk.412>,
                       j_sig_pk.414)
    
    21. ~me_sk
              = ~me_sk.407
        ~passphrase
              = ~passphrase.409
        j_dh_pk
              = j_dh_pk.410
        j_edh_pk
              = x.804^x.805
        j_ekem_pk
              = j_ekem_pk.412
        j_epke_pk
              = j_epke_pk.413
        j_sig_pk
              = pk(x.808)
        nr_pk = pk(x.809)
        sig_j_pk
              = sign(<'signature', pk(x.808), j_dh_pk.410>, x.809)
        sig_je_pk
              = sign(<'ephemeral', x.804^x.805, j_epke_pk.413, j_ekem_pk.412>,
                     x.808)
        z     = x.804^(x.805*kdf(<'DH', ~passphrase.409>))
        z.1   = x.804^(~me_sk.407*x.805)
        z.2   = true
        z.3   = true
    
    22. ~me_sk
              = ~me_sk.407
        ~passphrase
              = ~passphrase.409
        j_dh_pk
              = j_dh_pk.410
        j_edh_pk
              = x.805^inv((x.806*kdf(<'DH', ~passphrase.409>)))
        j_ekem_pk
              = j_ekem_pk.412
        j_epke_pk
              = j_epke_pk.413
        j_sig_pk
              = pk(x.809)
        nr_pk = nr_pk.415
        sig_j_pk
              = sig_j_pk.416
        sig_je_pk
              = sign(<'ephemeral', 
                      x.805^inv((x.806*kdf(<'DH', ~passphrase.409>))), j_epke_pk.413, 
                      j_ekem_pk.412>,
                     x.809)
        z     = x.805^inv(x.806)
        z.1   = x.805^(~me_sk.407*inv((x.806*kdf(<'DH', ~passphrase.409>)))
                      )
        z.2   = verify(sig_j_pk.416, <'signature', pk(x.809), j_dh_pk.410>,
                       nr_pk.415)
        z.3   = true
    
    23. ~me_sk
              = ~me_sk.407
        ~passphrase
              = ~passphrase.409
        j_dh_pk
              = j_dh_pk.410
        j_edh_pk
              = x.805^(x.806*inv(kdf(<'DH', ~passphrase.409>)))
        j_ekem_pk
              = j_ekem_pk.412
        j_epke_pk
              = j_epke_pk.413
        j_sig_pk
              = pk(x.809)
        nr_pk = nr_pk.415
        sig_j_pk
              = sig_j_pk.416
        sig_je_pk
              = sign(<'ephemeral', 
                      x.805^(x.806*inv(kdf(<'DH', ~passphrase.409>))), j_epke_pk.413, 
                      j_ekem_pk.412>,
                     x.809)
        z     = x.805^x.806
        z.1   = x.805^(~me_sk.407*x.806*inv(kdf(<'DH', ~passphrase.409>)))
        z.2   = verify(sig_j_pk.416, <'signature', pk(x.809), j_dh_pk.410>,
                       nr_pk.415)
        z.3   = true
    
    24. ~me_sk
              = ~me_sk.407
        ~passphrase
              = ~passphrase.409
        j_dh_pk
              = j_dh_pk.410
        j_edh_pk
              = x.807^(x.808*inv((~me_sk.407*x.809)))
        j_ekem_pk
              = j_ekem_pk.412
        j_epke_pk
              = j_epke_pk.413
        j_sig_pk
              = j_sig_pk.414
        nr_pk = nr_pk.415
        sig_j_pk
              = sig_j_pk.416
        sig_je_pk
              = sig_je_pk.417
        z     = x.807^(x.808*inv((~me_sk.407*x.809))*
                       kdf(<'DH', ~passphrase.409>))
        z.1   = x.807^(x.808*inv(x.809))
        z.2   = verify(sig_j_pk.416,
                       <'signature', j_sig_pk.414, j_dh_pk.410>, nr_pk.415)
        z.3   = verify(sig_je_pk.417,
                       <'ephemeral', x.807^(x.808*inv((~me_sk.407*x.809))), 
                        j_epke_pk.413, j_ekem_pk.412>,
                       j_sig_pk.414)
    
    25. ~me_sk
              = ~me_sk.407
        ~passphrase
              = ~passphrase.409
        j_dh_pk
              = j_dh_pk.410
        j_edh_pk
              = x.807^(x.808*inv((~me_sk.407*x.809*kdf(<'DH', ~passphrase.409>)))
                      )
        j_ekem_pk
              = j_ekem_pk.412
        j_epke_pk
              = j_epke_pk.413
        j_sig_pk
              = j_sig_pk.414
        nr_pk = nr_pk.415
        sig_j_pk
              = sig_j_pk.416
        sig_je_pk
              = sig_je_pk.417
        z     = x.807^(x.808*inv((~me_sk.407*x.809)))
        z.1   = x.807^(x.808*inv((x.809*kdf(<'DH', ~passphrase.409>))))
        z.2   = verify(sig_j_pk.416,
                       <'signature', j_sig_pk.414, j_dh_pk.410>, nr_pk.415)
        z.3   = verify(sig_je_pk.417,
                       <'ephemeral', 
                        x.807^(x.808*inv((~me_sk.407*x.809*kdf(<'DH', ~passphrase.409>)))
                              ), 
                        j_epke_pk.413, j_ekem_pk.412>,
                       j_sig_pk.414)
    
    26. ~me_sk
              = ~me_sk.408
        ~passphrase
              = ~passphrase.410
        j_dh_pk
              = j_dh_pk.411
        j_edh_pk
              = z.426^inv(~me_sk.408)
        j_ekem_pk
              = j_ekem_pk.413
        j_epke_pk
              = j_epke_pk.414
        j_sig_pk
              = pk(x.811)
        nr_pk = nr_pk.416
        sig_j_pk
              = sig_j_pk.417
        sig_je_pk
              = sign(<'ephemeral', z.426^inv(~me_sk.408), j_epke_pk.414, 
                      j_ekem_pk.413>,
                     x.811)
        z     = z.426^(inv(~me_sk.408)*kdf(<'DH', ~passphrase.410>))
        z.1   = z.426
        z.2   = verify(sig_j_pk.417, <'signature', pk(x.811), j_dh_pk.411>,
                       nr_pk.416)
        z.3   = true
    
    27. ~me_sk
              = ~me_sk.408
        ~passphrase
              = ~passphrase.410
        j_dh_pk
              = j_dh_pk.411
        j_edh_pk
              = x.806^inv((x.807*kdf(<'DH', ~passphrase.410>)))
        j_ekem_pk
              = j_ekem_pk.413
        j_epke_pk
              = j_epke_pk.414
        j_sig_pk
              = j_sig_pk.415
        nr_pk = pk(x.811)
        sig_j_pk
              = sign(<'signature', j_sig_pk.415, j_dh_pk.411>, x.811)
        sig_je_pk
              = sig_je_pk.418
        z     = x.806^inv(x.807)
        z.1   = x.806^(~me_sk.408*inv((x.807*kdf(<'DH', ~passphrase.410>)))
                      )
        z.2   = true
        z.3   = verify(sig_je_pk.418,
                       <'ephemeral', x.806^inv((x.807*kdf(<'DH', ~passphrase.410>))), 
                        j_epke_pk.414, j_ekem_pk.413>,
                       j_sig_pk.415)
    
    28. ~me_sk
              = ~me_sk.408
        ~passphrase
              = ~passphrase.410
        j_dh_pk
              = j_dh_pk.411
        j_edh_pk
              = x.806^inv((x.807*kdf(<'DH', ~passphrase.410>)))
        j_ekem_pk
              = j_ekem_pk.413
        j_epke_pk
              = j_epke_pk.414
        j_sig_pk
              = pk(x.810)
        nr_pk = pk(x.811)
        sig_j_pk
              = sign(<'signature', pk(x.810), j_dh_pk.411>, x.811)
        sig_je_pk
              = sign(<'ephemeral', 
                      x.806^inv((x.807*kdf(<'DH', ~passphrase.410>))), j_epke_pk.414, 
                      j_ekem_pk.413>,
                     x.810)
        z     = x.806^inv(x.807)
        z.1   = x.806^(~me_sk.408*inv((x.807*kdf(<'DH', ~passphrase.410>)))
                      )
        z.2   = true
        z.3   = true
    
    29. ~me_sk
              = ~me_sk.408
        ~passphrase
              = ~passphrase.410
        j_dh_pk
              = j_dh_pk.411
        j_edh_pk
              = x.806^(x.807*inv(kdf(<'DH', ~passphrase.410>)))
        j_ekem_pk
              = j_ekem_pk.413
        j_epke_pk
              = j_epke_pk.414
        j_sig_pk
              = j_sig_pk.415
        nr_pk = pk(x.811)
        sig_j_pk
              = sign(<'signature', j_sig_pk.415, j_dh_pk.411>, x.811)
        sig_je_pk
              = sig_je_pk.418
        z     = x.806^x.807
        z.1   = x.806^(~me_sk.408*x.807*inv(kdf(<'DH', ~passphrase.410>)))
        z.2   = true
        z.3   = verify(sig_je_pk.418,
                       <'ephemeral', x.806^(x.807*inv(kdf(<'DH', ~passphrase.410>))), 
                        j_epke_pk.414, j_ekem_pk.413>,
                       j_sig_pk.415)
    
    30. ~me_sk
              = ~me_sk.408
        ~passphrase
              = ~passphrase.410
        j_dh_pk
              = j_dh_pk.411
        j_edh_pk
              = x.806^(x.807*inv(kdf(<'DH', ~passphrase.410>)))
        j_ekem_pk
              = j_ekem_pk.413
        j_epke_pk
              = j_epke_pk.414
        j_sig_pk
              = pk(x.810)
        nr_pk = pk(x.811)
        sig_j_pk
              = sign(<'signature', pk(x.810), j_dh_pk.411>, x.811)
        sig_je_pk
              = sign(<'ephemeral', 
                      x.806^(x.807*inv(kdf(<'DH', ~passphrase.410>))), j_epke_pk.414, 
                      j_ekem_pk.413>,
                     x.810)
        z     = x.806^x.807
        z.1   = x.806^(~me_sk.408*x.807*inv(kdf(<'DH', ~passphrase.410>)))
        z.2   = true
        z.3   = true
    
    31. ~me_sk
              = ~me_sk.408
        ~passphrase
              = ~passphrase.410
        j_dh_pk
              = j_dh_pk.411
        j_edh_pk
              = x.806^(x.807*inv((x.808*kdf(<'DH', ~passphrase.410>))))
        j_ekem_pk
              = j_ekem_pk.413
        j_epke_pk
              = j_epke_pk.414
        j_sig_pk
              = pk(x.811)
        nr_pk = nr_pk.416
        sig_j_pk
              = sig_j_pk.417
        sig_je_pk
              = sign(<'ephemeral', 
                      x.806^(x.807*inv((x.808*kdf(<'DH', ~passphrase.410>)))), 
                      j_epke_pk.414, j_ekem_pk.413>,
                     x.811)
        z     = x.806^(x.807*inv(x.808))
        z.1   = x.806^(~me_sk.408*x.807*
                       inv((x.808*kdf(<'DH', ~passphrase.410>))))
        z.2   = verify(sig_j_pk.417, <'signature', pk(x.811), j_dh_pk.411>,
                       nr_pk.416)
        z.3   = true
    
    32. ~me_sk
              = ~me_sk.408
        ~passphrase
              = ~passphrase.410
        j_dh_pk
              = j_dh_pk.411
        j_edh_pk
              = x.808^inv((~me_sk.408*kdf(<'DH', ~passphrase.410>)))
        j_ekem_pk
              = j_ekem_pk.413
        j_epke_pk
              = j_epke_pk.414
        j_sig_pk
              = pk(x.811)
        nr_pk = nr_pk.416
        sig_j_pk
              = sig_j_pk.417
        sig_je_pk
              = sign(<'ephemeral', 
                      x.808^inv((~me_sk.408*kdf(<'DH', ~passphrase.410>))), 
                      j_epke_pk.414, j_ekem_pk.413>,
                     x.811)
        z     = x.808^inv(~me_sk.408)
        z.1   = x.808^inv(kdf(<'DH', ~passphrase.410>))
        z.2   = verify(sig_j_pk.417, <'signature', pk(x.811), j_dh_pk.411>,
                       nr_pk.416)
        z.3   = true
    
    33. ~me_sk
              = ~me_sk.409
        ~passphrase
              = ~passphrase.411
        j_dh_pk
              = j_dh_pk.412
        j_edh_pk
              = z.427^inv(~me_sk.409)
        j_ekem_pk
              = j_ekem_pk.414
        j_epke_pk
              = j_epke_pk.415
        j_sig_pk
              = j_sig_pk.416
        nr_pk = pk(x.813)
        sig_j_pk
              = sign(<'signature', j_sig_pk.416, j_dh_pk.412>, x.813)
        sig_je_pk
              = sig_je_pk.419
        z     = z.427^(inv(~me_sk.409)*kdf(<'DH', ~passphrase.411>))
        z.1   = z.427
        z.2   = true
        z.3   = verify(sig_je_pk.419,
                       <'ephemeral', z.427^inv(~me_sk.409), j_epke_pk.415, j_ekem_pk.414>,
                       j_sig_pk.416)
    
    34. ~me_sk
              = ~me_sk.409
        ~passphrase
              = ~passphrase.411
        j_dh_pk
              = j_dh_pk.412
        j_edh_pk
              = z.427^inv(~me_sk.409)
        j_ekem_pk
              = j_ekem_pk.414
        j_epke_pk
              = j_epke_pk.415
        j_sig_pk
              = pk(x.812)
        nr_pk = pk(x.813)
        sig_j_pk
              = sign(<'signature', pk(x.812), j_dh_pk.412>, x.813)
        sig_je_pk
              = sign(<'ephemeral', z.427^inv(~me_sk.409), j_epke_pk.415, 
                      j_ekem_pk.414>,
                     x.812)
        z     = z.427^(inv(~me_sk.409)*kdf(<'DH', ~passphrase.411>))
        z.1   = z.427
        z.2   = true
        z.3   = true
    
    35. ~me_sk
              = ~me_sk.409
        ~passphrase
              = ~passphrase.411
        j_dh_pk
              = j_dh_pk.412
        j_edh_pk
              = x.807^(x.808*inv((x.809*kdf(<'DH', ~passphrase.411>))))
        j_ekem_pk
              = j_ekem_pk.414
        j_epke_pk
              = j_epke_pk.415
        j_sig_pk
              = j_sig_pk.416
        nr_pk = pk(x.813)
        sig_j_pk
              = sign(<'signature', j_sig_pk.416, j_dh_pk.412>, x.813)
        sig_je_pk
              = sig_je_pk.419
        z     = x.807^(x.808*inv(x.809))
        z.1   = x.807^(~me_sk.409*x.808*
                       inv((x.809*kdf(<'DH', ~passphrase.411>))))
        z.2   = true
        z.3   = verify(sig_je_pk.419,
                       <'ephemeral', 
                        x.807^(x.808*inv((x.809*kdf(<'DH', ~passphrase.411>)))), 
                        j_epke_pk.415, j_ekem_pk.414>,
                       j_sig_pk.416)
    
    36. ~me_sk
              = ~me_sk.409
        ~passphrase
              = ~passphrase.411
        j_dh_pk
              = j_dh_pk.412
        j_edh_pk
              = x.807^(x.808*inv((x.809*kdf(<'DH', ~passphrase.411>))))
        j_ekem_pk
              = j_ekem_pk.414
        j_epke_pk
              = j_epke_pk.415
        j_sig_pk
              = pk(x.812)
        nr_pk = pk(x.813)
        sig_j_pk
              = sign(<'signature', pk(x.812), j_dh_pk.412>, x.813)
        sig_je_pk
              = sign(<'ephemeral', 
                      x.807^(x.808*inv((x.809*kdf(<'DH', ~passphrase.411>)))), 
                      j_epke_pk.415, j_ekem_pk.414>,
                     x.812)
        z     = x.807^(x.808*inv(x.809))
        z.1   = x.807^(~me_sk.409*x.808*
                       inv((x.809*kdf(<'DH', ~passphrase.411>))))
        z.2   = true
        z.3   = true
    
    37. ~me_sk
              = ~me_sk.409
        ~passphrase
              = ~passphrase.411
        j_dh_pk
              = j_dh_pk.412
        j_edh_pk
              = x.809^inv((~me_sk.409*x.810))
        j_ekem_pk
              = j_ekem_pk.414
        j_epke_pk
              = j_epke_pk.415
        j_sig_pk
              = pk(x.813)
        nr_pk = nr_pk.417
        sig_j_pk
              = sig_j_pk.418
        sig_je_pk
              = sign(<'ephemeral', x.809^inv((~me_sk.409*x.810)), j_epke_pk.415, 
                      j_ekem_pk.414>,
                     x.813)
        z     = x.809^(inv((~me_sk.409*x.810))*kdf(<'DH', ~passphrase.411>)
                      )
        z.1   = x.809^inv(x.810)
        z.2   = verify(sig_j_pk.418, <'signature', pk(x.813), j_dh_pk.412>,
                       nr_pk.417)
        z.3   = true
    
    38. ~me_sk
              = ~me_sk.409
        ~passphrase
              = ~passphrase.411
        j_dh_pk
              = j_dh_pk.412
        j_edh_pk
              = x.809^inv((~me_sk.409*x.810*kdf(<'DH', ~passphrase.411>)))
        j_ekem_pk
              = j_ekem_pk.414
        j_epke_pk
              = j_epke_pk.415
        j_sig_pk
              = pk(x.813)
        nr_pk = nr_pk.417
        sig_j_pk
              = sig_j_pk.418
        sig_je_pk
              = sign(<'ephemeral', 
                      x.809^inv((~me_sk.409*x.810*kdf(<'DH', ~passphrase.411>))), 
                      j_epke_pk.415, j_ekem_pk.414>,
                     x.813)
        z     = x.809^inv((~me_sk.409*x.810))
        z.1   = x.809^inv((x.810*kdf(<'DH', ~passphrase.411>)))
        z.2   = verify(sig_j_pk.418, <'signature', pk(x.813), j_dh_pk.412>,
                       nr_pk.417)
        z.3   = true
    
    39. ~me_sk
              = ~me_sk.409
        ~passphrase
              = ~passphrase.411
        j_dh_pk
              = j_dh_pk.412
        j_edh_pk
              = x.809^inv((~me_sk.409*kdf(<'DH', ~passphrase.411>)))
        j_ekem_pk
              = j_ekem_pk.414
        j_epke_pk
              = j_epke_pk.415
        j_sig_pk
              = j_sig_pk.416
        nr_pk = pk(x.813)
        sig_j_pk
              = sign(<'signature', j_sig_pk.416, j_dh_pk.412>, x.813)
        sig_je_pk
              = sig_je_pk.419
        z     = x.809^inv(~me_sk.409)
        z.1   = x.809^inv(kdf(<'DH', ~passphrase.411>))
        z.2   = true
        z.3   = verify(sig_je_pk.419,
                       <'ephemeral', 
                        x.809^inv((~me_sk.409*kdf(<'DH', ~passphrase.411>))), 
                        j_epke_pk.415, j_ekem_pk.414>,
                       j_sig_pk.416)
    
    40. ~me_sk
              = ~me_sk.409
        ~passphrase
              = ~passphrase.411
        j_dh_pk
              = j_dh_pk.412
        j_edh_pk
              = x.809^inv((~me_sk.409*kdf(<'DH', ~passphrase.411>)))
        j_ekem_pk
              = j_ekem_pk.414
        j_epke_pk
              = j_epke_pk.415
        j_sig_pk
              = pk(x.812)
        nr_pk = pk(x.813)
        sig_j_pk
              = sign(<'signature', pk(x.812), j_dh_pk.412>, x.813)
        sig_je_pk
              = sign(<'ephemeral', 
                      x.809^inv((~me_sk.409*kdf(<'DH', ~passphrase.411>))), 
                      j_epke_pk.415, j_ekem_pk.414>,
                     x.812)
        z     = x.809^inv(~me_sk.409)
        z.1   = x.809^inv(kdf(<'DH', ~passphrase.411>))
        z.2   = true
        z.3   = true
    
    41. ~me_sk
              = ~me_sk.409
        ~passphrase
              = ~passphrase.411
        j_dh_pk
              = j_dh_pk.412
        j_edh_pk
              = x.809^(x.810*inv(~me_sk.409))
        j_ekem_pk
              = j_ekem_pk.414
        j_epke_pk
              = j_epke_pk.415
        j_sig_pk
              = pk(x.813)
        nr_pk = nr_pk.417
        sig_j_pk
              = sig_j_pk.418
        sig_je_pk
              = sign(<'ephemeral', x.809^(x.810*inv(~me_sk.409)), j_epke_pk.415, 
                      j_ekem_pk.414>,
                     x.813)
        z     = x.809^(x.810*inv(~me_sk.409)*kdf(<'DH', ~passphrase.411>))
        z.1   = x.809^x.810
        z.2   = verify(sig_j_pk.418, <'signature', pk(x.813), j_dh_pk.412>,
                       nr_pk.417)
        z.3   = true
    
    42. ~me_sk
              = ~me_sk.409
        ~passphrase
              = ~passphrase.411
        j_dh_pk
              = j_dh_pk.412
        j_edh_pk
              = x.809^(x.810*inv((~me_sk.409*kdf(<'DH', ~passphrase.411>))))
        j_ekem_pk
              = j_ekem_pk.414
        j_epke_pk
              = j_epke_pk.415
        j_sig_pk
              = pk(x.813)
        nr_pk = nr_pk.417
        sig_j_pk
              = sig_j_pk.418
        sig_je_pk
              = sign(<'ephemeral', 
                      x.809^(x.810*inv((~me_sk.409*kdf(<'DH', ~passphrase.411>)))), 
                      j_epke_pk.415, j_ekem_pk.414>,
                     x.813)
        z     = x.809^(x.810*inv(~me_sk.409))
        z.1   = x.809^(x.810*inv(kdf(<'DH', ~passphrase.411>)))
        z.2   = verify(sig_j_pk.418, <'signature', pk(x.813), j_dh_pk.412>,
                       nr_pk.417)
        z.3   = true
    
    43. ~me_sk
              = ~me_sk.410
        ~passphrase
              = ~passphrase.412
        j_dh_pk
              = j_dh_pk.413
        j_edh_pk
              = x.810^inv((~me_sk.410*x.811))
        j_ekem_pk
              = j_ekem_pk.415
        j_epke_pk
              = j_epke_pk.416
        j_sig_pk
              = j_sig_pk.417
        nr_pk = pk(x.815)
        sig_j_pk
              = sign(<'signature', j_sig_pk.417, j_dh_pk.413>, x.815)
        sig_je_pk
              = sig_je_pk.420
        z     = x.810^(inv((~me_sk.410*x.811))*kdf(<'DH', ~passphrase.412>)
                      )
        z.1   = x.810^inv(x.811)
        z.2   = true
        z.3   = verify(sig_je_pk.420,
                       <'ephemeral', x.810^inv((~me_sk.410*x.811)), j_epke_pk.416, 
                        j_ekem_pk.415>,
                       j_sig_pk.417)
    
    44. ~me_sk
              = ~me_sk.410
        ~passphrase
              = ~passphrase.412
        j_dh_pk
              = j_dh_pk.413
        j_edh_pk
              = x.810^inv((~me_sk.410*x.811))
        j_ekem_pk
              = j_ekem_pk.415
        j_epke_pk
              = j_epke_pk.416
        j_sig_pk
              = pk(x.814)
        nr_pk = pk(x.815)
        sig_j_pk
              = sign(<'signature', pk(x.814), j_dh_pk.413>, x.815)
        sig_je_pk
              = sign(<'ephemeral', x.810^inv((~me_sk.410*x.811)), j_epke_pk.416, 
                      j_ekem_pk.415>,
                     x.814)
        z     = x.810^(inv((~me_sk.410*x.811))*kdf(<'DH', ~passphrase.412>)
                      )
        z.1   = x.810^inv(x.811)
        z.2   = true
        z.3   = true
    
    45. ~me_sk
              = ~me_sk.410
        ~passphrase
              = ~passphrase.412
        j_dh_pk
              = j_dh_pk.413
        j_edh_pk
              = x.810^inv((~me_sk.410*x.811*kdf(<'DH', ~passphrase.412>)))
        j_ekem_pk
              = j_ekem_pk.415
        j_epke_pk
              = j_epke_pk.416
        j_sig_pk
              = j_sig_pk.417
        nr_pk = pk(x.815)
        sig_j_pk
              = sign(<'signature', j_sig_pk.417, j_dh_pk.413>, x.815)
        sig_je_pk
              = sig_je_pk.420
        z     = x.810^inv((~me_sk.410*x.811))
        z.1   = x.810^inv((x.811*kdf(<'DH', ~passphrase.412>)))
        z.2   = true
        z.3   = verify(sig_je_pk.420,
                       <'ephemeral', 
                        x.810^inv((~me_sk.410*x.811*kdf(<'DH', ~passphrase.412>))), 
                        j_epke_pk.416, j_ekem_pk.415>,
                       j_sig_pk.417)
    
    46. ~me_sk
              = ~me_sk.410
        ~passphrase
              = ~passphrase.412
        j_dh_pk
              = j_dh_pk.413
        j_edh_pk
              = x.810^inv((~me_sk.410*x.811*kdf(<'DH', ~passphrase.412>)))
        j_ekem_pk
              = j_ekem_pk.415
        j_epke_pk
              = j_epke_pk.416
        j_sig_pk
              = pk(x.814)
        nr_pk = pk(x.815)
        sig_j_pk
              = sign(<'signature', pk(x.814), j_dh_pk.413>, x.815)
        sig_je_pk
              = sign(<'ephemeral', 
                      x.810^inv((~me_sk.410*x.811*kdf(<'DH', ~passphrase.412>))), 
                      j_epke_pk.416, j_ekem_pk.415>,
                     x.814)
        z     = x.810^inv((~me_sk.410*x.811))
        z.1   = x.810^inv((x.811*kdf(<'DH', ~passphrase.412>)))
        z.2   = true
        z.3   = true
    
    47. ~me_sk
              = ~me_sk.410
        ~passphrase
              = ~passphrase.412
        j_dh_pk
              = j_dh_pk.413
        j_edh_pk
              = x.810^(x.811*inv(~me_sk.410))
        j_ekem_pk
              = j_ekem_pk.415
        j_epke_pk
              = j_epke_pk.416
        j_sig_pk
              = j_sig_pk.417
        nr_pk = pk(x.815)
        sig_j_pk
              = sign(<'signature', j_sig_pk.417, j_dh_pk.413>, x.815)
        sig_je_pk
              = sig_je_pk.420
        z     = x.810^(x.811*inv(~me_sk.410)*kdf(<'DH', ~passphrase.412>))
        z.1   = x.810^x.811
        z.2   = true
        z.3   = verify(sig_je_pk.420,
                       <'ephemeral', x.810^(x.811*inv(~me_sk.410)), j_epke_pk.416, 
                        j_ekem_pk.415>,
                       j_sig_pk.417)
    
    48. ~me_sk
              = ~me_sk.410
        ~passphrase
              = ~passphrase.412
        j_dh_pk
              = j_dh_pk.413
        j_edh_pk
              = x.810^(x.811*inv(~me_sk.410))
        j_ekem_pk
              = j_ekem_pk.415
        j_epke_pk
              = j_epke_pk.416
        j_sig_pk
              = pk(x.814)
        nr_pk = pk(x.815)
        sig_j_pk
              = sign(<'signature', pk(x.814), j_dh_pk.413>, x.815)
        sig_je_pk
              = sign(<'ephemeral', x.810^(x.811*inv(~me_sk.410)), j_epke_pk.416, 
                      j_ekem_pk.415>,
                     x.814)
        z     = x.810^(x.811*inv(~me_sk.410)*kdf(<'DH', ~passphrase.412>))
        z.1   = x.810^x.811
        z.2   = true
        z.3   = true
    
    49. ~me_sk
              = ~me_sk.410
        ~passphrase
              = ~passphrase.412
        j_dh_pk
              = j_dh_pk.413
        j_edh_pk
              = x.810^(x.811*inv((~me_sk.410*x.812)))
        j_ekem_pk
              = j_ekem_pk.415
        j_epke_pk
              = j_epke_pk.416
        j_sig_pk
              = pk(x.815)
        nr_pk = nr_pk.418
        sig_j_pk
              = sig_j_pk.419
        sig_je_pk
              = sign(<'ephemeral', x.810^(x.811*inv((~me_sk.410*x.812))), 
                      j_epke_pk.416, j_ekem_pk.415>,
                     x.815)
        z     = x.810^(x.811*inv((~me_sk.410*x.812))*
                       kdf(<'DH', ~passphrase.412>))
        z.1   = x.810^(x.811*inv(x.812))
        z.2   = verify(sig_j_pk.419, <'signature', pk(x.815), j_dh_pk.413>,
                       nr_pk.418)
        z.3   = true
    
    50. ~me_sk
              = ~me_sk.410
        ~passphrase
              = ~passphrase.412
        j_dh_pk
              = j_dh_pk.413
        j_edh_pk
              = x.810^(x.811*inv((~me_sk.410*x.812*kdf(<'DH', ~passphrase.412>)))
                      )
        j_ekem_pk
              = j_ekem_pk.415
        j_epke_pk
              = j_epke_pk.416
        j_sig_pk
              = pk(x.815)
        nr_pk = nr_pk.418
        sig_j_pk
              = sig_j_pk.419
        sig_je_pk
              = sign(<'ephemeral', 
                      x.810^(x.811*inv((~me_sk.410*x.812*kdf(<'DH', ~passphrase.412>)))
                            ), 
                      j_epke_pk.416, j_ekem_pk.415>,
                     x.815)
        z     = x.810^(x.811*inv((~me_sk.410*x.812)))
        z.1   = x.810^(x.811*inv((x.812*kdf(<'DH', ~passphrase.412>))))
        z.2   = verify(sig_j_pk.419, <'signature', pk(x.815), j_dh_pk.413>,
                       nr_pk.418)
        z.3   = true
    
    51. ~me_sk
              = ~me_sk.410
        ~passphrase
              = ~passphrase.412
        j_dh_pk
              = j_dh_pk.413
        j_edh_pk
              = x.810^(x.811*inv((~me_sk.410*kdf(<'DH', ~passphrase.412>))))
        j_ekem_pk
              = j_ekem_pk.415
        j_epke_pk
              = j_epke_pk.416
        j_sig_pk
              = j_sig_pk.417
        nr_pk = pk(x.815)
        sig_j_pk
              = sign(<'signature', j_sig_pk.417, j_dh_pk.413>, x.815)
        sig_je_pk
              = sig_je_pk.420
        z     = x.810^(x.811*inv(~me_sk.410))
        z.1   = x.810^(x.811*inv(kdf(<'DH', ~passphrase.412>)))
        z.2   = true
        z.3   = verify(sig_je_pk.420,
                       <'ephemeral', 
                        x.810^(x.811*inv((~me_sk.410*kdf(<'DH', ~passphrase.412>)))), 
                        j_epke_pk.416, j_ekem_pk.415>,
                       j_sig_pk.417)
    
    52. ~me_sk
              = ~me_sk.410
        ~passphrase
              = ~passphrase.412
        j_dh_pk
              = j_dh_pk.413
        j_edh_pk
              = x.810^(x.811*inv((~me_sk.410*kdf(<'DH', ~passphrase.412>))))
        j_ekem_pk
              = j_ekem_pk.415
        j_epke_pk
              = j_epke_pk.416
        j_sig_pk
              = pk(x.814)
        nr_pk = pk(x.815)
        sig_j_pk
              = sign(<'signature', pk(x.814), j_dh_pk.413>, x.815)
        sig_je_pk
              = sign(<'ephemeral', 
                      x.810^(x.811*inv((~me_sk.410*kdf(<'DH', ~passphrase.412>)))), 
                      j_epke_pk.416, j_ekem_pk.415>,
                     x.814)
        z     = x.810^(x.811*inv(~me_sk.410))
        z.1   = x.810^(x.811*inv(kdf(<'DH', ~passphrase.412>)))
        z.2   = true
        z.3   = true
    
    53. ~me_sk
              = ~me_sk.411
        ~passphrase
              = ~passphrase.413
        j_dh_pk
              = j_dh_pk.414
        j_edh_pk
              = x.811^(x.812*inv((~me_sk.411*x.813)))
        j_ekem_pk
              = j_ekem_pk.416
        j_epke_pk
              = j_epke_pk.417
        j_sig_pk
              = j_sig_pk.418
        nr_pk = pk(x.817)
        sig_j_pk
              = sign(<'signature', j_sig_pk.418, j_dh_pk.414>, x.817)
        sig_je_pk
              = sig_je_pk.421
        z     = x.811^(x.812*inv((~me_sk.411*x.813))*
                       kdf(<'DH', ~passphrase.413>))
        z.1   = x.811^(x.812*inv(x.813))
        z.2   = true
        z.3   = verify(sig_je_pk.421,
                       <'ephemeral', x.811^(x.812*inv((~me_sk.411*x.813))), 
                        j_epke_pk.417, j_ekem_pk.416>,
                       j_sig_pk.418)
    
    54. ~me_sk
              = ~me_sk.411
        ~passphrase
              = ~passphrase.413
        j_dh_pk
              = j_dh_pk.414
        j_edh_pk
              = x.811^(x.812*inv((~me_sk.411*x.813)))
        j_ekem_pk
              = j_ekem_pk.416
        j_epke_pk
              = j_epke_pk.417
        j_sig_pk
              = pk(x.816)
        nr_pk = pk(x.817)
        sig_j_pk
              = sign(<'signature', pk(x.816), j_dh_pk.414>, x.817)
        sig_je_pk
              = sign(<'ephemeral', x.811^(x.812*inv((~me_sk.411*x.813))), 
                      j_epke_pk.417, j_ekem_pk.416>,
                     x.816)
        z     = x.811^(x.812*inv((~me_sk.411*x.813))*
                       kdf(<'DH', ~passphrase.413>))
        z.1   = x.811^(x.812*inv(x.813))
        z.2   = true
        z.3   = true
    
    55. ~me_sk
              = ~me_sk.411
        ~passphrase
              = ~passphrase.413
        j_dh_pk
              = j_dh_pk.414
        j_edh_pk
              = x.811^(x.812*inv((~me_sk.411*x.813*kdf(<'DH', ~passphrase.413>)))
                      )
        j_ekem_pk
              = j_ekem_pk.416
        j_epke_pk
              = j_epke_pk.417
        j_sig_pk
              = j_sig_pk.418
        nr_pk = pk(x.817)
        sig_j_pk
              = sign(<'signature', j_sig_pk.418, j_dh_pk.414>, x.817)
        sig_je_pk
              = sig_je_pk.421
        z     = x.811^(x.812*inv((~me_sk.411*x.813)))
        z.1   = x.811^(x.812*inv((x.813*kdf(<'DH', ~passphrase.413>))))
        z.2   = true
        z.3   = verify(sig_je_pk.421,
                       <'ephemeral', 
                        x.811^(x.812*inv((~me_sk.411*x.813*kdf(<'DH', ~passphrase.413>)))
                              ), 
                        j_epke_pk.417, j_ekem_pk.416>,
                       j_sig_pk.418)
    
    56. ~me_sk
              = ~me_sk.411
        ~passphrase
              = ~passphrase.413
        j_dh_pk
              = j_dh_pk.414
        j_edh_pk
              = x.811^(x.812*inv((~me_sk.411*x.813*kdf(<'DH', ~passphrase.413>)))
                      )
        j_ekem_pk
              = j_ekem_pk.416
        j_epke_pk
              = j_epke_pk.417
        j_sig_pk
              = pk(x.816)
        nr_pk = pk(x.817)
        sig_j_pk
              = sign(<'signature', pk(x.816), j_dh_pk.414>, x.817)
        sig_je_pk
              = sign(<'ephemeral', 
                      x.811^(x.812*inv((~me_sk.411*x.813*kdf(<'DH', ~passphrase.413>)))
                            ), 
                      j_epke_pk.417, j_ekem_pk.416>,
                     x.816)
        z     = x.811^(x.812*inv((~me_sk.411*x.813)))
        z.1   = x.811^(x.812*inv((x.813*kdf(<'DH', ~passphrase.413>))))
        z.2   = true
        z.3   = true
    
    57. j_dh_pk
              = j_dh_pk.33
        j_edh_pk
              = DH_neutral
        j_ekem_pk
              = j_ekem_pk.35
        j_epke_pk
              = j_epke_pk.36
        j_sig_pk
              = j_sig_pk.37
        nr_pk = nr_pk.38
        sig_j_pk
              = sig_j_pk.39
        sig_je_pk
              = sig_je_pk.40
        z     = DH_neutral
        z.1   = DH_neutral
        z.2   = verify(sig_j_pk.39, <'signature', j_sig_pk.37, j_dh_pk.33>,
                       nr_pk.38)
        z.3   = verify(sig_je_pk.40,
                       <'ephemeral', DH_neutral, j_epke_pk.36, j_ekem_pk.35>, j_sig_pk.37)
    
    58. j_dh_pk
              = j_dh_pk.388
        j_edh_pk
              = DH_neutral
        j_ekem_pk
              = j_ekem_pk.390
        j_epke_pk
              = j_epke_pk.391
        j_sig_pk
              = pk(x.768)
        nr_pk = nr_pk.393
        sig_j_pk
              = sig_j_pk.394
        sig_je_pk
              = sign(<'ephemeral', DH_neutral, j_epke_pk.391, j_ekem_pk.390>,
                     x.768)
        z     = DH_neutral
        z.1   = DH_neutral
        z.2   = verify(sig_j_pk.394, <'signature', pk(x.768), j_dh_pk.388>,
                       nr_pk.393)
        z.3   = true
    
    59. j_dh_pk
              = j_dh_pk.390
        j_edh_pk
              = DH_neutral
        j_ekem_pk
              = j_ekem_pk.392
        j_epke_pk
              = j_epke_pk.393
        j_sig_pk
              = j_sig_pk.394
        nr_pk = pk(x.772)
        sig_j_pk
              = sign(<'signature', j_sig_pk.394, j_dh_pk.390>, x.772)
        sig_je_pk
              = sig_je_pk.397
        z     = DH_neutral
        z.1   = DH_neutral
        z.2   = true
        z.3   = verify(sig_je_pk.397,
                       <'ephemeral', DH_neutral, j_epke_pk.393, j_ekem_pk.392>,
                       j_sig_pk.394)
    
    60. j_dh_pk
              = j_dh_pk.390
        j_edh_pk
              = DH_neutral
        j_ekem_pk
              = j_ekem_pk.392
        j_epke_pk
              = j_epke_pk.393
        j_sig_pk
              = pk(x.771)
        nr_pk = pk(x.772)
        sig_j_pk
              = sign(<'signature', pk(x.771), j_dh_pk.390>, x.772)
        sig_je_pk
              = sign(<'ephemeral', DH_neutral, j_epke_pk.393, j_ekem_pk.392>,
                     x.771)
        z     = DH_neutral
        z.1   = DH_neutral
        z.2   = true
        z.3   = true
  */

rule (modulo E) Journalist_Recv[color=#6495ed, derivchecks]:
   [
   In( <
        aenc(<'cipher_s2j', 'g'^s_dh_sk, 'g'^~me_sk, c_pq>,
             pk(~j_epke_sk)), 
        senc(<'msg_s2j', ~msg, 'g'^s_dh_sk, s_pke_pk, s_kem_pk, 
              pk(~j_sig_sk), $NR>,
             H(kdf(<'g'^s_dh_sk^~j_edh_sk, 'g'^~me_sk^~j_edh_sk, 'g'^~me_sk, 
                    j_edh_pk, 'g'^s_dh_sk>),
               'g'^~me_sk, decap(c_pq, ~j_ekem_sk), c_pq))
       >
   ),
   Journalist_Ephemeral_Key( $J, ~j_edh_sk, ~j_epke_sk, ~j_ekem_sk ),
   !Ltk_Journalist_SIG_Key( $J, ~j_sig_sk ),
   !Journalist_Enrolled( $NR, $J )
   ]
  --[
  DHElement_Check( H(kdf(<'g'^s_dh_sk^~j_edh_sk, 
                          'g'^~me_sk^~j_edh_sk, 'g'^~me_sk, j_edh_pk, 'g'^s_dh_sk>),
                     'g'^~me_sk, decap(c_pq, ~j_ekem_sk), c_pq)
  ),
  DHElement_Check( 'g'^s_dh_sk ), DHElement_Check( 'g'^~me_sk ),
  Journalist_Received( pk(~j_sig_sk), 'g'^~j_edh_sk, $NR,
                       'g'^s_dh_sk,
                       <'msg_s2j', ~msg, 'g'^s_dh_sk, s_pke_pk, s_kem_pk, pk(~j_sig_sk), 
                        $NR>
  ),
  PrePQAttack( )
  ]->
   [
   Journalist_Recv( $J, $NR, 'g'^s_dh_sk, s_pke_pk, s_kem_pk,
                    <'msg_s2j', ~msg, 'g'^s_dh_sk, s_pke_pk, s_kem_pk, pk(~j_sig_sk), 
                     $NR>
   )
   ]

  /*
  rule (modulo AC) Journalist_Recv[color=#6495ed, derivchecks]:
     [
     In( <aenc(<'cipher_s2j', z, 'g'^~x, c_pq>, pk(~j_epke_sk)), 
          senc(<'msg_s2j', ~msg, z, s_pke_pk, s_kem_pk, pk(~j_sig_sk), $NR>,
               H(kdf(<z.1, 'g'^(~j_edh_sk*~x), 'g'^~x, j_edh_pk, z>), 'g'^~x, z.2,
                 c_pq))
         >
     ),
     Journalist_Ephemeral_Key( $J, ~j_edh_sk, ~j_epke_sk, ~j_ekem_sk ),
     !Ltk_Journalist_SIG_Key( $J, ~j_sig_sk ),
     !Journalist_Enrolled( $NR, $J )
     ]
    --[
    DHElement_Check( H(kdf(<z.1, 'g'^(~j_edh_sk*~x), 'g'^~x, j_edh_pk, 
                            z>),
                       'g'^~x, z.2, c_pq)
    ),
    DHElement_Check( z ), DHElement_Check( 'g'^~x ),
    Journalist_Received( pk(~j_sig_sk), 'g'^~j_edh_sk, $NR, z,
                         <'msg_s2j', ~msg, z, s_pke_pk, s_kem_pk, pk(~j_sig_sk), $NR>
    ),
    PrePQAttack( )
    ]->
     [
     Journalist_Recv( $J, $NR, z, s_pke_pk, s_kem_pk,
                      <'msg_s2j', ~msg, z, s_pke_pk, s_kem_pk, pk(~j_sig_sk), $NR>
     )
     ]
    variants (modulo AC)
     1. ~j_edh_sk
              = ~j_edh_sk.56
        ~j_ekem_sk
              = ~j_ekem_sk.57
        c_pq  = c_pq.62
        z     = 'g'
        z.1   = 'g'^~j_edh_sk.56
        z.2   = decap(c_pq.62, ~j_ekem_sk.57)
    
     2. ~j_edh_sk
              = ~j_edh_sk.56
        ~j_ekem_sk
              = ~j_ekem_sk.57
        c_pq  = c_pq.62
        z     = 'g'^inv(~j_edh_sk.56)
        z.1   = 'g'
        z.2   = decap(c_pq.62, ~j_ekem_sk.57)
    
     3. ~j_edh_sk
              = ~j_edh_sk.56
        ~j_ekem_sk
              = ~j_ekem_sk.57
        c_pq  = encap(z.73, pqpk(~j_ekem_sk.57))
        z     = 'g'
        z.1   = 'g'^~j_edh_sk.56
        z.2   = z.73
    
     4. ~j_edh_sk
              = ~j_edh_sk.56
        ~j_ekem_sk
              = ~j_ekem_sk.57
        c_pq  = encap(z.73, pqpk(~j_ekem_sk.57))
        z     = 'g'^inv(~j_edh_sk.56)
        z.1   = 'g'
        z.2   = z.73
    
     5. ~j_edh_sk
              = ~j_edh_sk.426
        ~j_ekem_sk
              = ~j_ekem_sk.427
        c_pq  = c_pq.432
        z     = 'g'^s_dh_sk.848
        z.1   = 'g'^(~j_edh_sk.426*s_dh_sk.848)
        z.2   = decap(c_pq.432, ~j_ekem_sk.427)
    
     6. ~j_edh_sk
              = ~j_edh_sk.432
        ~j_ekem_sk
              = ~j_ekem_sk.433
        c_pq  = encap(z.449, pqpk(~j_ekem_sk.433))
        z     = 'g'^s_dh_sk.860
        z.1   = 'g'^(~j_edh_sk.432*s_dh_sk.860)
        z.2   = z.449
    
     7. ~j_edh_sk
              = ~j_edh_sk.434
        ~j_ekem_sk
              = ~j_ekem_sk.435
        c_pq  = c_pq.440
        z     = 'g'^inv((~j_edh_sk.434*x.864))
        z.1   = 'g'^inv(x.864)
        z.2   = decap(c_pq.440, ~j_ekem_sk.435)
    
     8. ~j_edh_sk
              = ~j_edh_sk.434
        ~j_ekem_sk
              = ~j_ekem_sk.435
        c_pq  = c_pq.440
        z     = 'g'^(x.864*inv(~j_edh_sk.434))
        z.1   = 'g'^x.864
        z.2   = decap(c_pq.440, ~j_ekem_sk.435)
    
     9. ~j_edh_sk
              = ~j_edh_sk.434
        ~j_ekem_sk
              = ~j_ekem_sk.435
        c_pq  = encap(z.451, pqpk(~j_ekem_sk.435))
        z     = 'g'^inv((~j_edh_sk.434*x.864))
        z.1   = 'g'^inv(x.864)
        z.2   = z.451
    
    10. ~j_edh_sk
              = ~j_edh_sk.434
        ~j_ekem_sk
              = ~j_ekem_sk.435
        c_pq  = encap(z.451, pqpk(~j_ekem_sk.435))
        z     = 'g'^(x.864*inv(~j_edh_sk.434))
        z.1   = 'g'^x.864
        z.2   = z.451
    
    11. ~j_edh_sk
              = ~j_edh_sk.435
        ~j_ekem_sk
              = ~j_ekem_sk.436
        c_pq  = c_pq.441
        z     = 'g'^(x.865*inv((~j_edh_sk.435*x.866)))
        z.1   = 'g'^(x.865*inv(x.866))
        z.2   = decap(c_pq.441, ~j_ekem_sk.436)
    
    12. ~j_edh_sk
              = ~j_edh_sk.435
        ~j_ekem_sk
              = ~j_ekem_sk.436
        c_pq  = encap(z.452, pqpk(~j_ekem_sk.436))
        z     = 'g'^(x.865*inv((~j_edh_sk.435*x.866)))
        z.1   = 'g'^(x.865*inv(x.866))
        z.2   = z.452
  */

rule (modulo E) Journalist_Send[color=#6495ed]:
   [
   Journalist_Recv( $J, $NR, s_dh_pk, s_pke_pk, s_kem_pk, m_old ),
   !Ltk_Journalist_DH_Key( $J, ~j_dh_sk ),
   !Journalist_Signature( $NR, $J, <j_sig_pk, 'g'^~j_dh_sk>, sig_j_pk
   ),
   Fr( ~msg ), Fr( ~me_sk ), Fr( ~k_pq )
   ]
  --[
  Journalist_Response( j_sig_pk, 'g'^~j_dh_sk, $NR, s_dh_pk,
                       s_kem_pk, m_old,
                       <'msg_j2s', ~msg, s_dh_pk, j_sig_pk, 'g'^~j_dh_sk, sig_j_pk, $NR>
  ),
  PrePQAttack( )
  ]->
   [
   Out( <
         aenc(<'cipher_j2s', 'g'^~j_dh_sk, 'g'^~me_sk, 
               encap(~k_pq, s_kem_pk)>,
              s_pke_pk), 
         senc(<'msg_j2s', ~msg, s_dh_pk, j_sig_pk, 'g'^~j_dh_sk, sig_j_pk, 
               $NR>,
              H(kdf(<s_dh_pk^~j_dh_sk, s_dh_pk^~me_sk, 'g'^~me_sk, s_dh_pk, 
                     'g'^~j_dh_sk>),
                'g'^~me_sk, ~k_pq, encap(~k_pq, s_kem_pk)))
        >
   ),
   !NonPQSecKey( ~me_sk )
   ]

  /*
  rule (modulo AC) Journalist_Send[color=#6495ed]:
     [
     Journalist_Recv( $J, $NR, s_dh_pk, s_pke_pk, s_kem_pk, m_old ),
     !Ltk_Journalist_DH_Key( $J, ~j_dh_sk ),
     !Journalist_Signature( $NR, $J, <j_sig_pk, 'g'^~j_dh_sk>, sig_j_pk
     ),
     Fr( ~msg ), Fr( ~me_sk ), Fr( ~k_pq )
     ]
    --[
    Journalist_Response( j_sig_pk, 'g'^~j_dh_sk, $NR, s_dh_pk,
                         s_kem_pk, m_old,
                         <'msg_j2s', ~msg, s_dh_pk, j_sig_pk, 'g'^~j_dh_sk, sig_j_pk, $NR>
    ),
    PrePQAttack( )
    ]->
     [
     Out( <
           aenc(<'cipher_j2s', 'g'^~j_dh_sk, 'g'^~me_sk, 
                 encap(~k_pq, s_kem_pk)>,
                s_pke_pk), 
           senc(<'msg_j2s', ~msg, s_dh_pk, j_sig_pk, 'g'^~j_dh_sk, sig_j_pk, 
                 $NR>,
                H(kdf(<z, z.1, 'g'^~me_sk, s_dh_pk, 'g'^~j_dh_sk>), 'g'^~me_sk,
                  ~k_pq, encap(~k_pq, s_kem_pk)))
          >
     ),
     !NonPQSecKey( ~me_sk )
     ]
    variants (modulo AC)
     1. ~j_dh_sk
              = ~j_dh_sk.26
        ~me_sk
              = ~me_sk.28
        s_dh_pk
              = s_dh_pk.32
        z     = s_dh_pk.32^~j_dh_sk.26
        z.1   = s_dh_pk.32^~me_sk.28
    
     2. ~j_dh_sk
              = ~j_dh_sk.34
        ~me_sk
              = ~j_dh_sk.34
        s_dh_pk
              = z.48^inv(~j_dh_sk.34)
        z     = z.48
        z.1   = z.48
    
     3. ~j_dh_sk
              = ~j_dh_sk.34
        ~me_sk
              = ~me_sk.36
        s_dh_pk
              = z.48^inv(~j_dh_sk.34)
        z     = z.48
        z.1   = z.48^(~me_sk.36*inv(~j_dh_sk.34))
    
     4. ~j_dh_sk
              = ~j_dh_sk.35
        ~me_sk
              = ~me_sk.37
        s_dh_pk
              = z.50^inv(~me_sk.37)
        z     = z.50^(~j_dh_sk.35*inv(~me_sk.37))
        z.1   = z.50
    
     5. ~j_dh_sk
              = ~j_dh_sk.201
        ~me_sk
              = ~me_sk.203
        s_dh_pk
              = x.397^x.398
        z     = x.397^(~j_dh_sk.201*x.398)
        z.1   = x.397^(~me_sk.203*x.398)
    
     6. ~j_dh_sk
              = ~j_dh_sk.205
        ~me_sk
              = ~me_sk.207
        s_dh_pk
              = x.405^inv((~me_sk.207*x.406))
        z     = x.405^(~j_dh_sk.205*inv((~me_sk.207*x.406)))
        z.1   = x.405^inv(x.406)
    
     7. ~j_dh_sk
              = ~j_dh_sk.205
        ~me_sk
              = ~me_sk.207
        s_dh_pk
              = x.405^(x.406*inv(~me_sk.207))
        z     = x.405^(~j_dh_sk.205*x.406*inv(~me_sk.207))
        z.1   = x.405^x.406
    
     8. ~j_dh_sk
              = ~j_dh_sk.206
        ~me_sk
              = ~j_dh_sk.206
        s_dh_pk
              = x.407^inv((~j_dh_sk.206*x.408))
        z     = x.407^inv(x.408)
        z.1   = x.407^inv(x.408)
    
     9. ~j_dh_sk
              = ~j_dh_sk.206
        ~me_sk
              = ~j_dh_sk.206
        s_dh_pk
              = x.407^(x.408*inv(~j_dh_sk.206))
        z     = x.407^x.408
        z.1   = x.407^x.408
    
    10. ~j_dh_sk
              = ~j_dh_sk.206
        ~me_sk
              = ~me_sk.208
        s_dh_pk
              = x.406^(x.407*inv((~me_sk.208*x.408)))
        z     = x.406^(~j_dh_sk.206*x.407*inv((~me_sk.208*x.408)))
        z.1   = x.406^(x.407*inv(x.408))
    
    11. ~j_dh_sk
              = ~j_dh_sk.206
        ~me_sk
              = ~me_sk.208
        s_dh_pk
              = x.408^inv((~j_dh_sk.206*~me_sk.208))
        z     = x.408^inv(~me_sk.208)
        z.1   = x.408^inv(~j_dh_sk.206)
    
    12. ~j_dh_sk
              = ~j_dh_sk.207
        ~me_sk
              = ~j_dh_sk.207
        s_dh_pk
              = x.408^(x.409*inv((~j_dh_sk.207*x.410)))
        z     = x.408^(x.409*inv(x.410))
        z.1   = x.408^(x.409*inv(x.410))
    
    13. ~j_dh_sk
              = ~j_dh_sk.207
        ~me_sk
              = ~me_sk.209
        s_dh_pk
              = x.409^inv((~j_dh_sk.207*~me_sk.209*x.410))
        z     = x.409^inv((~me_sk.209*x.410))
        z.1   = x.409^inv((~j_dh_sk.207*x.410))
    
    14. ~j_dh_sk
              = ~j_dh_sk.207
        ~me_sk
              = ~me_sk.209
        s_dh_pk
              = x.409^inv((~j_dh_sk.207*x.410))
        z     = x.409^inv(x.410)
        z.1   = x.409^(~me_sk.209*inv((~j_dh_sk.207*x.410)))
    
    15. ~j_dh_sk
              = ~j_dh_sk.207
        ~me_sk
              = ~me_sk.209
        s_dh_pk
              = x.409^(x.410*inv(~j_dh_sk.207))
        z     = x.409^x.410
        z.1   = x.409^(~me_sk.209*x.410*inv(~j_dh_sk.207))
    
    16. ~j_dh_sk
              = ~j_dh_sk.207
        ~me_sk
              = ~me_sk.209
        s_dh_pk
              = x.409^(x.410*inv((~j_dh_sk.207*~me_sk.209)))
        z     = x.409^(x.410*inv(~me_sk.209))
        z.1   = x.409^(x.410*inv(~j_dh_sk.207))
    
    17. ~j_dh_sk
              = ~j_dh_sk.208
        ~me_sk
              = ~me_sk.210
        s_dh_pk
              = x.410^(x.411*inv((~j_dh_sk.208*~me_sk.210*x.412)))
        z     = x.410^(x.411*inv((~me_sk.210*x.412)))
        z.1   = x.410^(x.411*inv((~j_dh_sk.208*x.412)))
    
    18. ~j_dh_sk
              = ~j_dh_sk.208
        ~me_sk
              = ~me_sk.210
        s_dh_pk
              = x.410^(x.411*inv((~j_dh_sk.208*x.412)))
        z     = x.410^(x.411*inv(x.412))
        z.1   = x.410^(~me_sk.210*x.411*inv((~j_dh_sk.208*x.412)))
    
    19. s_dh_pk
              = DH_neutral
        z     = DH_neutral
        z.1   = DH_neutral
  */

rule (modulo E) Source_Recv[color=#6495ed]:
   [
   In( <
        aenc(<'cipher_j2s', j_dh_pk, c_dhkem, c_pq>,
             pk(kdf(<'PKE', ~passphrase>))), 
        senc(<'msg_j2s', ~msg, 'g'^kdf(<'DH', ~passphrase>), j_sig_pk, 
              j_dh_pk, sig_j_pk, $NR>,
             H(kdf(<j_dh_pk^kdf(<'DH', ~passphrase>), 
                    c_dhkem^kdf(<'DH', ~passphrase>), c_dhkem, 
                    'g'^kdf(<'DH', ~passphrase>), j_dh_pk>),
               c_dhkem, decap(c_pq, kdf(<'KEM', ~passphrase>)), c_pq))
       >
   ),
   !Ltk_Source_Passphrase( $S, ~passphrase ),
   !Pk_Newsroom( $NR, nr_pk )
   ]
  --[
  DHElement_Check( H(kdf(<j_dh_pk^kdf(<'DH', ~passphrase>), 
                          c_dhkem^kdf(<'DH', ~passphrase>), c_dhkem, 
                          'g'^kdf(<'DH', ~passphrase>), j_dh_pk>),
                     c_dhkem, decap(c_pq, kdf(<'KEM', ~passphrase>)), c_pq)
  ),
  DHElement_Check( j_dh_pk ), DHElement_Check( c_dhkem ),
  Eq( verify(sig_j_pk, <'signature', j_sig_pk, j_dh_pk>, nr_pk), true
  ),
  Source_Received( 'g'^kdf(<'DH', ~passphrase>), j_dh_pk, $NR,
                   <'msg_j2s', ~msg, 'g'^kdf(<'DH', ~passphrase>), j_sig_pk, j_dh_pk, 
                    sig_j_pk, $NR>
  ),
  PrePQAttack( )
  ]->
   [ ]

  /*
  rule (modulo AC) Source_Recv[color=#6495ed]:
     [
     In( <
          aenc(<'cipher_j2s', j_dh_pk, c_dhkem, c_pq>,
               pk(kdf(<'PKE', ~passphrase>))), 
          senc(<'msg_j2s', ~msg, 'g'^kdf(<'DH', ~passphrase>), j_sig_pk, 
                j_dh_pk, sig_j_pk, $NR>,
               H(kdf(<z, z.1, c_dhkem, 'g'^kdf(<'DH', ~passphrase>), j_dh_pk>),
                 c_dhkem, z.2, c_pq))
         >
     ),
     !Ltk_Source_Passphrase( $S, ~passphrase ),
     !Pk_Newsroom( $NR, nr_pk )
     ]
    --[
    DHElement_Check( H(kdf(<z, z.1, c_dhkem, 
                            'g'^kdf(<'DH', ~passphrase>), j_dh_pk>),
                       c_dhkem, z.2, c_pq)
    ),
    DHElement_Check( j_dh_pk ), DHElement_Check( c_dhkem ),
    Eq( z.3, true ),
    Source_Received( 'g'^kdf(<'DH', ~passphrase>), j_dh_pk, $NR,
                     <'msg_j2s', ~msg, 'g'^kdf(<'DH', ~passphrase>), j_sig_pk, j_dh_pk, 
                      sig_j_pk, $NR>
    ),
    PrePQAttack( )
    ]->
     [ ]
    variants (modulo AC)
      1. ~passphrase
               = ~passphrase.26
         c_dhkem
               = c_dhkem.27
         c_pq  = c_pq.28
         j_dh_pk
               = j_dh_pk.29
         j_sig_pk
               = j_sig_pk.30
         nr_pk = nr_pk.31
         sig_j_pk
               = sig_j_pk.32
         z     = j_dh_pk.29^kdf(<'DH', ~passphrase.26>)
         z.1   = c_dhkem.27^kdf(<'DH', ~passphrase.26>)
         z.2   = decap(c_pq.28, kdf(<'KEM', ~passphrase.26>))
         z.3   = verify(sig_j_pk.32, <'signature', j_sig_pk.30, j_dh_pk.29>,
                        nr_pk.31)
    
      2. ~passphrase
               = ~passphrase.26
         c_dhkem
               = c_dhkem.27
         c_pq  = c_pq.28
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.30
         nr_pk = nr_pk.31
         sig_j_pk
               = sig_j_pk.32
         z     = DH_neutral
         z.1   = c_dhkem.27^kdf(<'DH', ~passphrase.26>)
         z.2   = decap(c_pq.28, kdf(<'KEM', ~passphrase.26>))
         z.3   = verify(sig_j_pk.32, <'signature', j_sig_pk.30, DH_neutral>,
                        nr_pk.31)
    
      3. ~passphrase
               = ~passphrase.26
         c_dhkem
               = DH_neutral
         c_pq  = c_pq.28
         j_dh_pk
               = j_dh_pk.29
         j_sig_pk
               = j_sig_pk.30
         nr_pk = nr_pk.31
         sig_j_pk
               = sig_j_pk.32
         z     = j_dh_pk.29^kdf(<'DH', ~passphrase.26>)
         z.1   = DH_neutral
         z.2   = decap(c_pq.28, kdf(<'KEM', ~passphrase.26>))
         z.3   = verify(sig_j_pk.32, <'signature', j_sig_pk.30, j_dh_pk.29>,
                        nr_pk.31)
    
      4. ~passphrase
               = ~passphrase.26
         c_dhkem
               = DH_neutral
         c_pq  = c_pq.28
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.30
         nr_pk = nr_pk.31
         sig_j_pk
               = sig_j_pk.32
         z     = DH_neutral
         z.1   = DH_neutral
         z.2   = decap(c_pq.28, kdf(<'KEM', ~passphrase.26>))
         z.3   = verify(sig_j_pk.32, <'signature', j_sig_pk.30, DH_neutral>,
                        nr_pk.31)
    
      5. ~passphrase
               = ~passphrase.31
         c_dhkem
               = c_dhkem.32
         c_pq  = c_pq.33
         j_dh_pk
               = z.42^inv(kdf(<'DH', ~passphrase.31>))
         j_sig_pk
               = j_sig_pk.35
         nr_pk = nr_pk.36
         sig_j_pk
               = sig_j_pk.37
         z     = z.42
         z.1   = c_dhkem.32^kdf(<'DH', ~passphrase.31>)
         z.2   = decap(c_pq.33, kdf(<'KEM', ~passphrase.31>))
         z.3   = verify(sig_j_pk.37,
                        <'signature', j_sig_pk.35, z.42^inv(kdf(<'DH', ~passphrase.31>))>,
                        nr_pk.36)
    
      6. ~passphrase
               = ~passphrase.31
         c_dhkem
               = DH_neutral
         c_pq  = c_pq.33
         j_dh_pk
               = z.42^inv(kdf(<'DH', ~passphrase.31>))
         j_sig_pk
               = j_sig_pk.35
         nr_pk = nr_pk.36
         sig_j_pk
               = sig_j_pk.37
         z     = z.42
         z.1   = DH_neutral
         z.2   = decap(c_pq.33, kdf(<'KEM', ~passphrase.31>))
         z.3   = verify(sig_j_pk.37,
                        <'signature', j_sig_pk.35, z.42^inv(kdf(<'DH', ~passphrase.31>))>,
                        nr_pk.36)
    
      7. ~passphrase
               = ~passphrase.32
         c_dhkem
               = z.44^inv(kdf(<'DH', ~passphrase.32>))
         c_pq  = c_pq.34
         j_dh_pk
               = j_dh_pk.35
         j_sig_pk
               = j_sig_pk.36
         nr_pk = nr_pk.37
         sig_j_pk
               = sig_j_pk.38
         z     = j_dh_pk.35^kdf(<'DH', ~passphrase.32>)
         z.1   = z.44
         z.2   = decap(c_pq.34, kdf(<'KEM', ~passphrase.32>))
         z.3   = verify(sig_j_pk.38, <'signature', j_sig_pk.36, j_dh_pk.35>,
                        nr_pk.37)
    
      8. ~passphrase
               = ~passphrase.32
         c_dhkem
               = z.44^inv(kdf(<'DH', ~passphrase.32>))
         c_pq  = c_pq.34
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.36
         nr_pk = nr_pk.37
         sig_j_pk
               = sig_j_pk.38
         z     = DH_neutral
         z.1   = z.44
         z.2   = decap(c_pq.34, kdf(<'KEM', ~passphrase.32>))
         z.3   = verify(sig_j_pk.38, <'signature', j_sig_pk.36, DH_neutral>,
                        nr_pk.37)
    
      9. ~passphrase
               = ~passphrase.32
         c_dhkem
               = z.44^inv(kdf(<'DH', ~passphrase.32>))
         c_pq  = c_pq.34
         j_dh_pk
               = z.43^inv(kdf(<'DH', ~passphrase.32>))
         j_sig_pk
               = j_sig_pk.36
         nr_pk = nr_pk.37
         sig_j_pk
               = sig_j_pk.38
         z     = z.43
         z.1   = z.44
         z.2   = decap(c_pq.34, kdf(<'KEM', ~passphrase.32>))
         z.3   = verify(sig_j_pk.38,
                        <'signature', j_sig_pk.36, z.43^inv(kdf(<'DH', ~passphrase.32>))>,
                        nr_pk.37)
    
     10. ~passphrase
               = ~passphrase.33
         c_dhkem
               = c_dhkem.34
         c_pq  = encap(z.46, pqpk(kdf(<'KEM', ~passphrase.33>)))
         j_dh_pk
               = j_dh_pk.36
         j_sig_pk
               = j_sig_pk.37
         nr_pk = nr_pk.38
         sig_j_pk
               = sig_j_pk.39
         z     = j_dh_pk.36^kdf(<'DH', ~passphrase.33>)
         z.1   = c_dhkem.34^kdf(<'DH', ~passphrase.33>)
         z.2   = z.46
         z.3   = verify(sig_j_pk.39, <'signature', j_sig_pk.37, j_dh_pk.36>,
                        nr_pk.38)
    
     11. ~passphrase
               = ~passphrase.33
         c_dhkem
               = c_dhkem.34
         c_pq  = encap(z.46, pqpk(kdf(<'KEM', ~passphrase.33>)))
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.37
         nr_pk = nr_pk.38
         sig_j_pk
               = sig_j_pk.39
         z     = DH_neutral
         z.1   = c_dhkem.34^kdf(<'DH', ~passphrase.33>)
         z.2   = z.46
         z.3   = verify(sig_j_pk.39, <'signature', j_sig_pk.37, DH_neutral>,
                        nr_pk.38)
    
     12. ~passphrase
               = ~passphrase.33
         c_dhkem
               = c_dhkem.34
         c_pq  = encap(z.46, pqpk(kdf(<'KEM', ~passphrase.33>)))
         j_dh_pk
               = z.44^inv(kdf(<'DH', ~passphrase.33>))
         j_sig_pk
               = j_sig_pk.37
         nr_pk = nr_pk.38
         sig_j_pk
               = sig_j_pk.39
         z     = z.44
         z.1   = c_dhkem.34^kdf(<'DH', ~passphrase.33>)
         z.2   = z.46
         z.3   = verify(sig_j_pk.39,
                        <'signature', j_sig_pk.37, z.44^inv(kdf(<'DH', ~passphrase.33>))>,
                        nr_pk.38)
    
     13. ~passphrase
               = ~passphrase.33
         c_dhkem
               = DH_neutral
         c_pq  = encap(z.46, pqpk(kdf(<'KEM', ~passphrase.33>)))
         j_dh_pk
               = j_dh_pk.36
         j_sig_pk
               = j_sig_pk.37
         nr_pk = nr_pk.38
         sig_j_pk
               = sig_j_pk.39
         z     = j_dh_pk.36^kdf(<'DH', ~passphrase.33>)
         z.1   = DH_neutral
         z.2   = z.46
         z.3   = verify(sig_j_pk.39, <'signature', j_sig_pk.37, j_dh_pk.36>,
                        nr_pk.38)
    
     14. ~passphrase
               = ~passphrase.33
         c_dhkem
               = DH_neutral
         c_pq  = encap(z.46, pqpk(kdf(<'KEM', ~passphrase.33>)))
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.37
         nr_pk = nr_pk.38
         sig_j_pk
               = sig_j_pk.39
         z     = DH_neutral
         z.1   = DH_neutral
         z.2   = z.46
         z.3   = verify(sig_j_pk.39, <'signature', j_sig_pk.37, DH_neutral>,
                        nr_pk.38)
    
     15. ~passphrase
               = ~passphrase.33
         c_dhkem
               = DH_neutral
         c_pq  = encap(z.46, pqpk(kdf(<'KEM', ~passphrase.33>)))
         j_dh_pk
               = z.44^inv(kdf(<'DH', ~passphrase.33>))
         j_sig_pk
               = j_sig_pk.37
         nr_pk = nr_pk.38
         sig_j_pk
               = sig_j_pk.39
         z     = z.44
         z.1   = DH_neutral
         z.2   = z.46
         z.3   = verify(sig_j_pk.39,
                        <'signature', j_sig_pk.37, z.44^inv(kdf(<'DH', ~passphrase.33>))>,
                        nr_pk.38)
    
     16. ~passphrase
               = ~passphrase.33
         c_dhkem
               = z.45^inv(kdf(<'DH', ~passphrase.33>))
         c_pq  = encap(z.46, pqpk(kdf(<'KEM', ~passphrase.33>)))
         j_dh_pk
               = j_dh_pk.36
         j_sig_pk
               = j_sig_pk.37
         nr_pk = nr_pk.38
         sig_j_pk
               = sig_j_pk.39
         z     = j_dh_pk.36^kdf(<'DH', ~passphrase.33>)
         z.1   = z.45
         z.2   = z.46
         z.3   = verify(sig_j_pk.39, <'signature', j_sig_pk.37, j_dh_pk.36>,
                        nr_pk.38)
    
     17. ~passphrase
               = ~passphrase.33
         c_dhkem
               = z.45^inv(kdf(<'DH', ~passphrase.33>))
         c_pq  = encap(z.46, pqpk(kdf(<'KEM', ~passphrase.33>)))
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.37
         nr_pk = nr_pk.38
         sig_j_pk
               = sig_j_pk.39
         z     = DH_neutral
         z.1   = z.45
         z.2   = z.46
         z.3   = verify(sig_j_pk.39, <'signature', j_sig_pk.37, DH_neutral>,
                        nr_pk.38)
    
     18. ~passphrase
               = ~passphrase.33
         c_dhkem
               = z.45^inv(kdf(<'DH', ~passphrase.33>))
         c_pq  = encap(z.46, pqpk(kdf(<'KEM', ~passphrase.33>)))
         j_dh_pk
               = z.44^inv(kdf(<'DH', ~passphrase.33>))
         j_sig_pk
               = j_sig_pk.37
         nr_pk = nr_pk.38
         sig_j_pk
               = sig_j_pk.39
         z     = z.44
         z.1   = z.45
         z.2   = z.46
         z.3   = verify(sig_j_pk.39,
                        <'signature', j_sig_pk.37, z.44^inv(kdf(<'DH', ~passphrase.33>))>,
                        nr_pk.38)
    
     19. ~passphrase
               = ~passphrase.192
         c_dhkem
               = c_dhkem.193
         c_pq  = c_pq.194
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.196
         nr_pk = pk(x.379)
         sig_j_pk
               = sign(<'signature', j_sig_pk.196, DH_neutral>, x.379)
         z     = DH_neutral
         z.1   = c_dhkem.193^kdf(<'DH', ~passphrase.192>)
         z.2   = decap(c_pq.194, kdf(<'KEM', ~passphrase.192>))
         z.3   = true
    
     20. ~passphrase
               = ~passphrase.192
         c_dhkem
               = c_dhkem.193
         c_pq  = c_pq.194
         j_dh_pk
               = x.378^x.379
         j_sig_pk
               = j_sig_pk.196
         nr_pk = nr_pk.197
         sig_j_pk
               = sig_j_pk.198
         z     = x.378^(x.379*kdf(<'DH', ~passphrase.192>))
         z.1   = c_dhkem.193^kdf(<'DH', ~passphrase.192>)
         z.2   = decap(c_pq.194, kdf(<'KEM', ~passphrase.192>))
         z.3   = verify(sig_j_pk.198,
                        <'signature', j_sig_pk.196, x.378^x.379>, nr_pk.197)
    
     21. ~passphrase
               = ~passphrase.192
         c_dhkem
               = DH_neutral
         c_pq  = c_pq.194
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.196
         nr_pk = pk(x.379)
         sig_j_pk
               = sign(<'signature', j_sig_pk.196, DH_neutral>, x.379)
         z     = DH_neutral
         z.1   = DH_neutral
         z.2   = decap(c_pq.194, kdf(<'KEM', ~passphrase.192>))
         z.3   = true
    
     22. ~passphrase
               = ~passphrase.192
         c_dhkem
               = DH_neutral
         c_pq  = c_pq.194
         j_dh_pk
               = x.378^x.379
         j_sig_pk
               = j_sig_pk.196
         nr_pk = nr_pk.197
         sig_j_pk
               = sig_j_pk.198
         z     = x.378^(x.379*kdf(<'DH', ~passphrase.192>))
         z.1   = DH_neutral
         z.2   = decap(c_pq.194, kdf(<'KEM', ~passphrase.192>))
         z.3   = verify(sig_j_pk.198,
                        <'signature', j_sig_pk.196, x.378^x.379>, nr_pk.197)
    
     23. ~passphrase
               = ~passphrase.192
         c_dhkem
               = x.378^x.379
         c_pq  = c_pq.194
         j_dh_pk
               = j_dh_pk.195
         j_sig_pk
               = j_sig_pk.196
         nr_pk = nr_pk.197
         sig_j_pk
               = sig_j_pk.198
         z     = j_dh_pk.195^kdf(<'DH', ~passphrase.192>)
         z.1   = x.378^(x.379*kdf(<'DH', ~passphrase.192>))
         z.2   = decap(c_pq.194, kdf(<'KEM', ~passphrase.192>))
         z.3   = verify(sig_j_pk.198,
                        <'signature', j_sig_pk.196, j_dh_pk.195>, nr_pk.197)
    
     24. ~passphrase
               = ~passphrase.192
         c_dhkem
               = x.378^x.379
         c_pq  = c_pq.194
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.196
         nr_pk = nr_pk.197
         sig_j_pk
               = sig_j_pk.198
         z     = DH_neutral
         z.1   = x.378^(x.379*kdf(<'DH', ~passphrase.192>))
         z.2   = decap(c_pq.194, kdf(<'KEM', ~passphrase.192>))
         z.3   = verify(sig_j_pk.198,
                        <'signature', j_sig_pk.196, DH_neutral>, nr_pk.197)
    
     25. ~passphrase
               = ~passphrase.193
         c_dhkem
               = c_dhkem.194
         c_pq  = c_pq.195
         j_dh_pk
               = j_dh_pk.196
         j_sig_pk
               = j_sig_pk.197
         nr_pk = pk(x.381)
         sig_j_pk
               = sign(<'signature', j_sig_pk.197, j_dh_pk.196>, x.381)
         z     = j_dh_pk.196^kdf(<'DH', ~passphrase.193>)
         z.1   = c_dhkem.194^kdf(<'DH', ~passphrase.193>)
         z.2   = decap(c_pq.195, kdf(<'KEM', ~passphrase.193>))
         z.3   = true
    
     26. ~passphrase
               = ~passphrase.193
         c_dhkem
               = DH_neutral
         c_pq  = c_pq.195
         j_dh_pk
               = j_dh_pk.196
         j_sig_pk
               = j_sig_pk.197
         nr_pk = pk(x.381)
         sig_j_pk
               = sign(<'signature', j_sig_pk.197, j_dh_pk.196>, x.381)
         z     = j_dh_pk.196^kdf(<'DH', ~passphrase.193>)
         z.1   = DH_neutral
         z.2   = decap(c_pq.195, kdf(<'KEM', ~passphrase.193>))
         z.3   = true
    
     27. ~passphrase
               = ~passphrase.193
         c_dhkem
               = x.380^x.381
         c_pq  = c_pq.195
         j_dh_pk
               = z.204^inv(kdf(<'DH', ~passphrase.193>))
         j_sig_pk
               = j_sig_pk.197
         nr_pk = nr_pk.198
         sig_j_pk
               = sig_j_pk.199
         z     = z.204
         z.1   = x.380^(x.381*kdf(<'DH', ~passphrase.193>))
         z.2   = decap(c_pq.195, kdf(<'KEM', ~passphrase.193>))
         z.3   = verify(sig_j_pk.199,
                        <'signature', j_sig_pk.197, z.204^inv(kdf(<'DH', ~passphrase.193>))
                        >,
                        nr_pk.198)
    
     28. ~passphrase
               = ~passphrase.193
         c_dhkem
               = x.380^x.381
         c_pq  = encap(z.206, pqpk(kdf(<'KEM', ~passphrase.193>)))
         j_dh_pk
               = j_dh_pk.196
         j_sig_pk
               = j_sig_pk.197
         nr_pk = nr_pk.198
         sig_j_pk
               = sig_j_pk.199
         z     = j_dh_pk.196^kdf(<'DH', ~passphrase.193>)
         z.1   = x.380^(x.381*kdf(<'DH', ~passphrase.193>))
         z.2   = z.206
         z.3   = verify(sig_j_pk.199,
                        <'signature', j_sig_pk.197, j_dh_pk.196>, nr_pk.198)
    
     29. ~passphrase
               = ~passphrase.193
         c_dhkem
               = x.380^x.381
         c_pq  = encap(z.206, pqpk(kdf(<'KEM', ~passphrase.193>)))
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.197
         nr_pk = nr_pk.198
         sig_j_pk
               = sig_j_pk.199
         z     = DH_neutral
         z.1   = x.380^(x.381*kdf(<'DH', ~passphrase.193>))
         z.2   = z.206
         z.3   = verify(sig_j_pk.199,
                        <'signature', j_sig_pk.197, DH_neutral>, nr_pk.198)
    
     30. ~passphrase
               = ~passphrase.193
         c_dhkem
               = x.380^x.381
         c_pq  = encap(z.206, pqpk(kdf(<'KEM', ~passphrase.193>)))
         j_dh_pk
               = z.204^inv(kdf(<'DH', ~passphrase.193>))
         j_sig_pk
               = j_sig_pk.197
         nr_pk = nr_pk.198
         sig_j_pk
               = sig_j_pk.199
         z     = z.204
         z.1   = x.380^(x.381*kdf(<'DH', ~passphrase.193>))
         z.2   = z.206
         z.3   = verify(sig_j_pk.199,
                        <'signature', j_sig_pk.197, z.204^inv(kdf(<'DH', ~passphrase.193>))
                        >,
                        nr_pk.198)
    
     31. ~passphrase
               = ~passphrase.193
         c_dhkem
               = x.380^inv((x.381*kdf(<'DH', ~passphrase.193>)))
         c_pq  = c_pq.195
         j_dh_pk
               = j_dh_pk.196
         j_sig_pk
               = j_sig_pk.197
         nr_pk = nr_pk.198
         sig_j_pk
               = sig_j_pk.199
         z     = j_dh_pk.196^kdf(<'DH', ~passphrase.193>)
         z.1   = x.380^inv(x.381)
         z.2   = decap(c_pq.195, kdf(<'KEM', ~passphrase.193>))
         z.3   = verify(sig_j_pk.199,
                        <'signature', j_sig_pk.197, j_dh_pk.196>, nr_pk.198)
    
     32. ~passphrase
               = ~passphrase.193
         c_dhkem
               = x.380^inv((x.381*kdf(<'DH', ~passphrase.193>)))
         c_pq  = c_pq.195
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.197
         nr_pk = nr_pk.198
         sig_j_pk
               = sig_j_pk.199
         z     = DH_neutral
         z.1   = x.380^inv(x.381)
         z.2   = decap(c_pq.195, kdf(<'KEM', ~passphrase.193>))
         z.3   = verify(sig_j_pk.199,
                        <'signature', j_sig_pk.197, DH_neutral>, nr_pk.198)
    
     33. ~passphrase
               = ~passphrase.193
         c_dhkem
               = x.380^inv((x.381*kdf(<'DH', ~passphrase.193>)))
         c_pq  = c_pq.195
         j_dh_pk
               = z.204^inv(kdf(<'DH', ~passphrase.193>))
         j_sig_pk
               = j_sig_pk.197
         nr_pk = nr_pk.198
         sig_j_pk
               = sig_j_pk.199
         z     = z.204
         z.1   = x.380^inv(x.381)
         z.2   = decap(c_pq.195, kdf(<'KEM', ~passphrase.193>))
         z.3   = verify(sig_j_pk.199,
                        <'signature', j_sig_pk.197, z.204^inv(kdf(<'DH', ~passphrase.193>))
                        >,
                        nr_pk.198)
    
     34. ~passphrase
               = ~passphrase.193
         c_dhkem
               = x.380^inv((x.381*kdf(<'DH', ~passphrase.193>)))
         c_pq  = encap(z.206, pqpk(kdf(<'KEM', ~passphrase.193>)))
         j_dh_pk
               = j_dh_pk.196
         j_sig_pk
               = j_sig_pk.197
         nr_pk = nr_pk.198
         sig_j_pk
               = sig_j_pk.199
         z     = j_dh_pk.196^kdf(<'DH', ~passphrase.193>)
         z.1   = x.380^inv(x.381)
         z.2   = z.206
         z.3   = verify(sig_j_pk.199,
                        <'signature', j_sig_pk.197, j_dh_pk.196>, nr_pk.198)
    
     35. ~passphrase
               = ~passphrase.193
         c_dhkem
               = x.380^inv((x.381*kdf(<'DH', ~passphrase.193>)))
         c_pq  = encap(z.206, pqpk(kdf(<'KEM', ~passphrase.193>)))
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.197
         nr_pk = nr_pk.198
         sig_j_pk
               = sig_j_pk.199
         z     = DH_neutral
         z.1   = x.380^inv(x.381)
         z.2   = z.206
         z.3   = verify(sig_j_pk.199,
                        <'signature', j_sig_pk.197, DH_neutral>, nr_pk.198)
    
     36. ~passphrase
               = ~passphrase.193
         c_dhkem
               = x.380^inv((x.381*kdf(<'DH', ~passphrase.193>)))
         c_pq  = encap(z.206, pqpk(kdf(<'KEM', ~passphrase.193>)))
         j_dh_pk
               = z.204^inv(kdf(<'DH', ~passphrase.193>))
         j_sig_pk
               = j_sig_pk.197
         nr_pk = nr_pk.198
         sig_j_pk
               = sig_j_pk.199
         z     = z.204
         z.1   = x.380^inv(x.381)
         z.2   = z.206
         z.3   = verify(sig_j_pk.199,
                        <'signature', j_sig_pk.197, z.204^inv(kdf(<'DH', ~passphrase.193>))
                        >,
                        nr_pk.198)
    
     37. ~passphrase
               = ~passphrase.193
         c_dhkem
               = x.380^(x.381*inv(kdf(<'DH', ~passphrase.193>)))
         c_pq  = c_pq.195
         j_dh_pk
               = j_dh_pk.196
         j_sig_pk
               = j_sig_pk.197
         nr_pk = nr_pk.198
         sig_j_pk
               = sig_j_pk.199
         z     = j_dh_pk.196^kdf(<'DH', ~passphrase.193>)
         z.1   = x.380^x.381
         z.2   = decap(c_pq.195, kdf(<'KEM', ~passphrase.193>))
         z.3   = verify(sig_j_pk.199,
                        <'signature', j_sig_pk.197, j_dh_pk.196>, nr_pk.198)
    
     38. ~passphrase
               = ~passphrase.193
         c_dhkem
               = x.380^(x.381*inv(kdf(<'DH', ~passphrase.193>)))
         c_pq  = c_pq.195
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.197
         nr_pk = nr_pk.198
         sig_j_pk
               = sig_j_pk.199
         z     = DH_neutral
         z.1   = x.380^x.381
         z.2   = decap(c_pq.195, kdf(<'KEM', ~passphrase.193>))
         z.3   = verify(sig_j_pk.199,
                        <'signature', j_sig_pk.197, DH_neutral>, nr_pk.198)
    
     39. ~passphrase
               = ~passphrase.193
         c_dhkem
               = x.380^(x.381*inv(kdf(<'DH', ~passphrase.193>)))
         c_pq  = c_pq.195
         j_dh_pk
               = z.204^inv(kdf(<'DH', ~passphrase.193>))
         j_sig_pk
               = j_sig_pk.197
         nr_pk = nr_pk.198
         sig_j_pk
               = sig_j_pk.199
         z     = z.204
         z.1   = x.380^x.381
         z.2   = decap(c_pq.195, kdf(<'KEM', ~passphrase.193>))
         z.3   = verify(sig_j_pk.199,
                        <'signature', j_sig_pk.197, z.204^inv(kdf(<'DH', ~passphrase.193>))
                        >,
                        nr_pk.198)
    
     40. ~passphrase
               = ~passphrase.193
         c_dhkem
               = x.380^(x.381*inv(kdf(<'DH', ~passphrase.193>)))
         c_pq  = encap(z.206, pqpk(kdf(<'KEM', ~passphrase.193>)))
         j_dh_pk
               = j_dh_pk.196
         j_sig_pk
               = j_sig_pk.197
         nr_pk = nr_pk.198
         sig_j_pk
               = sig_j_pk.199
         z     = j_dh_pk.196^kdf(<'DH', ~passphrase.193>)
         z.1   = x.380^x.381
         z.2   = z.206
         z.3   = verify(sig_j_pk.199,
                        <'signature', j_sig_pk.197, j_dh_pk.196>, nr_pk.198)
    
     41. ~passphrase
               = ~passphrase.193
         c_dhkem
               = x.380^(x.381*inv(kdf(<'DH', ~passphrase.193>)))
         c_pq  = encap(z.206, pqpk(kdf(<'KEM', ~passphrase.193>)))
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.197
         nr_pk = nr_pk.198
         sig_j_pk
               = sig_j_pk.199
         z     = DH_neutral
         z.1   = x.380^x.381
         z.2   = z.206
         z.3   = verify(sig_j_pk.199,
                        <'signature', j_sig_pk.197, DH_neutral>, nr_pk.198)
    
     42. ~passphrase
               = ~passphrase.193
         c_dhkem
               = x.380^(x.381*inv(kdf(<'DH', ~passphrase.193>)))
         c_pq  = encap(z.206, pqpk(kdf(<'KEM', ~passphrase.193>)))
         j_dh_pk
               = z.204^inv(kdf(<'DH', ~passphrase.193>))
         j_sig_pk
               = j_sig_pk.197
         nr_pk = nr_pk.198
         sig_j_pk
               = sig_j_pk.199
         z     = z.204
         z.1   = x.380^x.381
         z.2   = z.206
         z.3   = verify(sig_j_pk.199,
                        <'signature', j_sig_pk.197, z.204^inv(kdf(<'DH', ~passphrase.193>))
                        >,
                        nr_pk.198)
    
     43. ~passphrase
               = ~passphrase.194
         c_dhkem
               = c_dhkem.195
         c_pq  = c_pq.196
         j_dh_pk
               = x.380^x.381
         j_sig_pk
               = j_sig_pk.198
         nr_pk = pk(x.383)
         sig_j_pk
               = sign(<'signature', j_sig_pk.198, x.380^x.381>, x.383)
         z     = x.380^(x.381*kdf(<'DH', ~passphrase.194>))
         z.1   = c_dhkem.195^kdf(<'DH', ~passphrase.194>)
         z.2   = decap(c_pq.196, kdf(<'KEM', ~passphrase.194>))
         z.3   = true
    
     44. ~passphrase
               = ~passphrase.194
         c_dhkem
               = DH_neutral
         c_pq  = c_pq.196
         j_dh_pk
               = x.380^x.381
         j_sig_pk
               = j_sig_pk.198
         nr_pk = pk(x.383)
         sig_j_pk
               = sign(<'signature', j_sig_pk.198, x.380^x.381>, x.383)
         z     = x.380^(x.381*kdf(<'DH', ~passphrase.194>))
         z.1   = DH_neutral
         z.2   = decap(c_pq.196, kdf(<'KEM', ~passphrase.194>))
         z.3   = true
    
     45. ~passphrase
               = ~passphrase.194
         c_dhkem
               = DH_neutral
         c_pq  = c_pq.196
         j_dh_pk
               = x.382^inv((x.383*kdf(<'DH', ~passphrase.194>)))
         j_sig_pk
               = j_sig_pk.198
         nr_pk = nr_pk.199
         sig_j_pk
               = sig_j_pk.200
         z     = x.382^inv(x.383)
         z.1   = DH_neutral
         z.2   = decap(c_pq.196, kdf(<'KEM', ~passphrase.194>))
         z.3   = verify(sig_j_pk.200,
                        <'signature', j_sig_pk.198, 
                         x.382^inv((x.383*kdf(<'DH', ~passphrase.194>)))>,
                        nr_pk.199)
    
     46. ~passphrase
               = ~passphrase.194
         c_dhkem
               = DH_neutral
         c_pq  = c_pq.196
         j_dh_pk
               = x.382^(x.383*inv(kdf(<'DH', ~passphrase.194>)))
         j_sig_pk
               = j_sig_pk.198
         nr_pk = nr_pk.199
         sig_j_pk
               = sig_j_pk.200
         z     = x.382^x.383
         z.1   = DH_neutral
         z.2   = decap(c_pq.196, kdf(<'KEM', ~passphrase.194>))
         z.3   = verify(sig_j_pk.200,
                        <'signature', j_sig_pk.198, 
                         x.382^(x.383*inv(kdf(<'DH', ~passphrase.194>)))>,
                        nr_pk.199)
    
     47. ~passphrase
               = ~passphrase.194
         c_dhkem
               = DH_neutral
         c_pq  = encap(z.207, pqpk(kdf(<'KEM', ~passphrase.194>)))
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.198
         nr_pk = pk(x.383)
         sig_j_pk
               = sign(<'signature', j_sig_pk.198, DH_neutral>, x.383)
         z     = DH_neutral
         z.1   = DH_neutral
         z.2   = z.207
         z.3   = true
    
     48. ~passphrase
               = ~passphrase.194
         c_dhkem
               = DH_neutral
         c_pq  = encap(z.207, pqpk(kdf(<'KEM', ~passphrase.194>)))
         j_dh_pk
               = x.382^x.383
         j_sig_pk
               = j_sig_pk.198
         nr_pk = nr_pk.199
         sig_j_pk
               = sig_j_pk.200
         z     = x.382^(x.383*kdf(<'DH', ~passphrase.194>))
         z.1   = DH_neutral
         z.2   = z.207
         z.3   = verify(sig_j_pk.200,
                        <'signature', j_sig_pk.198, x.382^x.383>, nr_pk.199)
    
     49. ~passphrase
               = ~passphrase.194
         c_dhkem
               = DH_neutral
         c_pq  = encap(z.207, pqpk(kdf(<'KEM', ~passphrase.194>)))
         j_dh_pk
               = x.382^inv((x.383*kdf(<'DH', ~passphrase.194>)))
         j_sig_pk
               = j_sig_pk.198
         nr_pk = nr_pk.199
         sig_j_pk
               = sig_j_pk.200
         z     = x.382^inv(x.383)
         z.1   = DH_neutral
         z.2   = z.207
         z.3   = verify(sig_j_pk.200,
                        <'signature', j_sig_pk.198, 
                         x.382^inv((x.383*kdf(<'DH', ~passphrase.194>)))>,
                        nr_pk.199)
    
     50. ~passphrase
               = ~passphrase.194
         c_dhkem
               = DH_neutral
         c_pq  = encap(z.207, pqpk(kdf(<'KEM', ~passphrase.194>)))
         j_dh_pk
               = x.382^(x.383*inv(kdf(<'DH', ~passphrase.194>)))
         j_sig_pk
               = j_sig_pk.198
         nr_pk = nr_pk.199
         sig_j_pk
               = sig_j_pk.200
         z     = x.382^x.383
         z.1   = DH_neutral
         z.2   = z.207
         z.3   = verify(sig_j_pk.200,
                        <'signature', j_sig_pk.198, 
                         x.382^(x.383*inv(kdf(<'DH', ~passphrase.194>)))>,
                        nr_pk.199)
    
     51. ~passphrase
               = ~passphrase.194
         c_dhkem
               = x.381^(x.382*inv((x.383*kdf(<'DH', ~passphrase.194>))))
         c_pq  = c_pq.196
         j_dh_pk
               = j_dh_pk.197
         j_sig_pk
               = j_sig_pk.198
         nr_pk = nr_pk.199
         sig_j_pk
               = sig_j_pk.200
         z     = j_dh_pk.197^kdf(<'DH', ~passphrase.194>)
         z.1   = x.381^(x.382*inv(x.383))
         z.2   = decap(c_pq.196, kdf(<'KEM', ~passphrase.194>))
         z.3   = verify(sig_j_pk.200,
                        <'signature', j_sig_pk.198, j_dh_pk.197>, nr_pk.199)
    
     52. ~passphrase
               = ~passphrase.194
         c_dhkem
               = x.381^(x.382*inv((x.383*kdf(<'DH', ~passphrase.194>))))
         c_pq  = c_pq.196
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.198
         nr_pk = nr_pk.199
         sig_j_pk
               = sig_j_pk.200
         z     = DH_neutral
         z.1   = x.381^(x.382*inv(x.383))
         z.2   = decap(c_pq.196, kdf(<'KEM', ~passphrase.194>))
         z.3   = verify(sig_j_pk.200,
                        <'signature', j_sig_pk.198, DH_neutral>, nr_pk.199)
    
     53. ~passphrase
               = ~passphrase.194
         c_dhkem
               = x.381^(x.382*inv((x.383*kdf(<'DH', ~passphrase.194>))))
         c_pq  = c_pq.196
         j_dh_pk
               = z.205^inv(kdf(<'DH', ~passphrase.194>))
         j_sig_pk
               = j_sig_pk.198
         nr_pk = nr_pk.199
         sig_j_pk
               = sig_j_pk.200
         z     = z.205
         z.1   = x.381^(x.382*inv(x.383))
         z.2   = decap(c_pq.196, kdf(<'KEM', ~passphrase.194>))
         z.3   = verify(sig_j_pk.200,
                        <'signature', j_sig_pk.198, z.205^inv(kdf(<'DH', ~passphrase.194>))
                        >,
                        nr_pk.199)
    
     54. ~passphrase
               = ~passphrase.194
         c_dhkem
               = x.381^(x.382*inv((x.383*kdf(<'DH', ~passphrase.194>))))
         c_pq  = encap(z.207, pqpk(kdf(<'KEM', ~passphrase.194>)))
         j_dh_pk
               = j_dh_pk.197
         j_sig_pk
               = j_sig_pk.198
         nr_pk = nr_pk.199
         sig_j_pk
               = sig_j_pk.200
         z     = j_dh_pk.197^kdf(<'DH', ~passphrase.194>)
         z.1   = x.381^(x.382*inv(x.383))
         z.2   = z.207
         z.3   = verify(sig_j_pk.200,
                        <'signature', j_sig_pk.198, j_dh_pk.197>, nr_pk.199)
    
     55. ~passphrase
               = ~passphrase.194
         c_dhkem
               = x.381^(x.382*inv((x.383*kdf(<'DH', ~passphrase.194>))))
         c_pq  = encap(z.207, pqpk(kdf(<'KEM', ~passphrase.194>)))
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.198
         nr_pk = nr_pk.199
         sig_j_pk
               = sig_j_pk.200
         z     = DH_neutral
         z.1   = x.381^(x.382*inv(x.383))
         z.2   = z.207
         z.3   = verify(sig_j_pk.200,
                        <'signature', j_sig_pk.198, DH_neutral>, nr_pk.199)
    
     56. ~passphrase
               = ~passphrase.194
         c_dhkem
               = x.381^(x.382*inv((x.383*kdf(<'DH', ~passphrase.194>))))
         c_pq  = encap(z.207, pqpk(kdf(<'KEM', ~passphrase.194>)))
         j_dh_pk
               = z.205^inv(kdf(<'DH', ~passphrase.194>))
         j_sig_pk
               = j_sig_pk.198
         nr_pk = nr_pk.199
         sig_j_pk
               = sig_j_pk.200
         z     = z.205
         z.1   = x.381^(x.382*inv(x.383))
         z.2   = z.207
         z.3   = verify(sig_j_pk.200,
                        <'signature', j_sig_pk.198, z.205^inv(kdf(<'DH', ~passphrase.194>))
                        >,
                        nr_pk.199)
    
     57. ~passphrase
               = ~passphrase.195
         c_dhkem
               = c_dhkem.196
         c_pq  = c_pq.197
         j_dh_pk
               = x.384^inv((x.385*kdf(<'DH', ~passphrase.195>)))
         j_sig_pk
               = j_sig_pk.199
         nr_pk = nr_pk.200
         sig_j_pk
               = sig_j_pk.201
         z     = x.384^inv(x.385)
         z.1   = c_dhkem.196^kdf(<'DH', ~passphrase.195>)
         z.2   = decap(c_pq.197, kdf(<'KEM', ~passphrase.195>))
         z.3   = verify(sig_j_pk.201,
                        <'signature', j_sig_pk.199, 
                         x.384^inv((x.385*kdf(<'DH', ~passphrase.195>)))>,
                        nr_pk.200)
    
     58. ~passphrase
               = ~passphrase.195
         c_dhkem
               = c_dhkem.196
         c_pq  = c_pq.197
         j_dh_pk
               = x.384^(x.385*inv(kdf(<'DH', ~passphrase.195>)))
         j_sig_pk
               = j_sig_pk.199
         nr_pk = nr_pk.200
         sig_j_pk
               = sig_j_pk.201
         z     = x.384^x.385
         z.1   = c_dhkem.196^kdf(<'DH', ~passphrase.195>)
         z.2   = decap(c_pq.197, kdf(<'KEM', ~passphrase.195>))
         z.3   = verify(sig_j_pk.201,
                        <'signature', j_sig_pk.199, 
                         x.384^(x.385*inv(kdf(<'DH', ~passphrase.195>)))>,
                        nr_pk.200)
    
     59. ~passphrase
               = ~passphrase.195
         c_dhkem
               = c_dhkem.196
         c_pq  = encap(z.208, pqpk(kdf(<'KEM', ~passphrase.195>)))
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.199
         nr_pk = pk(x.385)
         sig_j_pk
               = sign(<'signature', j_sig_pk.199, DH_neutral>, x.385)
         z     = DH_neutral
         z.1   = c_dhkem.196^kdf(<'DH', ~passphrase.195>)
         z.2   = z.208
         z.3   = true
    
     60. ~passphrase
               = ~passphrase.195
         c_dhkem
               = c_dhkem.196
         c_pq  = encap(z.208, pqpk(kdf(<'KEM', ~passphrase.195>)))
         j_dh_pk
               = x.384^x.385
         j_sig_pk
               = j_sig_pk.199
         nr_pk = nr_pk.200
         sig_j_pk
               = sig_j_pk.201
         z     = x.384^(x.385*kdf(<'DH', ~passphrase.195>))
         z.1   = c_dhkem.196^kdf(<'DH', ~passphrase.195>)
         z.2   = z.208
         z.3   = verify(sig_j_pk.201,
                        <'signature', j_sig_pk.199, x.384^x.385>, nr_pk.200)
    
     61. ~passphrase
               = ~passphrase.195
         c_dhkem
               = c_dhkem.196
         c_pq  = encap(z.208, pqpk(kdf(<'KEM', ~passphrase.195>)))
         j_dh_pk
               = x.384^inv((x.385*kdf(<'DH', ~passphrase.195>)))
         j_sig_pk
               = j_sig_pk.199
         nr_pk = nr_pk.200
         sig_j_pk
               = sig_j_pk.201
         z     = x.384^inv(x.385)
         z.1   = c_dhkem.196^kdf(<'DH', ~passphrase.195>)
         z.2   = z.208
         z.3   = verify(sig_j_pk.201,
                        <'signature', j_sig_pk.199, 
                         x.384^inv((x.385*kdf(<'DH', ~passphrase.195>)))>,
                        nr_pk.200)
    
     62. ~passphrase
               = ~passphrase.195
         c_dhkem
               = c_dhkem.196
         c_pq  = encap(z.208, pqpk(kdf(<'KEM', ~passphrase.195>)))
         j_dh_pk
               = x.384^(x.385*inv(kdf(<'DH', ~passphrase.195>)))
         j_sig_pk
               = j_sig_pk.199
         nr_pk = nr_pk.200
         sig_j_pk
               = sig_j_pk.201
         z     = x.384^x.385
         z.1   = c_dhkem.196^kdf(<'DH', ~passphrase.195>)
         z.2   = z.208
         z.3   = verify(sig_j_pk.201,
                        <'signature', j_sig_pk.199, 
                         x.384^(x.385*inv(kdf(<'DH', ~passphrase.195>)))>,
                        nr_pk.200)
    
     63. ~passphrase
               = ~passphrase.195
         c_dhkem
               = DH_neutral
         c_pq  = c_pq.197
         j_dh_pk
               = z.206^inv(kdf(<'DH', ~passphrase.195>))
         j_sig_pk
               = j_sig_pk.199
         nr_pk = pk(x.385)
         sig_j_pk
               = sign(<'signature', j_sig_pk.199, 
                       z.206^inv(kdf(<'DH', ~passphrase.195>))>,
                      x.385)
         z     = z.206
         z.1   = DH_neutral
         z.2   = decap(c_pq.197, kdf(<'KEM', ~passphrase.195>))
         z.3   = true
    
     64. ~passphrase
               = ~passphrase.195
         c_dhkem
               = DH_neutral
         c_pq  = c_pq.197
         j_dh_pk
               = x.383^(x.384*inv((x.385*kdf(<'DH', ~passphrase.195>))))
         j_sig_pk
               = j_sig_pk.199
         nr_pk = nr_pk.200
         sig_j_pk
               = sig_j_pk.201
         z     = x.383^(x.384*inv(x.385))
         z.1   = DH_neutral
         z.2   = decap(c_pq.197, kdf(<'KEM', ~passphrase.195>))
         z.3   = verify(sig_j_pk.201,
                        <'signature', j_sig_pk.199, 
                         x.383^(x.384*inv((x.385*kdf(<'DH', ~passphrase.195>))))>,
                        nr_pk.200)
    
     65. ~passphrase
               = ~passphrase.195
         c_dhkem
               = DH_neutral
         c_pq  = encap(z.208, pqpk(kdf(<'KEM', ~passphrase.195>)))
         j_dh_pk
               = j_dh_pk.198
         j_sig_pk
               = j_sig_pk.199
         nr_pk = pk(x.385)
         sig_j_pk
               = sign(<'signature', j_sig_pk.199, j_dh_pk.198>, x.385)
         z     = j_dh_pk.198^kdf(<'DH', ~passphrase.195>)
         z.1   = DH_neutral
         z.2   = z.208
         z.3   = true
    
     66. ~passphrase
               = ~passphrase.195
         c_dhkem
               = DH_neutral
         c_pq  = encap(z.208, pqpk(kdf(<'KEM', ~passphrase.195>)))
         j_dh_pk
               = z.206^inv(kdf(<'DH', ~passphrase.195>))
         j_sig_pk
               = j_sig_pk.199
         nr_pk = pk(x.385)
         sig_j_pk
               = sign(<'signature', j_sig_pk.199, 
                       z.206^inv(kdf(<'DH', ~passphrase.195>))>,
                      x.385)
         z     = z.206
         z.1   = DH_neutral
         z.2   = z.208
         z.3   = true
    
     67. ~passphrase
               = ~passphrase.195
         c_dhkem
               = DH_neutral
         c_pq  = encap(z.208, pqpk(kdf(<'KEM', ~passphrase.195>)))
         j_dh_pk
               = x.383^(x.384*inv((x.385*kdf(<'DH', ~passphrase.195>))))
         j_sig_pk
               = j_sig_pk.199
         nr_pk = nr_pk.200
         sig_j_pk
               = sig_j_pk.201
         z     = x.383^(x.384*inv(x.385))
         z.1   = DH_neutral
         z.2   = z.208
         z.3   = verify(sig_j_pk.201,
                        <'signature', j_sig_pk.199, 
                         x.383^(x.384*inv((x.385*kdf(<'DH', ~passphrase.195>))))>,
                        nr_pk.200)
    
     68. ~passphrase
               = ~passphrase.195
         c_dhkem
               = z.207^inv(kdf(<'DH', ~passphrase.195>))
         c_pq  = c_pq.197
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.199
         nr_pk = pk(x.385)
         sig_j_pk
               = sign(<'signature', j_sig_pk.199, DH_neutral>, x.385)
         z     = DH_neutral
         z.1   = z.207
         z.2   = decap(c_pq.197, kdf(<'KEM', ~passphrase.195>))
         z.3   = true
    
     69. ~passphrase
               = ~passphrase.195
         c_dhkem
               = z.207^inv(kdf(<'DH', ~passphrase.195>))
         c_pq  = c_pq.197
         j_dh_pk
               = x.384^x.385
         j_sig_pk
               = j_sig_pk.199
         nr_pk = nr_pk.200
         sig_j_pk
               = sig_j_pk.201
         z     = x.384^(x.385*kdf(<'DH', ~passphrase.195>))
         z.1   = z.207
         z.2   = decap(c_pq.197, kdf(<'KEM', ~passphrase.195>))
         z.3   = verify(sig_j_pk.201,
                        <'signature', j_sig_pk.199, x.384^x.385>, nr_pk.200)
    
     70. ~passphrase
               = ~passphrase.195
         c_dhkem
               = z.207^inv(kdf(<'DH', ~passphrase.195>))
         c_pq  = c_pq.197
         j_dh_pk
               = x.384^inv((x.385*kdf(<'DH', ~passphrase.195>)))
         j_sig_pk
               = j_sig_pk.199
         nr_pk = nr_pk.200
         sig_j_pk
               = sig_j_pk.201
         z     = x.384^inv(x.385)
         z.1   = z.207
         z.2   = decap(c_pq.197, kdf(<'KEM', ~passphrase.195>))
         z.3   = verify(sig_j_pk.201,
                        <'signature', j_sig_pk.199, 
                         x.384^inv((x.385*kdf(<'DH', ~passphrase.195>)))>,
                        nr_pk.200)
    
     71. ~passphrase
               = ~passphrase.195
         c_dhkem
               = z.207^inv(kdf(<'DH', ~passphrase.195>))
         c_pq  = c_pq.197
         j_dh_pk
               = x.384^(x.385*inv(kdf(<'DH', ~passphrase.195>)))
         j_sig_pk
               = j_sig_pk.199
         nr_pk = nr_pk.200
         sig_j_pk
               = sig_j_pk.201
         z     = x.384^x.385
         z.1   = z.207
         z.2   = decap(c_pq.197, kdf(<'KEM', ~passphrase.195>))
         z.3   = verify(sig_j_pk.201,
                        <'signature', j_sig_pk.199, 
                         x.384^(x.385*inv(kdf(<'DH', ~passphrase.195>)))>,
                        nr_pk.200)
    
     72. ~passphrase
               = ~passphrase.195
         c_dhkem
               = z.207^inv(kdf(<'DH', ~passphrase.195>))
         c_pq  = encap(z.208, pqpk(kdf(<'KEM', ~passphrase.195>)))
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.199
         nr_pk = pk(x.385)
         sig_j_pk
               = sign(<'signature', j_sig_pk.199, DH_neutral>, x.385)
         z     = DH_neutral
         z.1   = z.207
         z.2   = z.208
         z.3   = true
    
     73. ~passphrase
               = ~passphrase.195
         c_dhkem
               = z.207^inv(kdf(<'DH', ~passphrase.195>))
         c_pq  = encap(z.208, pqpk(kdf(<'KEM', ~passphrase.195>)))
         j_dh_pk
               = x.384^x.385
         j_sig_pk
               = j_sig_pk.199
         nr_pk = nr_pk.200
         sig_j_pk
               = sig_j_pk.201
         z     = x.384^(x.385*kdf(<'DH', ~passphrase.195>))
         z.1   = z.207
         z.2   = z.208
         z.3   = verify(sig_j_pk.201,
                        <'signature', j_sig_pk.199, x.384^x.385>, nr_pk.200)
    
     74. ~passphrase
               = ~passphrase.195
         c_dhkem
               = z.207^inv(kdf(<'DH', ~passphrase.195>))
         c_pq  = encap(z.208, pqpk(kdf(<'KEM', ~passphrase.195>)))
         j_dh_pk
               = x.384^inv((x.385*kdf(<'DH', ~passphrase.195>)))
         j_sig_pk
               = j_sig_pk.199
         nr_pk = nr_pk.200
         sig_j_pk
               = sig_j_pk.201
         z     = x.384^inv(x.385)
         z.1   = z.207
         z.2   = z.208
         z.3   = verify(sig_j_pk.201,
                        <'signature', j_sig_pk.199, 
                         x.384^inv((x.385*kdf(<'DH', ~passphrase.195>)))>,
                        nr_pk.200)
    
     75. ~passphrase
               = ~passphrase.195
         c_dhkem
               = z.207^inv(kdf(<'DH', ~passphrase.195>))
         c_pq  = encap(z.208, pqpk(kdf(<'KEM', ~passphrase.195>)))
         j_dh_pk
               = x.384^(x.385*inv(kdf(<'DH', ~passphrase.195>)))
         j_sig_pk
               = j_sig_pk.199
         nr_pk = nr_pk.200
         sig_j_pk
               = sig_j_pk.201
         z     = x.384^x.385
         z.1   = z.207
         z.2   = z.208
         z.3   = verify(sig_j_pk.201,
                        <'signature', j_sig_pk.199, 
                         x.384^(x.385*inv(kdf(<'DH', ~passphrase.195>)))>,
                        nr_pk.200)
    
     76. ~passphrase
               = ~passphrase.195
         c_dhkem
               = x.381^x.382
         c_pq  = c_pq.197
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.199
         nr_pk = pk(x.385)
         sig_j_pk
               = sign(<'signature', j_sig_pk.199, DH_neutral>, x.385)
         z     = DH_neutral
         z.1   = x.381^(x.382*kdf(<'DH', ~passphrase.195>))
         z.2   = decap(c_pq.197, kdf(<'KEM', ~passphrase.195>))
         z.3   = true
    
     77. ~passphrase
               = ~passphrase.195
         c_dhkem
               = x.381^x.382
         c_pq  = c_pq.197
         j_dh_pk
               = x.384^x.385
         j_sig_pk
               = j_sig_pk.199
         nr_pk = nr_pk.200
         sig_j_pk
               = sig_j_pk.201
         z     = x.384^(x.385*kdf(<'DH', ~passphrase.195>))
         z.1   = x.381^(x.382*kdf(<'DH', ~passphrase.195>))
         z.2   = decap(c_pq.197, kdf(<'KEM', ~passphrase.195>))
         z.3   = verify(sig_j_pk.201,
                        <'signature', j_sig_pk.199, x.384^x.385>, nr_pk.200)
    
     78. ~passphrase
               = ~passphrase.196
         c_dhkem
               = c_dhkem.197
         c_pq  = c_pq.198
         j_dh_pk
               = z.207^inv(kdf(<'DH', ~passphrase.196>))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = pk(x.387)
         sig_j_pk
               = sign(<'signature', j_sig_pk.200, 
                       z.207^inv(kdf(<'DH', ~passphrase.196>))>,
                      x.387)
         z     = z.207
         z.1   = c_dhkem.197^kdf(<'DH', ~passphrase.196>)
         z.2   = decap(c_pq.198, kdf(<'KEM', ~passphrase.196>))
         z.3   = true
    
     79. ~passphrase
               = ~passphrase.196
         c_dhkem
               = c_dhkem.197
         c_pq  = c_pq.198
         j_dh_pk
               = x.385^(x.386*inv((x.387*kdf(<'DH', ~passphrase.196>))))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.385^(x.386*inv(x.387))
         z.1   = c_dhkem.197^kdf(<'DH', ~passphrase.196>)
         z.2   = decap(c_pq.198, kdf(<'KEM', ~passphrase.196>))
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, 
                         x.385^(x.386*inv((x.387*kdf(<'DH', ~passphrase.196>))))>,
                        nr_pk.201)
    
     80. ~passphrase
               = ~passphrase.196
         c_dhkem
               = c_dhkem.197
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = j_dh_pk.199
         j_sig_pk
               = j_sig_pk.200
         nr_pk = pk(x.387)
         sig_j_pk
               = sign(<'signature', j_sig_pk.200, j_dh_pk.199>, x.387)
         z     = j_dh_pk.199^kdf(<'DH', ~passphrase.196>)
         z.1   = c_dhkem.197^kdf(<'DH', ~passphrase.196>)
         z.2   = z.209
         z.3   = true
    
     81. ~passphrase
               = ~passphrase.196
         c_dhkem
               = c_dhkem.197
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = z.207^inv(kdf(<'DH', ~passphrase.196>))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = pk(x.387)
         sig_j_pk
               = sign(<'signature', j_sig_pk.200, 
                       z.207^inv(kdf(<'DH', ~passphrase.196>))>,
                      x.387)
         z     = z.207
         z.1   = c_dhkem.197^kdf(<'DH', ~passphrase.196>)
         z.2   = z.209
         z.3   = true
    
     82. ~passphrase
               = ~passphrase.196
         c_dhkem
               = c_dhkem.197
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = x.385^(x.386*inv((x.387*kdf(<'DH', ~passphrase.196>))))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.385^(x.386*inv(x.387))
         z.1   = c_dhkem.197^kdf(<'DH', ~passphrase.196>)
         z.2   = z.209
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, 
                         x.385^(x.386*inv((x.387*kdf(<'DH', ~passphrase.196>))))>,
                        nr_pk.201)
    
     83. ~passphrase
               = ~passphrase.196
         c_dhkem
               = DH_neutral
         c_pq  = c_pq.198
         j_dh_pk
               = x.384^inv((x.385*kdf(<'DH', ~passphrase.196>)))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = pk(x.387)
         sig_j_pk
               = sign(<'signature', j_sig_pk.200, 
                       x.384^inv((x.385*kdf(<'DH', ~passphrase.196>)))>,
                      x.387)
         z     = x.384^inv(x.385)
         z.1   = DH_neutral
         z.2   = decap(c_pq.198, kdf(<'KEM', ~passphrase.196>))
         z.3   = true
    
     84. ~passphrase
               = ~passphrase.196
         c_dhkem
               = DH_neutral
         c_pq  = c_pq.198
         j_dh_pk
               = x.384^(x.385*inv(kdf(<'DH', ~passphrase.196>)))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = pk(x.387)
         sig_j_pk
               = sign(<'signature', j_sig_pk.200, 
                       x.384^(x.385*inv(kdf(<'DH', ~passphrase.196>)))>,
                      x.387)
         z     = x.384^x.385
         z.1   = DH_neutral
         z.2   = decap(c_pq.198, kdf(<'KEM', ~passphrase.196>))
         z.3   = true
    
     85. ~passphrase
               = ~passphrase.196
         c_dhkem
               = DH_neutral
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = x.384^x.385
         j_sig_pk
               = j_sig_pk.200
         nr_pk = pk(x.387)
         sig_j_pk
               = sign(<'signature', j_sig_pk.200, x.384^x.385>, x.387)
         z     = x.384^(x.385*kdf(<'DH', ~passphrase.196>))
         z.1   = DH_neutral
         z.2   = z.209
         z.3   = true
    
     86. ~passphrase
               = ~passphrase.196
         c_dhkem
               = DH_neutral
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = x.384^inv((x.385*kdf(<'DH', ~passphrase.196>)))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = pk(x.387)
         sig_j_pk
               = sign(<'signature', j_sig_pk.200, 
                       x.384^inv((x.385*kdf(<'DH', ~passphrase.196>)))>,
                      x.387)
         z     = x.384^inv(x.385)
         z.1   = DH_neutral
         z.2   = z.209
         z.3   = true
    
     87. ~passphrase
               = ~passphrase.196
         c_dhkem
               = DH_neutral
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = x.384^(x.385*inv(kdf(<'DH', ~passphrase.196>)))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = pk(x.387)
         sig_j_pk
               = sign(<'signature', j_sig_pk.200, 
                       x.384^(x.385*inv(kdf(<'DH', ~passphrase.196>)))>,
                      x.387)
         z     = x.384^x.385
         z.1   = DH_neutral
         z.2   = z.209
         z.3   = true
    
     88. ~passphrase
               = ~passphrase.196
         c_dhkem
               = z.208^inv(kdf(<'DH', ~passphrase.196>))
         c_pq  = c_pq.198
         j_dh_pk
               = j_dh_pk.199
         j_sig_pk
               = j_sig_pk.200
         nr_pk = pk(x.387)
         sig_j_pk
               = sign(<'signature', j_sig_pk.200, j_dh_pk.199>, x.387)
         z     = j_dh_pk.199^kdf(<'DH', ~passphrase.196>)
         z.1   = z.208
         z.2   = decap(c_pq.198, kdf(<'KEM', ~passphrase.196>))
         z.3   = true
    
     89. ~passphrase
               = ~passphrase.196
         c_dhkem
               = z.208^inv(kdf(<'DH', ~passphrase.196>))
         c_pq  = c_pq.198
         j_dh_pk
               = z.207^inv(kdf(<'DH', ~passphrase.196>))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = pk(x.387)
         sig_j_pk
               = sign(<'signature', j_sig_pk.200, 
                       z.207^inv(kdf(<'DH', ~passphrase.196>))>,
                      x.387)
         z     = z.207
         z.1   = z.208
         z.2   = decap(c_pq.198, kdf(<'KEM', ~passphrase.196>))
         z.3   = true
    
     90. ~passphrase
               = ~passphrase.196
         c_dhkem
               = z.208^inv(kdf(<'DH', ~passphrase.196>))
         c_pq  = c_pq.198
         j_dh_pk
               = x.385^(x.386*inv((x.387*kdf(<'DH', ~passphrase.196>))))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.385^(x.386*inv(x.387))
         z.1   = z.208
         z.2   = decap(c_pq.198, kdf(<'KEM', ~passphrase.196>))
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, 
                         x.385^(x.386*inv((x.387*kdf(<'DH', ~passphrase.196>))))>,
                        nr_pk.201)
    
     91. ~passphrase
               = ~passphrase.196
         c_dhkem
               = z.208^inv(kdf(<'DH', ~passphrase.196>))
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = j_dh_pk.199
         j_sig_pk
               = j_sig_pk.200
         nr_pk = pk(x.387)
         sig_j_pk
               = sign(<'signature', j_sig_pk.200, j_dh_pk.199>, x.387)
         z     = j_dh_pk.199^kdf(<'DH', ~passphrase.196>)
         z.1   = z.208
         z.2   = z.209
         z.3   = true
    
     92. ~passphrase
               = ~passphrase.196
         c_dhkem
               = z.208^inv(kdf(<'DH', ~passphrase.196>))
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = z.207^inv(kdf(<'DH', ~passphrase.196>))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = pk(x.387)
         sig_j_pk
               = sign(<'signature', j_sig_pk.200, 
                       z.207^inv(kdf(<'DH', ~passphrase.196>))>,
                      x.387)
         z     = z.207
         z.1   = z.208
         z.2   = z.209
         z.3   = true
    
     93. ~passphrase
               = ~passphrase.196
         c_dhkem
               = z.208^inv(kdf(<'DH', ~passphrase.196>))
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = x.385^(x.386*inv((x.387*kdf(<'DH', ~passphrase.196>))))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.385^(x.386*inv(x.387))
         z.1   = z.208
         z.2   = z.209
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, 
                         x.385^(x.386*inv((x.387*kdf(<'DH', ~passphrase.196>))))>,
                        nr_pk.201)
    
     94. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.382^x.383
         c_pq  = c_pq.198
         j_dh_pk
               = j_dh_pk.199
         j_sig_pk
               = j_sig_pk.200
         nr_pk = pk(x.387)
         sig_j_pk
               = sign(<'signature', j_sig_pk.200, j_dh_pk.199>, x.387)
         z     = j_dh_pk.199^kdf(<'DH', ~passphrase.196>)
         z.1   = x.382^(x.383*kdf(<'DH', ~passphrase.196>))
         z.2   = decap(c_pq.198, kdf(<'KEM', ~passphrase.196>))
         z.3   = true
    
     95. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^x.384
         c_pq  = c_pq.198
         j_dh_pk
               = x.386^inv((x.387*kdf(<'DH', ~passphrase.196>)))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.386^inv(x.387)
         z.1   = x.383^(x.384*kdf(<'DH', ~passphrase.196>))
         z.2   = decap(c_pq.198, kdf(<'KEM', ~passphrase.196>))
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, 
                         x.386^inv((x.387*kdf(<'DH', ~passphrase.196>)))>,
                        nr_pk.201)
    
     96. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^x.384
         c_pq  = c_pq.198
         j_dh_pk
               = x.386^(x.387*inv(kdf(<'DH', ~passphrase.196>)))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.386^x.387
         z.1   = x.383^(x.384*kdf(<'DH', ~passphrase.196>))
         z.2   = decap(c_pq.198, kdf(<'KEM', ~passphrase.196>))
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, 
                         x.386^(x.387*inv(kdf(<'DH', ~passphrase.196>)))>,
                        nr_pk.201)
    
     97. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^x.384
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.200
         nr_pk = pk(x.387)
         sig_j_pk
               = sign(<'signature', j_sig_pk.200, DH_neutral>, x.387)
         z     = DH_neutral
         z.1   = x.383^(x.384*kdf(<'DH', ~passphrase.196>))
         z.2   = z.209
         z.3   = true
    
     98. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^x.384
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = x.386^x.387
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.386^(x.387*kdf(<'DH', ~passphrase.196>))
         z.1   = x.383^(x.384*kdf(<'DH', ~passphrase.196>))
         z.2   = z.209
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, x.386^x.387>, nr_pk.201)
    
     99. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^x.384
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = x.386^inv((x.387*kdf(<'DH', ~passphrase.196>)))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.386^inv(x.387)
         z.1   = x.383^(x.384*kdf(<'DH', ~passphrase.196>))
         z.2   = z.209
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, 
                         x.386^inv((x.387*kdf(<'DH', ~passphrase.196>)))>,
                        nr_pk.201)
    
    100. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^x.384
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = x.386^(x.387*inv(kdf(<'DH', ~passphrase.196>)))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.386^x.387
         z.1   = x.383^(x.384*kdf(<'DH', ~passphrase.196>))
         z.2   = z.209
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, 
                         x.386^(x.387*inv(kdf(<'DH', ~passphrase.196>)))>,
                        nr_pk.201)
    
    101. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^inv((x.384*kdf(<'DH', ~passphrase.196>)))
         c_pq  = c_pq.198
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.200
         nr_pk = pk(x.387)
         sig_j_pk
               = sign(<'signature', j_sig_pk.200, DH_neutral>, x.387)
         z     = DH_neutral
         z.1   = x.383^inv(x.384)
         z.2   = decap(c_pq.198, kdf(<'KEM', ~passphrase.196>))
         z.3   = true
    
    102. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^inv((x.384*kdf(<'DH', ~passphrase.196>)))
         c_pq  = c_pq.198
         j_dh_pk
               = x.386^x.387
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.386^(x.387*kdf(<'DH', ~passphrase.196>))
         z.1   = x.383^inv(x.384)
         z.2   = decap(c_pq.198, kdf(<'KEM', ~passphrase.196>))
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, x.386^x.387>, nr_pk.201)
    
    103. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^inv((x.384*kdf(<'DH', ~passphrase.196>)))
         c_pq  = c_pq.198
         j_dh_pk
               = x.386^inv((x.387*kdf(<'DH', ~passphrase.196>)))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.386^inv(x.387)
         z.1   = x.383^inv(x.384)
         z.2   = decap(c_pq.198, kdf(<'KEM', ~passphrase.196>))
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, 
                         x.386^inv((x.387*kdf(<'DH', ~passphrase.196>)))>,
                        nr_pk.201)
    
    104. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^inv((x.384*kdf(<'DH', ~passphrase.196>)))
         c_pq  = c_pq.198
         j_dh_pk
               = x.386^(x.387*inv(kdf(<'DH', ~passphrase.196>)))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.386^x.387
         z.1   = x.383^inv(x.384)
         z.2   = decap(c_pq.198, kdf(<'KEM', ~passphrase.196>))
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, 
                         x.386^(x.387*inv(kdf(<'DH', ~passphrase.196>)))>,
                        nr_pk.201)
    
    105. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^inv((x.384*kdf(<'DH', ~passphrase.196>)))
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.200
         nr_pk = pk(x.387)
         sig_j_pk
               = sign(<'signature', j_sig_pk.200, DH_neutral>, x.387)
         z     = DH_neutral
         z.1   = x.383^inv(x.384)
         z.2   = z.209
         z.3   = true
    
    106. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^inv((x.384*kdf(<'DH', ~passphrase.196>)))
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = x.386^x.387
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.386^(x.387*kdf(<'DH', ~passphrase.196>))
         z.1   = x.383^inv(x.384)
         z.2   = z.209
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, x.386^x.387>, nr_pk.201)
    
    107. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^inv((x.384*kdf(<'DH', ~passphrase.196>)))
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = x.386^inv((x.387*kdf(<'DH', ~passphrase.196>)))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.386^inv(x.387)
         z.1   = x.383^inv(x.384)
         z.2   = z.209
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, 
                         x.386^inv((x.387*kdf(<'DH', ~passphrase.196>)))>,
                        nr_pk.201)
    
    108. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^inv((x.384*kdf(<'DH', ~passphrase.196>)))
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = x.386^(x.387*inv(kdf(<'DH', ~passphrase.196>)))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.386^x.387
         z.1   = x.383^inv(x.384)
         z.2   = z.209
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, 
                         x.386^(x.387*inv(kdf(<'DH', ~passphrase.196>)))>,
                        nr_pk.201)
    
    109. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^(x.384*inv(kdf(<'DH', ~passphrase.196>)))
         c_pq  = c_pq.198
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.200
         nr_pk = pk(x.387)
         sig_j_pk
               = sign(<'signature', j_sig_pk.200, DH_neutral>, x.387)
         z     = DH_neutral
         z.1   = x.383^x.384
         z.2   = decap(c_pq.198, kdf(<'KEM', ~passphrase.196>))
         z.3   = true
    
    110. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^(x.384*inv(kdf(<'DH', ~passphrase.196>)))
         c_pq  = c_pq.198
         j_dh_pk
               = x.386^x.387
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.386^(x.387*kdf(<'DH', ~passphrase.196>))
         z.1   = x.383^x.384
         z.2   = decap(c_pq.198, kdf(<'KEM', ~passphrase.196>))
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, x.386^x.387>, nr_pk.201)
    
    111. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^(x.384*inv(kdf(<'DH', ~passphrase.196>)))
         c_pq  = c_pq.198
         j_dh_pk
               = x.386^inv((x.387*kdf(<'DH', ~passphrase.196>)))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.386^inv(x.387)
         z.1   = x.383^x.384
         z.2   = decap(c_pq.198, kdf(<'KEM', ~passphrase.196>))
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, 
                         x.386^inv((x.387*kdf(<'DH', ~passphrase.196>)))>,
                        nr_pk.201)
    
    112. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^(x.384*inv(kdf(<'DH', ~passphrase.196>)))
         c_pq  = c_pq.198
         j_dh_pk
               = x.386^(x.387*inv(kdf(<'DH', ~passphrase.196>)))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.386^x.387
         z.1   = x.383^x.384
         z.2   = decap(c_pq.198, kdf(<'KEM', ~passphrase.196>))
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, 
                         x.386^(x.387*inv(kdf(<'DH', ~passphrase.196>)))>,
                        nr_pk.201)
    
    113. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^(x.384*inv(kdf(<'DH', ~passphrase.196>)))
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.200
         nr_pk = pk(x.387)
         sig_j_pk
               = sign(<'signature', j_sig_pk.200, DH_neutral>, x.387)
         z     = DH_neutral
         z.1   = x.383^x.384
         z.2   = z.209
         z.3   = true
    
    114. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^(x.384*inv(kdf(<'DH', ~passphrase.196>)))
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = x.386^x.387
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.386^(x.387*kdf(<'DH', ~passphrase.196>))
         z.1   = x.383^x.384
         z.2   = z.209
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, x.386^x.387>, nr_pk.201)
    
    115. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^(x.384*inv(kdf(<'DH', ~passphrase.196>)))
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = x.386^inv((x.387*kdf(<'DH', ~passphrase.196>)))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.386^inv(x.387)
         z.1   = x.383^x.384
         z.2   = z.209
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, 
                         x.386^inv((x.387*kdf(<'DH', ~passphrase.196>)))>,
                        nr_pk.201)
    
    116. ~passphrase
               = ~passphrase.196
         c_dhkem
               = x.383^(x.384*inv(kdf(<'DH', ~passphrase.196>)))
         c_pq  = encap(z.209, pqpk(kdf(<'KEM', ~passphrase.196>)))
         j_dh_pk
               = x.386^(x.387*inv(kdf(<'DH', ~passphrase.196>)))
         j_sig_pk
               = j_sig_pk.200
         nr_pk = nr_pk.201
         sig_j_pk
               = sig_j_pk.202
         z     = x.386^x.387
         z.1   = x.383^x.384
         z.2   = z.209
         z.3   = verify(sig_j_pk.202,
                        <'signature', j_sig_pk.200, 
                         x.386^(x.387*inv(kdf(<'DH', ~passphrase.196>)))>,
                        nr_pk.201)
    
    117. ~passphrase
               = ~passphrase.197
         c_dhkem
               = c_dhkem.198
         c_pq  = c_pq.199
         j_dh_pk
               = x.386^inv((x.387*kdf(<'DH', ~passphrase.197>)))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, 
                       x.386^inv((x.387*kdf(<'DH', ~passphrase.197>)))>,
                      x.389)
         z     = x.386^inv(x.387)
         z.1   = c_dhkem.198^kdf(<'DH', ~passphrase.197>)
         z.2   = decap(c_pq.199, kdf(<'KEM', ~passphrase.197>))
         z.3   = true
    
    118. ~passphrase
               = ~passphrase.197
         c_dhkem
               = c_dhkem.198
         c_pq  = c_pq.199
         j_dh_pk
               = x.386^(x.387*inv(kdf(<'DH', ~passphrase.197>)))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, 
                       x.386^(x.387*inv(kdf(<'DH', ~passphrase.197>)))>,
                      x.389)
         z     = x.386^x.387
         z.1   = c_dhkem.198^kdf(<'DH', ~passphrase.197>)
         z.2   = decap(c_pq.199, kdf(<'KEM', ~passphrase.197>))
         z.3   = true
    
    119. ~passphrase
               = ~passphrase.197
         c_dhkem
               = c_dhkem.198
         c_pq  = encap(z.210, pqpk(kdf(<'KEM', ~passphrase.197>)))
         j_dh_pk
               = x.386^x.387
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, x.386^x.387>, x.389)
         z     = x.386^(x.387*kdf(<'DH', ~passphrase.197>))
         z.1   = c_dhkem.198^kdf(<'DH', ~passphrase.197>)
         z.2   = z.210
         z.3   = true
    
    120. ~passphrase
               = ~passphrase.197
         c_dhkem
               = c_dhkem.198
         c_pq  = encap(z.210, pqpk(kdf(<'KEM', ~passphrase.197>)))
         j_dh_pk
               = x.386^inv((x.387*kdf(<'DH', ~passphrase.197>)))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, 
                       x.386^inv((x.387*kdf(<'DH', ~passphrase.197>)))>,
                      x.389)
         z     = x.386^inv(x.387)
         z.1   = c_dhkem.198^kdf(<'DH', ~passphrase.197>)
         z.2   = z.210
         z.3   = true
    
    121. ~passphrase
               = ~passphrase.197
         c_dhkem
               = c_dhkem.198
         c_pq  = encap(z.210, pqpk(kdf(<'KEM', ~passphrase.197>)))
         j_dh_pk
               = x.386^(x.387*inv(kdf(<'DH', ~passphrase.197>)))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, 
                       x.386^(x.387*inv(kdf(<'DH', ~passphrase.197>)))>,
                      x.389)
         z     = x.386^x.387
         z.1   = c_dhkem.198^kdf(<'DH', ~passphrase.197>)
         z.2   = z.210
         z.3   = true
    
    122. ~passphrase
               = ~passphrase.197
         c_dhkem
               = DH_neutral
         c_pq  = c_pq.199
         j_dh_pk
               = x.385^(x.386*inv((x.387*kdf(<'DH', ~passphrase.197>))))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, 
                       x.385^(x.386*inv((x.387*kdf(<'DH', ~passphrase.197>))))>,
                      x.389)
         z     = x.385^(x.386*inv(x.387))
         z.1   = DH_neutral
         z.2   = decap(c_pq.199, kdf(<'KEM', ~passphrase.197>))
         z.3   = true
    
    123. ~passphrase
               = ~passphrase.197
         c_dhkem
               = DH_neutral
         c_pq  = encap(z.210, pqpk(kdf(<'KEM', ~passphrase.197>)))
         j_dh_pk
               = x.385^(x.386*inv((x.387*kdf(<'DH', ~passphrase.197>))))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, 
                       x.385^(x.386*inv((x.387*kdf(<'DH', ~passphrase.197>))))>,
                      x.389)
         z     = x.385^(x.386*inv(x.387))
         z.1   = DH_neutral
         z.2   = z.210
         z.3   = true
    
    124. ~passphrase
               = ~passphrase.197
         c_dhkem
               = z.209^inv(kdf(<'DH', ~passphrase.197>))
         c_pq  = c_pq.199
         j_dh_pk
               = x.386^x.387
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, x.386^x.387>, x.389)
         z     = x.386^(x.387*kdf(<'DH', ~passphrase.197>))
         z.1   = z.209
         z.2   = decap(c_pq.199, kdf(<'KEM', ~passphrase.197>))
         z.3   = true
    
    125. ~passphrase
               = ~passphrase.197
         c_dhkem
               = z.209^inv(kdf(<'DH', ~passphrase.197>))
         c_pq  = c_pq.199
         j_dh_pk
               = x.386^inv((x.387*kdf(<'DH', ~passphrase.197>)))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, 
                       x.386^inv((x.387*kdf(<'DH', ~passphrase.197>)))>,
                      x.389)
         z     = x.386^inv(x.387)
         z.1   = z.209
         z.2   = decap(c_pq.199, kdf(<'KEM', ~passphrase.197>))
         z.3   = true
    
    126. ~passphrase
               = ~passphrase.197
         c_dhkem
               = z.209^inv(kdf(<'DH', ~passphrase.197>))
         c_pq  = c_pq.199
         j_dh_pk
               = x.386^(x.387*inv(kdf(<'DH', ~passphrase.197>)))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, 
                       x.386^(x.387*inv(kdf(<'DH', ~passphrase.197>)))>,
                      x.389)
         z     = x.386^x.387
         z.1   = z.209
         z.2   = decap(c_pq.199, kdf(<'KEM', ~passphrase.197>))
         z.3   = true
    
    127. ~passphrase
               = ~passphrase.197
         c_dhkem
               = z.209^inv(kdf(<'DH', ~passphrase.197>))
         c_pq  = encap(z.210, pqpk(kdf(<'KEM', ~passphrase.197>)))
         j_dh_pk
               = x.386^x.387
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, x.386^x.387>, x.389)
         z     = x.386^(x.387*kdf(<'DH', ~passphrase.197>))
         z.1   = z.209
         z.2   = z.210
         z.3   = true
    
    128. ~passphrase
               = ~passphrase.197
         c_dhkem
               = z.209^inv(kdf(<'DH', ~passphrase.197>))
         c_pq  = encap(z.210, pqpk(kdf(<'KEM', ~passphrase.197>)))
         j_dh_pk
               = x.386^inv((x.387*kdf(<'DH', ~passphrase.197>)))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, 
                       x.386^inv((x.387*kdf(<'DH', ~passphrase.197>)))>,
                      x.389)
         z     = x.386^inv(x.387)
         z.1   = z.209
         z.2   = z.210
         z.3   = true
    
    129. ~passphrase
               = ~passphrase.197
         c_dhkem
               = z.209^inv(kdf(<'DH', ~passphrase.197>))
         c_pq  = encap(z.210, pqpk(kdf(<'KEM', ~passphrase.197>)))
         j_dh_pk
               = x.386^(x.387*inv(kdf(<'DH', ~passphrase.197>)))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, 
                       x.386^(x.387*inv(kdf(<'DH', ~passphrase.197>)))>,
                      x.389)
         z     = x.386^x.387
         z.1   = z.209
         z.2   = z.210
         z.3   = true
    
    130. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.383^x.384
         c_pq  = c_pq.199
         j_dh_pk
               = x.386^x.387
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, x.386^x.387>, x.389)
         z     = x.386^(x.387*kdf(<'DH', ~passphrase.197>))
         z.1   = x.383^(x.384*kdf(<'DH', ~passphrase.197>))
         z.2   = decap(c_pq.199, kdf(<'KEM', ~passphrase.197>))
         z.3   = true
    
    131. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^x.385
         c_pq  = c_pq.199
         j_dh_pk
               = z.208^inv(kdf(<'DH', ~passphrase.197>))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, 
                       z.208^inv(kdf(<'DH', ~passphrase.197>))>,
                      x.389)
         z     = z.208
         z.1   = x.384^(x.385*kdf(<'DH', ~passphrase.197>))
         z.2   = decap(c_pq.199, kdf(<'KEM', ~passphrase.197>))
         z.3   = true
    
    132. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^x.385
         c_pq  = c_pq.199
         j_dh_pk
               = x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.197>))))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = nr_pk.202
         sig_j_pk
               = sig_j_pk.203
         z     = x.387^(x.388*inv(x.389))
         z.1   = x.384^(x.385*kdf(<'DH', ~passphrase.197>))
         z.2   = decap(c_pq.199, kdf(<'KEM', ~passphrase.197>))
         z.3   = verify(sig_j_pk.203,
                        <'signature', j_sig_pk.201, 
                         x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.197>))))>,
                        nr_pk.202)
    
    133. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^x.385
         c_pq  = encap(z.210, pqpk(kdf(<'KEM', ~passphrase.197>)))
         j_dh_pk
               = j_dh_pk.200
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, j_dh_pk.200>, x.389)
         z     = j_dh_pk.200^kdf(<'DH', ~passphrase.197>)
         z.1   = x.384^(x.385*kdf(<'DH', ~passphrase.197>))
         z.2   = z.210
         z.3   = true
    
    134. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^x.385
         c_pq  = encap(z.210, pqpk(kdf(<'KEM', ~passphrase.197>)))
         j_dh_pk
               = z.208^inv(kdf(<'DH', ~passphrase.197>))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, 
                       z.208^inv(kdf(<'DH', ~passphrase.197>))>,
                      x.389)
         z     = z.208
         z.1   = x.384^(x.385*kdf(<'DH', ~passphrase.197>))
         z.2   = z.210
         z.3   = true
    
    135. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^x.385
         c_pq  = encap(z.210, pqpk(kdf(<'KEM', ~passphrase.197>)))
         j_dh_pk
               = x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.197>))))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = nr_pk.202
         sig_j_pk
               = sig_j_pk.203
         z     = x.387^(x.388*inv(x.389))
         z.1   = x.384^(x.385*kdf(<'DH', ~passphrase.197>))
         z.2   = z.210
         z.3   = verify(sig_j_pk.203,
                        <'signature', j_sig_pk.201, 
                         x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.197>))))>,
                        nr_pk.202)
    
    136. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^inv((x.385*kdf(<'DH', ~passphrase.197>)))
         c_pq  = c_pq.199
         j_dh_pk
               = j_dh_pk.200
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, j_dh_pk.200>, x.389)
         z     = j_dh_pk.200^kdf(<'DH', ~passphrase.197>)
         z.1   = x.384^inv(x.385)
         z.2   = decap(c_pq.199, kdf(<'KEM', ~passphrase.197>))
         z.3   = true
    
    137. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^inv((x.385*kdf(<'DH', ~passphrase.197>)))
         c_pq  = c_pq.199
         j_dh_pk
               = z.208^inv(kdf(<'DH', ~passphrase.197>))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, 
                       z.208^inv(kdf(<'DH', ~passphrase.197>))>,
                      x.389)
         z     = z.208
         z.1   = x.384^inv(x.385)
         z.2   = decap(c_pq.199, kdf(<'KEM', ~passphrase.197>))
         z.3   = true
    
    138. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^inv((x.385*kdf(<'DH', ~passphrase.197>)))
         c_pq  = c_pq.199
         j_dh_pk
               = x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.197>))))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = nr_pk.202
         sig_j_pk
               = sig_j_pk.203
         z     = x.387^(x.388*inv(x.389))
         z.1   = x.384^inv(x.385)
         z.2   = decap(c_pq.199, kdf(<'KEM', ~passphrase.197>))
         z.3   = verify(sig_j_pk.203,
                        <'signature', j_sig_pk.201, 
                         x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.197>))))>,
                        nr_pk.202)
    
    139. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^inv((x.385*kdf(<'DH', ~passphrase.197>)))
         c_pq  = encap(z.210, pqpk(kdf(<'KEM', ~passphrase.197>)))
         j_dh_pk
               = j_dh_pk.200
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, j_dh_pk.200>, x.389)
         z     = j_dh_pk.200^kdf(<'DH', ~passphrase.197>)
         z.1   = x.384^inv(x.385)
         z.2   = z.210
         z.3   = true
    
    140. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^inv((x.385*kdf(<'DH', ~passphrase.197>)))
         c_pq  = encap(z.210, pqpk(kdf(<'KEM', ~passphrase.197>)))
         j_dh_pk
               = z.208^inv(kdf(<'DH', ~passphrase.197>))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, 
                       z.208^inv(kdf(<'DH', ~passphrase.197>))>,
                      x.389)
         z     = z.208
         z.1   = x.384^inv(x.385)
         z.2   = z.210
         z.3   = true
    
    141. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^inv((x.385*kdf(<'DH', ~passphrase.197>)))
         c_pq  = encap(z.210, pqpk(kdf(<'KEM', ~passphrase.197>)))
         j_dh_pk
               = x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.197>))))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = nr_pk.202
         sig_j_pk
               = sig_j_pk.203
         z     = x.387^(x.388*inv(x.389))
         z.1   = x.384^inv(x.385)
         z.2   = z.210
         z.3   = verify(sig_j_pk.203,
                        <'signature', j_sig_pk.201, 
                         x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.197>))))>,
                        nr_pk.202)
    
    142. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^(x.385*inv(kdf(<'DH', ~passphrase.197>)))
         c_pq  = c_pq.199
         j_dh_pk
               = j_dh_pk.200
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, j_dh_pk.200>, x.389)
         z     = j_dh_pk.200^kdf(<'DH', ~passphrase.197>)
         z.1   = x.384^x.385
         z.2   = decap(c_pq.199, kdf(<'KEM', ~passphrase.197>))
         z.3   = true
    
    143. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^(x.385*inv(kdf(<'DH', ~passphrase.197>)))
         c_pq  = c_pq.199
         j_dh_pk
               = z.208^inv(kdf(<'DH', ~passphrase.197>))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, 
                       z.208^inv(kdf(<'DH', ~passphrase.197>))>,
                      x.389)
         z     = z.208
         z.1   = x.384^x.385
         z.2   = decap(c_pq.199, kdf(<'KEM', ~passphrase.197>))
         z.3   = true
    
    144. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^(x.385*inv(kdf(<'DH', ~passphrase.197>)))
         c_pq  = c_pq.199
         j_dh_pk
               = x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.197>))))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = nr_pk.202
         sig_j_pk
               = sig_j_pk.203
         z     = x.387^(x.388*inv(x.389))
         z.1   = x.384^x.385
         z.2   = decap(c_pq.199, kdf(<'KEM', ~passphrase.197>))
         z.3   = verify(sig_j_pk.203,
                        <'signature', j_sig_pk.201, 
                         x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.197>))))>,
                        nr_pk.202)
    
    145. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^(x.385*inv(kdf(<'DH', ~passphrase.197>)))
         c_pq  = encap(z.210, pqpk(kdf(<'KEM', ~passphrase.197>)))
         j_dh_pk
               = j_dh_pk.200
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, j_dh_pk.200>, x.389)
         z     = j_dh_pk.200^kdf(<'DH', ~passphrase.197>)
         z.1   = x.384^x.385
         z.2   = z.210
         z.3   = true
    
    146. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^(x.385*inv(kdf(<'DH', ~passphrase.197>)))
         c_pq  = encap(z.210, pqpk(kdf(<'KEM', ~passphrase.197>)))
         j_dh_pk
               = z.208^inv(kdf(<'DH', ~passphrase.197>))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, 
                       z.208^inv(kdf(<'DH', ~passphrase.197>))>,
                      x.389)
         z     = z.208
         z.1   = x.384^x.385
         z.2   = z.210
         z.3   = true
    
    147. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^(x.385*inv(kdf(<'DH', ~passphrase.197>)))
         c_pq  = encap(z.210, pqpk(kdf(<'KEM', ~passphrase.197>)))
         j_dh_pk
               = x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.197>))))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = nr_pk.202
         sig_j_pk
               = sig_j_pk.203
         z     = x.387^(x.388*inv(x.389))
         z.1   = x.384^x.385
         z.2   = z.210
         z.3   = verify(sig_j_pk.203,
                        <'signature', j_sig_pk.201, 
                         x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.197>))))>,
                        nr_pk.202)
    
    148. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^(x.385*inv((x.386*kdf(<'DH', ~passphrase.197>))))
         c_pq  = c_pq.199
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, DH_neutral>, x.389)
         z     = DH_neutral
         z.1   = x.384^(x.385*inv(x.386))
         z.2   = decap(c_pq.199, kdf(<'KEM', ~passphrase.197>))
         z.3   = true
    
    149. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^(x.385*inv((x.386*kdf(<'DH', ~passphrase.197>))))
         c_pq  = c_pq.199
         j_dh_pk
               = x.388^x.389
         j_sig_pk
               = j_sig_pk.201
         nr_pk = nr_pk.202
         sig_j_pk
               = sig_j_pk.203
         z     = x.388^(x.389*kdf(<'DH', ~passphrase.197>))
         z.1   = x.384^(x.385*inv(x.386))
         z.2   = decap(c_pq.199, kdf(<'KEM', ~passphrase.197>))
         z.3   = verify(sig_j_pk.203,
                        <'signature', j_sig_pk.201, x.388^x.389>, nr_pk.202)
    
    150. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^(x.385*inv((x.386*kdf(<'DH', ~passphrase.197>))))
         c_pq  = c_pq.199
         j_dh_pk
               = x.388^inv((x.389*kdf(<'DH', ~passphrase.197>)))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = nr_pk.202
         sig_j_pk
               = sig_j_pk.203
         z     = x.388^inv(x.389)
         z.1   = x.384^(x.385*inv(x.386))
         z.2   = decap(c_pq.199, kdf(<'KEM', ~passphrase.197>))
         z.3   = verify(sig_j_pk.203,
                        <'signature', j_sig_pk.201, 
                         x.388^inv((x.389*kdf(<'DH', ~passphrase.197>)))>,
                        nr_pk.202)
    
    151. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^(x.385*inv((x.386*kdf(<'DH', ~passphrase.197>))))
         c_pq  = c_pq.199
         j_dh_pk
               = x.388^(x.389*inv(kdf(<'DH', ~passphrase.197>)))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = nr_pk.202
         sig_j_pk
               = sig_j_pk.203
         z     = x.388^x.389
         z.1   = x.384^(x.385*inv(x.386))
         z.2   = decap(c_pq.199, kdf(<'KEM', ~passphrase.197>))
         z.3   = verify(sig_j_pk.203,
                        <'signature', j_sig_pk.201, 
                         x.388^(x.389*inv(kdf(<'DH', ~passphrase.197>)))>,
                        nr_pk.202)
    
    152. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^(x.385*inv((x.386*kdf(<'DH', ~passphrase.197>))))
         c_pq  = encap(z.210, pqpk(kdf(<'KEM', ~passphrase.197>)))
         j_dh_pk
               = DH_neutral
         j_sig_pk
               = j_sig_pk.201
         nr_pk = pk(x.389)
         sig_j_pk
               = sign(<'signature', j_sig_pk.201, DH_neutral>, x.389)
         z     = DH_neutral
         z.1   = x.384^(x.385*inv(x.386))
         z.2   = z.210
         z.3   = true
    
    153. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^(x.385*inv((x.386*kdf(<'DH', ~passphrase.197>))))
         c_pq  = encap(z.210, pqpk(kdf(<'KEM', ~passphrase.197>)))
         j_dh_pk
               = x.388^x.389
         j_sig_pk
               = j_sig_pk.201
         nr_pk = nr_pk.202
         sig_j_pk
               = sig_j_pk.203
         z     = x.388^(x.389*kdf(<'DH', ~passphrase.197>))
         z.1   = x.384^(x.385*inv(x.386))
         z.2   = z.210
         z.3   = verify(sig_j_pk.203,
                        <'signature', j_sig_pk.201, x.388^x.389>, nr_pk.202)
    
    154. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^(x.385*inv((x.386*kdf(<'DH', ~passphrase.197>))))
         c_pq  = encap(z.210, pqpk(kdf(<'KEM', ~passphrase.197>)))
         j_dh_pk
               = x.388^inv((x.389*kdf(<'DH', ~passphrase.197>)))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = nr_pk.202
         sig_j_pk
               = sig_j_pk.203
         z     = x.388^inv(x.389)
         z.1   = x.384^(x.385*inv(x.386))
         z.2   = z.210
         z.3   = verify(sig_j_pk.203,
                        <'signature', j_sig_pk.201, 
                         x.388^inv((x.389*kdf(<'DH', ~passphrase.197>)))>,
                        nr_pk.202)
    
    155. ~passphrase
               = ~passphrase.197
         c_dhkem
               = x.384^(x.385*inv((x.386*kdf(<'DH', ~passphrase.197>))))
         c_pq  = encap(z.210, pqpk(kdf(<'KEM', ~passphrase.197>)))
         j_dh_pk
               = x.388^(x.389*inv(kdf(<'DH', ~passphrase.197>)))
         j_sig_pk
               = j_sig_pk.201
         nr_pk = nr_pk.202
         sig_j_pk
               = sig_j_pk.203
         z     = x.388^x.389
         z.1   = x.384^(x.385*inv(x.386))
         z.2   = z.210
         z.3   = verify(sig_j_pk.203,
                        <'signature', j_sig_pk.201, 
                         x.388^(x.389*inv(kdf(<'DH', ~passphrase.197>)))>,
                        nr_pk.202)
    
    156. ~passphrase
               = ~passphrase.198
         c_dhkem
               = c_dhkem.199
         c_pq  = c_pq.200
         j_dh_pk
               = x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.198>))))
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, 
                       x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.198>))))>,
                      x.391)
         z     = x.387^(x.388*inv(x.389))
         z.1   = c_dhkem.199^kdf(<'DH', ~passphrase.198>)
         z.2   = decap(c_pq.200, kdf(<'KEM', ~passphrase.198>))
         z.3   = true
    
    157. ~passphrase
               = ~passphrase.198
         c_dhkem
               = c_dhkem.199
         c_pq  = encap(z.211, pqpk(kdf(<'KEM', ~passphrase.198>)))
         j_dh_pk
               = x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.198>))))
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, 
                       x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.198>))))>,
                      x.391)
         z     = x.387^(x.388*inv(x.389))
         z.1   = c_dhkem.199^kdf(<'DH', ~passphrase.198>)
         z.2   = z.211
         z.3   = true
    
    158. ~passphrase
               = ~passphrase.198
         c_dhkem
               = z.210^inv(kdf(<'DH', ~passphrase.198>))
         c_pq  = c_pq.200
         j_dh_pk
               = x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.198>))))
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, 
                       x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.198>))))>,
                      x.391)
         z     = x.387^(x.388*inv(x.389))
         z.1   = z.210
         z.2   = decap(c_pq.200, kdf(<'KEM', ~passphrase.198>))
         z.3   = true
    
    159. ~passphrase
               = ~passphrase.198
         c_dhkem
               = z.210^inv(kdf(<'DH', ~passphrase.198>))
         c_pq  = encap(z.211, pqpk(kdf(<'KEM', ~passphrase.198>)))
         j_dh_pk
               = x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.198>))))
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, 
                       x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.198>))))>,
                      x.391)
         z     = x.387^(x.388*inv(x.389))
         z.1   = z.210
         z.2   = z.211
         z.3   = true
    
    160. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^x.386
         c_pq  = c_pq.200
         j_dh_pk
               = x.388^inv((x.389*kdf(<'DH', ~passphrase.198>)))
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, 
                       x.388^inv((x.389*kdf(<'DH', ~passphrase.198>)))>,
                      x.391)
         z     = x.388^inv(x.389)
         z.1   = x.385^(x.386*kdf(<'DH', ~passphrase.198>))
         z.2   = decap(c_pq.200, kdf(<'KEM', ~passphrase.198>))
         z.3   = true
    
    161. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^x.386
         c_pq  = c_pq.200
         j_dh_pk
               = x.388^(x.389*inv(kdf(<'DH', ~passphrase.198>)))
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, 
                       x.388^(x.389*inv(kdf(<'DH', ~passphrase.198>)))>,
                      x.391)
         z     = x.388^x.389
         z.1   = x.385^(x.386*kdf(<'DH', ~passphrase.198>))
         z.2   = decap(c_pq.200, kdf(<'KEM', ~passphrase.198>))
         z.3   = true
    
    162. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^x.386
         c_pq  = encap(z.211, pqpk(kdf(<'KEM', ~passphrase.198>)))
         j_dh_pk
               = x.388^x.389
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, x.388^x.389>, x.391)
         z     = x.388^(x.389*kdf(<'DH', ~passphrase.198>))
         z.1   = x.385^(x.386*kdf(<'DH', ~passphrase.198>))
         z.2   = z.211
         z.3   = true
    
    163. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^x.386
         c_pq  = encap(z.211, pqpk(kdf(<'KEM', ~passphrase.198>)))
         j_dh_pk
               = x.388^inv((x.389*kdf(<'DH', ~passphrase.198>)))
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, 
                       x.388^inv((x.389*kdf(<'DH', ~passphrase.198>)))>,
                      x.391)
         z     = x.388^inv(x.389)
         z.1   = x.385^(x.386*kdf(<'DH', ~passphrase.198>))
         z.2   = z.211
         z.3   = true
    
    164. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^x.386
         c_pq  = encap(z.211, pqpk(kdf(<'KEM', ~passphrase.198>)))
         j_dh_pk
               = x.388^(x.389*inv(kdf(<'DH', ~passphrase.198>)))
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, 
                       x.388^(x.389*inv(kdf(<'DH', ~passphrase.198>)))>,
                      x.391)
         z     = x.388^x.389
         z.1   = x.385^(x.386*kdf(<'DH', ~passphrase.198>))
         z.2   = z.211
         z.3   = true
    
    165. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^inv((x.386*kdf(<'DH', ~passphrase.198>)))
         c_pq  = c_pq.200
         j_dh_pk
               = x.388^x.389
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, x.388^x.389>, x.391)
         z     = x.388^(x.389*kdf(<'DH', ~passphrase.198>))
         z.1   = x.385^inv(x.386)
         z.2   = decap(c_pq.200, kdf(<'KEM', ~passphrase.198>))
         z.3   = true
    
    166. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^inv((x.386*kdf(<'DH', ~passphrase.198>)))
         c_pq  = c_pq.200
         j_dh_pk
               = x.388^inv((x.389*kdf(<'DH', ~passphrase.198>)))
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, 
                       x.388^inv((x.389*kdf(<'DH', ~passphrase.198>)))>,
                      x.391)
         z     = x.388^inv(x.389)
         z.1   = x.385^inv(x.386)
         z.2   = decap(c_pq.200, kdf(<'KEM', ~passphrase.198>))
         z.3   = true
    
    167. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^inv((x.386*kdf(<'DH', ~passphrase.198>)))
         c_pq  = c_pq.200
         j_dh_pk
               = x.388^(x.389*inv(kdf(<'DH', ~passphrase.198>)))
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, 
                       x.388^(x.389*inv(kdf(<'DH', ~passphrase.198>)))>,
                      x.391)
         z     = x.388^x.389
         z.1   = x.385^inv(x.386)
         z.2   = decap(c_pq.200, kdf(<'KEM', ~passphrase.198>))
         z.3   = true
    
    168. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^inv((x.386*kdf(<'DH', ~passphrase.198>)))
         c_pq  = encap(z.211, pqpk(kdf(<'KEM', ~passphrase.198>)))
         j_dh_pk
               = x.388^x.389
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, x.388^x.389>, x.391)
         z     = x.388^(x.389*kdf(<'DH', ~passphrase.198>))
         z.1   = x.385^inv(x.386)
         z.2   = z.211
         z.3   = true
    
    169. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^inv((x.386*kdf(<'DH', ~passphrase.198>)))
         c_pq  = encap(z.211, pqpk(kdf(<'KEM', ~passphrase.198>)))
         j_dh_pk
               = x.388^inv((x.389*kdf(<'DH', ~passphrase.198>)))
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, 
                       x.388^inv((x.389*kdf(<'DH', ~passphrase.198>)))>,
                      x.391)
         z     = x.388^inv(x.389)
         z.1   = x.385^inv(x.386)
         z.2   = z.211
         z.3   = true
    
    170. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^inv((x.386*kdf(<'DH', ~passphrase.198>)))
         c_pq  = encap(z.211, pqpk(kdf(<'KEM', ~passphrase.198>)))
         j_dh_pk
               = x.388^(x.389*inv(kdf(<'DH', ~passphrase.198>)))
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, 
                       x.388^(x.389*inv(kdf(<'DH', ~passphrase.198>)))>,
                      x.391)
         z     = x.388^x.389
         z.1   = x.385^inv(x.386)
         z.2   = z.211
         z.3   = true
    
    171. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^(x.386*inv(kdf(<'DH', ~passphrase.198>)))
         c_pq  = c_pq.200
         j_dh_pk
               = x.388^x.389
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, x.388^x.389>, x.391)
         z     = x.388^(x.389*kdf(<'DH', ~passphrase.198>))
         z.1   = x.385^x.386
         z.2   = decap(c_pq.200, kdf(<'KEM', ~passphrase.198>))
         z.3   = true
    
    172. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^(x.386*inv(kdf(<'DH', ~passphrase.198>)))
         c_pq  = c_pq.200
         j_dh_pk
               = x.388^inv((x.389*kdf(<'DH', ~passphrase.198>)))
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, 
                       x.388^inv((x.389*kdf(<'DH', ~passphrase.198>)))>,
                      x.391)
         z     = x.388^inv(x.389)
         z.1   = x.385^x.386
         z.2   = decap(c_pq.200, kdf(<'KEM', ~passphrase.198>))
         z.3   = true
    
    173. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^(x.386*inv(kdf(<'DH', ~passphrase.198>)))
         c_pq  = c_pq.200
         j_dh_pk
               = x.388^(x.389*inv(kdf(<'DH', ~passphrase.198>)))
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, 
                       x.388^(x.389*inv(kdf(<'DH', ~passphrase.198>)))>,
                      x.391)
         z     = x.388^x.389
         z.1   = x.385^x.386
         z.2   = decap(c_pq.200, kdf(<'KEM', ~passphrase.198>))
         z.3   = true
    
    174. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^(x.386*inv(kdf(<'DH', ~passphrase.198>)))
         c_pq  = encap(z.211, pqpk(kdf(<'KEM', ~passphrase.198>)))
         j_dh_pk
               = x.388^x.389
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, x.388^x.389>, x.391)
         z     = x.388^(x.389*kdf(<'DH', ~passphrase.198>))
         z.1   = x.385^x.386
         z.2   = z.211
         z.3   = true
    
    175. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^(x.386*inv(kdf(<'DH', ~passphrase.198>)))
         c_pq  = encap(z.211, pqpk(kdf(<'KEM', ~passphrase.198>)))
         j_dh_pk
               = x.388^inv((x.389*kdf(<'DH', ~passphrase.198>)))
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, 
                       x.388^inv((x.389*kdf(<'DH', ~passphrase.198>)))>,
                      x.391)
         z     = x.388^inv(x.389)
         z.1   = x.385^x.386
         z.2   = z.211
         z.3   = true
    
    176. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^(x.386*inv(kdf(<'DH', ~passphrase.198>)))
         c_pq  = encap(z.211, pqpk(kdf(<'KEM', ~passphrase.198>)))
         j_dh_pk
               = x.388^(x.389*inv(kdf(<'DH', ~passphrase.198>)))
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, 
                       x.388^(x.389*inv(kdf(<'DH', ~passphrase.198>)))>,
                      x.391)
         z     = x.388^x.389
         z.1   = x.385^x.386
         z.2   = z.211
         z.3   = true
    
    177. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^(x.386*inv((x.387*kdf(<'DH', ~passphrase.198>))))
         c_pq  = c_pq.200
         j_dh_pk
               = j_dh_pk.201
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, j_dh_pk.201>, x.391)
         z     = j_dh_pk.201^kdf(<'DH', ~passphrase.198>)
         z.1   = x.385^(x.386*inv(x.387))
         z.2   = decap(c_pq.200, kdf(<'KEM', ~passphrase.198>))
         z.3   = true
    
    178. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^(x.386*inv((x.387*kdf(<'DH', ~passphrase.198>))))
         c_pq  = c_pq.200
         j_dh_pk
               = z.209^inv(kdf(<'DH', ~passphrase.198>))
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, 
                       z.209^inv(kdf(<'DH', ~passphrase.198>))>,
                      x.391)
         z     = z.209
         z.1   = x.385^(x.386*inv(x.387))
         z.2   = decap(c_pq.200, kdf(<'KEM', ~passphrase.198>))
         z.3   = true
    
    179. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^(x.386*inv((x.387*kdf(<'DH', ~passphrase.198>))))
         c_pq  = c_pq.200
         j_dh_pk
               = x.389^(x.390*inv((x.391*kdf(<'DH', ~passphrase.198>))))
         j_sig_pk
               = j_sig_pk.202
         nr_pk = nr_pk.203
         sig_j_pk
               = sig_j_pk.204
         z     = x.389^(x.390*inv(x.391))
         z.1   = x.385^(x.386*inv(x.387))
         z.2   = decap(c_pq.200, kdf(<'KEM', ~passphrase.198>))
         z.3   = verify(sig_j_pk.204,
                        <'signature', j_sig_pk.202, 
                         x.389^(x.390*inv((x.391*kdf(<'DH', ~passphrase.198>))))>,
                        nr_pk.203)
    
    180. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^(x.386*inv((x.387*kdf(<'DH', ~passphrase.198>))))
         c_pq  = encap(z.211, pqpk(kdf(<'KEM', ~passphrase.198>)))
         j_dh_pk
               = j_dh_pk.201
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, j_dh_pk.201>, x.391)
         z     = j_dh_pk.201^kdf(<'DH', ~passphrase.198>)
         z.1   = x.385^(x.386*inv(x.387))
         z.2   = z.211
         z.3   = true
    
    181. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^(x.386*inv((x.387*kdf(<'DH', ~passphrase.198>))))
         c_pq  = encap(z.211, pqpk(kdf(<'KEM', ~passphrase.198>)))
         j_dh_pk
               = z.209^inv(kdf(<'DH', ~passphrase.198>))
         j_sig_pk
               = j_sig_pk.202
         nr_pk = pk(x.391)
         sig_j_pk
               = sign(<'signature', j_sig_pk.202, 
                       z.209^inv(kdf(<'DH', ~passphrase.198>))>,
                      x.391)
         z     = z.209
         z.1   = x.385^(x.386*inv(x.387))
         z.2   = z.211
         z.3   = true
    
    182. ~passphrase
               = ~passphrase.198
         c_dhkem
               = x.385^(x.386*inv((x.387*kdf(<'DH', ~passphrase.198>))))
         c_pq  = encap(z.211, pqpk(kdf(<'KEM', ~passphrase.198>)))
         j_dh_pk
               = x.389^(x.390*inv((x.391*kdf(<'DH', ~passphrase.198>))))
         j_sig_pk
               = j_sig_pk.202
         nr_pk = nr_pk.203
         sig_j_pk
               = sig_j_pk.204
         z     = x.389^(x.390*inv(x.391))
         z.1   = x.385^(x.386*inv(x.387))
         z.2   = z.211
         z.3   = verify(sig_j_pk.204,
                        <'signature', j_sig_pk.202, 
                         x.389^(x.390*inv((x.391*kdf(<'DH', ~passphrase.198>))))>,
                        nr_pk.203)
    
    183. ~passphrase
               = ~passphrase.199
         c_dhkem
               = x.386^x.387
         c_pq  = c_pq.201
         j_dh_pk
               = x.389^(x.390*inv((x.391*kdf(<'DH', ~passphrase.199>))))
         j_sig_pk
               = j_sig_pk.203
         nr_pk = pk(x.393)
         sig_j_pk
               = sign(<'signature', j_sig_pk.203, 
                       x.389^(x.390*inv((x.391*kdf(<'DH', ~passphrase.199>))))>,
                      x.393)
         z     = x.389^(x.390*inv(x.391))
         z.1   = x.386^(x.387*kdf(<'DH', ~passphrase.199>))
         z.2   = decap(c_pq.201, kdf(<'KEM', ~passphrase.199>))
         z.3   = true
    
    184. ~passphrase
               = ~passphrase.199
         c_dhkem
               = x.386^x.387
         c_pq  = encap(z.212, pqpk(kdf(<'KEM', ~passphrase.199>)))
         j_dh_pk
               = x.389^(x.390*inv((x.391*kdf(<'DH', ~passphrase.199>))))
         j_sig_pk
               = j_sig_pk.203
         nr_pk = pk(x.393)
         sig_j_pk
               = sign(<'signature', j_sig_pk.203, 
                       x.389^(x.390*inv((x.391*kdf(<'DH', ~passphrase.199>))))>,
                      x.393)
         z     = x.389^(x.390*inv(x.391))
         z.1   = x.386^(x.387*kdf(<'DH', ~passphrase.199>))
         z.2   = z.212
         z.3   = true
    
    185. ~passphrase
               = ~passphrase.199
         c_dhkem
               = x.386^inv((x.387*kdf(<'DH', ~passphrase.199>)))
         c_pq  = c_pq.201
         j_dh_pk
               = x.389^(x.390*inv((x.391*kdf(<'DH', ~passphrase.199>))))
         j_sig_pk
               = j_sig_pk.203
         nr_pk = pk(x.393)
         sig_j_pk
               = sign(<'signature', j_sig_pk.203, 
                       x.389^(x.390*inv((x.391*kdf(<'DH', ~passphrase.199>))))>,
                      x.393)
         z     = x.389^(x.390*inv(x.391))
         z.1   = x.386^inv(x.387)
         z.2   = decap(c_pq.201, kdf(<'KEM', ~passphrase.199>))
         z.3   = true
    
    186. ~passphrase
               = ~passphrase.199
         c_dhkem
               = x.386^inv((x.387*kdf(<'DH', ~passphrase.199>)))
         c_pq  = encap(z.212, pqpk(kdf(<'KEM', ~passphrase.199>)))
         j_dh_pk
               = x.389^(x.390*inv((x.391*kdf(<'DH', ~passphrase.199>))))
         j_sig_pk
               = j_sig_pk.203
         nr_pk = pk(x.393)
         sig_j_pk
               = sign(<'signature', j_sig_pk.203, 
                       x.389^(x.390*inv((x.391*kdf(<'DH', ~passphrase.199>))))>,
                      x.393)
         z     = x.389^(x.390*inv(x.391))
         z.1   = x.386^inv(x.387)
         z.2   = z.212
         z.3   = true
    
    187. ~passphrase
               = ~passphrase.199
         c_dhkem
               = x.386^(x.387*inv(kdf(<'DH', ~passphrase.199>)))
         c_pq  = c_pq.201
         j_dh_pk
               = x.389^(x.390*inv((x.391*kdf(<'DH', ~passphrase.199>))))
         j_sig_pk
               = j_sig_pk.203
         nr_pk = pk(x.393)
         sig_j_pk
               = sign(<'signature', j_sig_pk.203, 
                       x.389^(x.390*inv((x.391*kdf(<'DH', ~passphrase.199>))))>,
                      x.393)
         z     = x.389^(x.390*inv(x.391))
         z.1   = x.386^x.387
         z.2   = decap(c_pq.201, kdf(<'KEM', ~passphrase.199>))
         z.3   = true
    
    188. ~passphrase
               = ~passphrase.199
         c_dhkem
               = x.386^(x.387*inv(kdf(<'DH', ~passphrase.199>)))
         c_pq  = encap(z.212, pqpk(kdf(<'KEM', ~passphrase.199>)))
         j_dh_pk
               = x.389^(x.390*inv((x.391*kdf(<'DH', ~passphrase.199>))))
         j_sig_pk
               = j_sig_pk.203
         nr_pk = pk(x.393)
         sig_j_pk
               = sign(<'signature', j_sig_pk.203, 
                       x.389^(x.390*inv((x.391*kdf(<'DH', ~passphrase.199>))))>,
                      x.393)
         z     = x.389^(x.390*inv(x.391))
         z.1   = x.386^x.387
         z.2   = z.212
         z.3   = true
    
    189. ~passphrase
               = ~passphrase.199
         c_dhkem
               = x.386^(x.387*inv((x.388*kdf(<'DH', ~passphrase.199>))))
         c_pq  = c_pq.201
         j_dh_pk
               = x.390^x.391
         j_sig_pk
               = j_sig_pk.203
         nr_pk = pk(x.393)
         sig_j_pk
               = sign(<'signature', j_sig_pk.203, x.390^x.391>, x.393)
         z     = x.390^(x.391*kdf(<'DH', ~passphrase.199>))
         z.1   = x.386^(x.387*inv(x.388))
         z.2   = decap(c_pq.201, kdf(<'KEM', ~passphrase.199>))
         z.3   = true
    
    190. ~passphrase
               = ~passphrase.199
         c_dhkem
               = x.386^(x.387*inv((x.388*kdf(<'DH', ~passphrase.199>))))
         c_pq  = c_pq.201
         j_dh_pk
               = x.390^inv((x.391*kdf(<'DH', ~passphrase.199>)))
         j_sig_pk
               = j_sig_pk.203
         nr_pk = pk(x.393)
         sig_j_pk
               = sign(<'signature', j_sig_pk.203, 
                       x.390^inv((x.391*kdf(<'DH', ~passphrase.199>)))>,
                      x.393)
         z     = x.390^inv(x.391)
         z.1   = x.386^(x.387*inv(x.388))
         z.2   = decap(c_pq.201, kdf(<'KEM', ~passphrase.199>))
         z.3   = true
    
    191. ~passphrase
               = ~passphrase.199
         c_dhkem
               = x.386^(x.387*inv((x.388*kdf(<'DH', ~passphrase.199>))))
         c_pq  = c_pq.201
         j_dh_pk
               = x.390^(x.391*inv(kdf(<'DH', ~passphrase.199>)))
         j_sig_pk
               = j_sig_pk.203
         nr_pk = pk(x.393)
         sig_j_pk
               = sign(<'signature', j_sig_pk.203, 
                       x.390^(x.391*inv(kdf(<'DH', ~passphrase.199>)))>,
                      x.393)
         z     = x.390^x.391
         z.1   = x.386^(x.387*inv(x.388))
         z.2   = decap(c_pq.201, kdf(<'KEM', ~passphrase.199>))
         z.3   = true
    
    192. ~passphrase
               = ~passphrase.199
         c_dhkem
               = x.386^(x.387*inv((x.388*kdf(<'DH', ~passphrase.199>))))
         c_pq  = encap(z.212, pqpk(kdf(<'KEM', ~passphrase.199>)))
         j_dh_pk
               = x.390^x.391
         j_sig_pk
               = j_sig_pk.203
         nr_pk = pk(x.393)
         sig_j_pk
               = sign(<'signature', j_sig_pk.203, x.390^x.391>, x.393)
         z     = x.390^(x.391*kdf(<'DH', ~passphrase.199>))
         z.1   = x.386^(x.387*inv(x.388))
         z.2   = z.212
         z.3   = true
    
    193. ~passphrase
               = ~passphrase.199
         c_dhkem
               = x.386^(x.387*inv((x.388*kdf(<'DH', ~passphrase.199>))))
         c_pq  = encap(z.212, pqpk(kdf(<'KEM', ~passphrase.199>)))
         j_dh_pk
               = x.390^inv((x.391*kdf(<'DH', ~passphrase.199>)))
         j_sig_pk
               = j_sig_pk.203
         nr_pk = pk(x.393)
         sig_j_pk
               = sign(<'signature', j_sig_pk.203, 
                       x.390^inv((x.391*kdf(<'DH', ~passphrase.199>)))>,
                      x.393)
         z     = x.390^inv(x.391)
         z.1   = x.386^(x.387*inv(x.388))
         z.2   = z.212
         z.3   = true
    
    194. ~passphrase
               = ~passphrase.199
         c_dhkem
               = x.386^(x.387*inv((x.388*kdf(<'DH', ~passphrase.199>))))
         c_pq  = encap(z.212, pqpk(kdf(<'KEM', ~passphrase.199>)))
         j_dh_pk
               = x.390^(x.391*inv(kdf(<'DH', ~passphrase.199>)))
         j_sig_pk
               = j_sig_pk.203
         nr_pk = pk(x.393)
         sig_j_pk
               = sign(<'signature', j_sig_pk.203, 
                       x.390^(x.391*inv(kdf(<'DH', ~passphrase.199>)))>,
                      x.393)
         z     = x.390^x.391
         z.1   = x.386^(x.387*inv(x.388))
         z.2   = z.212
         z.3   = true
    
    195. ~passphrase
               = ~passphrase.200
         c_dhkem
               = x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.200>))))
         c_pq  = c_pq.202
         j_dh_pk
               = x.391^(x.392*inv((x.393*kdf(<'DH', ~passphrase.200>))))
         j_sig_pk
               = j_sig_pk.204
         nr_pk = pk(x.395)
         sig_j_pk
               = sign(<'signature', j_sig_pk.204, 
                       x.391^(x.392*inv((x.393*kdf(<'DH', ~passphrase.200>))))>,
                      x.395)
         z     = x.391^(x.392*inv(x.393))
         z.1   = x.387^(x.388*inv(x.389))
         z.2   = decap(c_pq.202, kdf(<'KEM', ~passphrase.200>))
         z.3   = true
    
    196. ~passphrase
               = ~passphrase.200
         c_dhkem
               = x.387^(x.388*inv((x.389*kdf(<'DH', ~passphrase.200>))))
         c_pq  = encap(z.213, pqpk(kdf(<'KEM', ~passphrase.200>)))
         j_dh_pk
               = x.391^(x.392*inv((x.393*kdf(<'DH', ~passphrase.200>))))
         j_sig_pk
               = j_sig_pk.204
         nr_pk = pk(x.395)
         sig_j_pk
               = sign(<'signature', j_sig_pk.204, 
                       x.391^(x.392*inv((x.393*kdf(<'DH', ~passphrase.200>))))>,
                      x.395)
         z     = x.391^(x.392*inv(x.393))
         z.1   = x.387^(x.388*inv(x.389))
         z.2   = z.213
         z.3   = true
  */

restriction Eq:
  "∀ t1 t2 #x. (Eq( t1, t2 ) @ #x) ⇒ (t1 = t2)"
  // safety formula

restriction DHElement_Check:
  "∀ x #t.
    (DHElement_Check( x ) @ #t) ⇒ (¬((x = 'g') ∨ (x = DH_neutral)))"
  // safety formula

restriction OnlyOnce:
  "∀ x #i #j.
    ((OnlyOnce( x ) @ #i) ∧ (OnlyOnce( x ) @ #j)) ⇒ (#i = #j)"
  // safety formula

lemma Auto_Executability_Submission:
  exists-trace
  "∃ #t1 #t2 s_dh_pk j_sig_pk j_edh_pk j_ekem_pk nr m.
    ((Source_Sent( s_dh_pk, j_sig_pk, j_edh_pk, j_ekem_pk, nr, m
      ) @ #t1) ∧
     (Journalist_Received( j_sig_pk, j_edh_pk, nr, s_dh_pk, m
      ) @ #t2)) ∧
    (¬(∃ #x. SomeCompromise( ) @ #x))"
/*
guarded formula characterizing all satisfying traces:
"∃ #t1 #t2 s_dh_pk j_sig_pk j_edh_pk j_ekem_pk nr m.
  (Source_Sent( s_dh_pk, j_sig_pk, j_edh_pk, j_ekem_pk, nr, m
   ) @ #t1) ∧
  (Journalist_Received( j_sig_pk, j_edh_pk, nr, s_dh_pk, m ) @ #t2)
 ∧
  ∀ #x. (SomeCompromise( ) @ #x) ⇒ ⊥"
*/
simplify
solve( !Ltk_Source_Passphrase( $S, ~passphrase ) ▶₀ #t1 )
  case Register_Source_Passphrase
  solve( !Pk_Newsroom( $NR, pk(x) ) ▶₁ #t1 )
    case Register_Newsroom_Key
    solve( !KU( aenc(<'cipher_s2j', 'g'^kdf(<'DH', ~passphrase>), 
                      'g'^~x, c_pq>,
                     pk(~j_epke_sk))
           ) @ #vk.14 )
      case Source_Send
      solve( !KU( senc(<'msg_s2j', ~msg, 'g'^kdf(<'DH', ~passphrase>), 
                        pk(kdf(<'PKE', ~passphrase>)), pqpk(kdf(<'KEM', ~passphrase>)), 
                        pk(~j_sig_sk), $NR>,
                       H(kdf(<'g'^(~j_edh_sk*kdf(<'DH', ~passphrase>)), 
                              'g'^(~j_edh_sk*~x), 'g'^~x, j_edh_pk, 'g'^kdf(<'DH', ~passphrase>)
                             >),
                         'g'^~x, z, encap(~k_pq.1, j_ekem_pk.1)))
             ) @ #vk.15 )
        case Source_Send
        solve( Journalist_Ephemeral_Key( $J, ~j_edh_sk, ~j_epke_sk,
                                         ~j_ekem_sk
               ) ▶₁ #t2 )
          case Journalist_Register_Ephemeral_Key
          solve( !Ltk_Journalist_SIG_Key( $J, ~j_sig_sk ) ▶₂ #t2 )
            case Journalist_Enrollment
            solve( !Journalist_Enrolled( $NR, $J ) ▶₃ #t2 )
              case Journalist_Enrollment
              solve( !KU( pk(~j_sig_sk) ) @ #vk.5 )
                case Journalist_Enrollment
                solve( !KU( sign(<'signature', pk(~j_sig_sk), j_dh_pk>, ~ltk)
                       ) @ #vk.8 )
                  case Journalist_Enrollment
                  solve( !KU( 'g'^~j_edh_sk ) @ #vk.11 )
                    case Journalist_Register_Ephemeral_Key
                    solve( !KU( sign(<'ephemeral', 'g'^~j_edh_sk, pk(~j_epke_sk), 
                                      pqpk(~j_ekem_sk)>,
                                     ~j_sig_sk)
                           ) @ #vk.15 )
                      case Journalist_Register_Ephemeral_Key
                      solve( !KU( pk(~j_epke_sk) ) @ #vk.14 )
                        case Journalist_Register_Ephemeral_Key
                        solve( !KU( pqpk(~j_ekem_sk) ) @ #vk.15 )
                          case Journalist_Register_Ephemeral_Key
                          solve( !KU( 'g'^~j_dh_sk ) @ #vk.15 )
                            case Journalist_Enrollment
                            SOLVED // trace found
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma Auto_Secrecy_Source_Message:
  all-traces
  "∀ #t s_dh_pk j_sig_pk j_edh_pk j_ekem_pk nr m.
    (Source_Sent( s_dh_pk, j_sig_pk, j_edh_pk, j_ekem_pk, nr, m
     ) @ #t) ⇒
    ((((¬(∃ #x. K( m ) @ #x)) ∨
       (∃ #x. (Reveal_Journalist_SIG_Key( j_sig_pk ) @ #x) ∧ (#x < #t))) ∨
      (∃ #x. (Reveal_Newsroom_Key( nr ) @ #x) ∧ (#x < #t))) ∨
     (((∃ #x. Reveal_Journalist_EDH_Key( j_edh_pk ) @ #x) ∨
       (∃ #x. PQAttack( ) @ #x)) ∧
      (∃ #x. Reveal_Journalist_EKEM_Key( j_ekem_pk ) @ #x)))"
/*
guarded formula characterizing all counter-examples:
"∃ #t s_dh_pk j_sig_pk j_edh_pk j_ekem_pk nr m.
  (Source_Sent( s_dh_pk, j_sig_pk, j_edh_pk, j_ekem_pk, nr, m ) @ #t)
 ∧
  (∃ #x. (K( m ) @ #x)) ∧
  (∀ #x. (Reveal_Journalist_SIG_Key( j_sig_pk ) @ #x) ⇒ ¬(#x < #t)) ∧
  (∀ #x. (Reveal_Newsroom_Key( nr ) @ #x) ⇒ ¬(#x < #t)) ∧
  ((((∀ #x. (Reveal_Journalist_EDH_Key( j_edh_pk ) @ #x) ⇒ ⊥) ∧
     (∀ #x. (PQAttack( ) @ #x) ⇒ ⊥)) ∨
    (∀ #x. (Reveal_Journalist_EKEM_Key( j_ekem_pk ) @ #x) ⇒ ⊥)))"
*/
simplify
solve( !Ltk_Source_Passphrase( $S, ~passphrase ) ▶₀ #t )
  case Register_Source_Passphrase
  solve( !Pk_Newsroom( $NR, pk(x) ) ▶₁ #t )
    case Register_Newsroom_Key
    solve( !KU( ~msg ) @ #vk.19 )
      case Source_Send
      solve( !KU( ~k_pq ) @ #vk.28 )
        case Source_Send
        solve( !KU( kdf(<z, z.1, 'g'^~me_sk, j_edh_pk, 
                         'g'^kdf(<'DH', ~passphrase>)>)
               ) @ #vk.27 )
          case c_kdf
          solve( !KU( sign(<'ephemeral', j_edh_pk, pk(x.1), pqpk(sk)>, x)
                 ) @ #vk.24 )
            case Journalist_Register_Ephemeral_Key
            solve( !KU( ~j_ekem_sk ) @ #vk.34 )
              case Reveal_Journalist_EKEM_Key
              solve( ((∀ #x.
                        (Reveal_Journalist_EDH_Key( 'g'^~j_edh_sk ) @ #x) ⇒ ⊥) ∧
                      (∀ #x. (PQAttack( ) @ #x) ⇒ ⊥))  ∥
                     (∀ #x. (Reveal_Journalist_EKEM_Key( pqpk(~j_ekem_sk) ) @ #x) ⇒ ⊥) )
                case case_1
                solve( !KU( 'g'^(~j_edh_sk*~me_sk) ) @ #vk.37 )
                  case Journalist_Register_Ephemeral_Key
                  solve( !KU( ~me_sk ) @ #vk.38 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_01
                  solve( !KU( aenc(<'cipher_s2j', 'g'^(~j_edh_sk*~me_sk), 'g'^~x.1, 
                                    c_pq>,
                                   pk(~j_epke_sk.1))
                         ) @ #vk.40 )
                    case c_aenc
                    by contradiction /* cyclic */
                  qed
                next
                  case Journalist_Send_case_02
                  solve( !KU( ~me_sk ) @ #vk.42 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_03
                  solve( !KU( ~j_edh_sk ) @ #vk.42 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  next
                    case Reveal_Journalist_EDH_Key
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_04
                  solve( !KU( aenc(<'cipher_s2j', 'g'^(~j_edh_sk*~me_sk*x.1), 
                                    'g'^~x.2, c_pq>,
                                   pk(~j_epke_sk.1))
                         ) @ #vk.40 )
                    case c_aenc
                    by contradiction /* cyclic */
                  qed
                next
                  case Journalist_Send_case_05
                  solve( !KU( aenc(<'cipher_s2j', 'g'^(~j_edh_sk*~me_sk*inv(x.1)), 
                                    'g'^~x.2, c_pq>,
                                   pk(~j_epke_sk.1))
                         ) @ #vk.40 )
                    case c_aenc
                    by contradiction /* cyclic */
                  qed
                next
                  case Journalist_Send_case_06
                  solve( !KU( ~j_edh_sk ) @ #vk.43 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  next
                    case Reveal_Journalist_EDH_Key
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_07
                  solve( !KU( ~me_sk ) @ #vk.43 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_08
                  solve( !KU( ~j_edh_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  next
                    case Reveal_Journalist_EDH_Key
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_09
                  solve( !KU( ~me_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_10
                  solve( !KU( aenc(<'cipher_s2j', 
                                    'g'^(~j_edh_sk*~me_sk*x.1*inv(x.2)), 'g'^~x.3, c_pq>,
                                   pk(~j_epke_sk.1))
                         ) @ #vk.40 )
                    case c_aenc
                    by contradiction /* cyclic */
                  qed
                next
                  case Journalist_Send_case_11
                  solve( !KU( ~j_edh_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  next
                    case Reveal_Journalist_EDH_Key
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_12
                  solve( !KU( ~me_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_13
                  solve( !KU( aenc(<'cipher_s2j', 
                                    'g'^(~j_edh_sk*~me_sk*inv(~me_sk.1)), 'g'^~x.1, c_pq>,
                                   pk(~j_epke_sk.1))
                         ) @ #vk.40 )
                    case c_aenc
                    by contradiction /* cyclic */
                  qed
                next
                  case Journalist_Send_case_14
                  solve( !KU( ~j_edh_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  next
                    case Reveal_Journalist_EDH_Key
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_15
                  solve( !KU( ~me_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_16
                  solve( !KU( aenc(<'cipher_s2j', 
                                    'g'^(~j_edh_sk*~me_sk*x.1*inv(~me_sk.1)), 'g'^~x.2, c_pq>,
                                   pk(~j_epke_sk.1))
                         ) @ #vk.40 )
                    case c_aenc
                    by contradiction /* cyclic */
                  qed
                next
                  case Journalist_Send_case_17
                  solve( !KU( ~j_edh_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  next
                    case Reveal_Journalist_EDH_Key
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_18
                  solve( !KU( ~me_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_19
                  solve( !KU( aenc(<'cipher_s2j', 
                                    'g'^(~j_edh_sk*~me_sk*inv((~me_sk.1*x.1))), 'g'^~x.2, c_pq>,
                                   pk(~j_epke_sk.1))
                         ) @ #vk.40 )
                    case c_aenc
                    by contradiction /* cyclic */
                  qed
                next
                  case Journalist_Send_case_20
                  solve( !KU( ~j_edh_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  next
                    case Reveal_Journalist_EDH_Key
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_21
                  solve( !KU( ~me_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_22
                  solve( !KU( aenc(<'cipher_s2j', 
                                    'g'^(~j_edh_sk*~me_sk*x.1*inv((~me_sk.1*x.2))), 'g'^~x.3, c_pq>,
                                   pk(~j_epke_sk.1))
                         ) @ #vk.40 )
                    case c_aenc
                    by contradiction /* cyclic */
                  qed
                next
                  case Journalist_Send_case_23
                  solve( !KU( ~j_edh_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  next
                    case Reveal_Journalist_EDH_Key
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_24
                  solve( !KU( ~me_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_25
                  solve( !KU( aenc(<'cipher_s2j', 
                                    'g'^(~j_edh_sk*~me_sk*inv(~j_dh_sk.1)), 'g'^~x.1, c_pq>,
                                   pk(~j_epke_sk.1))
                         ) @ #vk.40 )
                    case c_aenc
                    by contradiction /* cyclic */
                  qed
                next
                  case Journalist_Send_case_26
                  solve( !KU( ~j_edh_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  next
                    case Reveal_Journalist_EDH_Key
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_27
                  solve( !KU( ~me_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_28
                  solve( !KU( aenc(<'cipher_s2j', 
                                    'g'^(~j_edh_sk*~me_sk*x.1*inv(~j_dh_sk.1)), 'g'^~x.2, c_pq>,
                                   pk(~j_epke_sk.1))
                         ) @ #vk.40 )
                    case c_aenc
                    by contradiction /* cyclic */
                  qed
                next
                  case Journalist_Send_case_29
                  solve( !KU( ~j_edh_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  next
                    case Reveal_Journalist_EDH_Key
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_30
                  solve( !KU( ~me_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_31
                  solve( !KU( aenc(<'cipher_s2j', 
                                    'g'^(~j_edh_sk*~me_sk*inv((~j_dh_sk.1*~me_sk.1))), 'g'^~x.1, 
                                    c_pq>,
                                   pk(~j_epke_sk.1))
                         ) @ #vk.40 )
                    case c_aenc
                    by contradiction /* cyclic */
                  qed
                next
                  case Journalist_Send_case_32
                  solve( !KU( ~j_edh_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  next
                    case Reveal_Journalist_EDH_Key
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_33
                  solve( !KU( ~me_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_34
                  solve( !KU( aenc(<'cipher_s2j', 
                                    'g'^(~j_edh_sk*~me_sk*x.1*inv((~j_dh_sk.1*~me_sk.1))), 
                                    'g'^~x.2, c_pq>,
                                   pk(~j_epke_sk.1))
                         ) @ #vk.40 )
                    case c_aenc
                    by contradiction /* cyclic */
                  qed
                next
                  case Journalist_Send_case_35
                  solve( !KU( ~j_edh_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  next
                    case Reveal_Journalist_EDH_Key
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_36
                  solve( !KU( ~me_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_37
                  solve( !KU( aenc(<'cipher_s2j', 
                                    'g'^(~j_edh_sk*~me_sk*inv((~j_dh_sk.1*~me_sk.1*x.1))), 
                                    'g'^~x.2, c_pq>,
                                   pk(~j_epke_sk.1))
                         ) @ #vk.40 )
                    case c_aenc
                    by contradiction /* cyclic */
                  qed
                next
                  case Journalist_Send_case_38
                  solve( !KU( ~j_edh_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  next
                    case Reveal_Journalist_EDH_Key
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_39
                  solve( !KU( ~me_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_40
                  solve( !KU( aenc(<'cipher_s2j', 
                                    'g'^(~j_edh_sk*~me_sk*x.1*inv((~j_dh_sk.1*~me_sk.1*x.2))), 
                                    'g'^~x.3, c_pq>,
                                   pk(~j_epke_sk.1))
                         ) @ #vk.40 )
                    case c_aenc
                    by contradiction /* cyclic */
                  qed
                next
                  case Journalist_Send_case_41
                  solve( !KU( ~j_edh_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  next
                    case Reveal_Journalist_EDH_Key
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_42
                  solve( !KU( ~me_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_43
                  solve( !KU( aenc(<'cipher_s2j', 
                                    'g'^(~j_edh_sk*~me_sk*inv((~j_dh_sk.1*x.1))), 'g'^~x.2, c_pq>,
                                   pk(~j_epke_sk.1))
                         ) @ #vk.40 )
                    case c_aenc
                    by contradiction /* cyclic */
                  qed
                next
                  case Journalist_Send_case_44
                  solve( !KU( ~j_edh_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  next
                    case Reveal_Journalist_EDH_Key
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_45
                  solve( !KU( ~me_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_46
                  solve( !KU( aenc(<'cipher_s2j', 
                                    'g'^(~j_edh_sk*~me_sk*x.1*inv((~j_dh_sk.1*x.2))), 'g'^~x.3, c_pq
                                   >,
                                   pk(~j_epke_sk.1))
                         ) @ #vk.40 )
                    case c_aenc
                    by contradiction /* cyclic */
                  qed
                next
                  case Journalist_Send_case_47
                  solve( !KU( ~j_edh_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  next
                    case Reveal_Journalist_EDH_Key
                    by contradiction /* from formulas */
                  qed
                next
                  case Journalist_Send_case_48
                  solve( !KU( ~me_sk ) @ #vk.44 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  qed
                next
                  case Source_Send
                  solve( !KU( ~j_edh_sk ) @ #vk.38 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  next
                    case Reveal_Journalist_EDH_Key
                    by contradiction /* from formulas */
                  qed
                next
                  case c_exp
                  solve( !KU( ~j_edh_sk ) @ #vk.40 )
                    case PQAttacker
                    by contradiction /* from formulas */
                  next
                    case Reveal_Journalist_EDH_Key
                    by contradiction /* from formulas */
                  qed
                qed
              next
                case case_2
                by contradiction /* from formulas */
              qed
            qed
          next
            case c_sign
            solve( !KU( sign(<'signature', pk(x), j_dh_pk>, ~ltk) ) @ #vk.17 )
              case Journalist_Enrollment
              solve( !KU( ~j_sig_sk ) @ #vk.39 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_SIG_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send
              solve( !KU( ~j_sig_sk ) @ #vk.40 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_SIG_Key
                by contradiction /* from formulas */
              qed
            next
              case c_sign
              solve( !KU( ~ltk ) @ #vk.42 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Newsroom_Key
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma Auto_Injective_Agreement_Source_Message:
  all-traces
  "∀ #t1 #t2 j_sig_pk j_edh_pk nr s_dh_pk m.
    ((Journalist_Received( j_sig_pk, j_edh_pk, nr, s_dh_pk, m
      ) @ #t1) ∧
     (Register_Source( s_dh_pk ) @ #t2)) ⇒
    ((((∃ j_ekem_pk #x1.
         ((Source_Sent( s_dh_pk, j_sig_pk, j_edh_pk, j_ekem_pk, nr, m
           ) @ #x1) ∧
          (#x1 < #t1)) ∧
         (¬(∃ j_sig_pk_2 j_edh_pk_2 nr_2 s_dh_pk_2 #x2.
             (Journalist_Received( j_sig_pk_2, j_edh_pk_2, nr_2, s_dh_pk_2, m
              ) @ #x2) ∧
             (¬(#x2 = #t1))))) ∨
       (∃ #x. Reveal_Source_DH_Key( s_dh_pk ) @ #x)) ∨
      (∃ #x. Reveal_Journalist_SIG_Key( j_sig_pk ) @ #x)) ∨
     (∃ #x. Reveal_Journalist_EDH_Key( j_edh_pk ) @ #x))"
/*
guarded formula characterizing all counter-examples:
"∃ #t1 #t2 j_sig_pk j_edh_pk nr s_dh_pk m.
  (Journalist_Received( j_sig_pk, j_edh_pk, nr, s_dh_pk, m ) @ #t1) ∧
  (Register_Source( s_dh_pk ) @ #t2)
 ∧
  (∀ j_ekem_pk #x1.
    (Source_Sent( s_dh_pk, j_sig_pk, j_edh_pk, j_ekem_pk, nr, m
     ) @ #x1)
   ⇒
    ((¬(#x1 < #t1)) ∨
     (∃ j_sig_pk_2 j_edh_pk_2 nr_2 s_dh_pk_2 #x2.
       (Journalist_Received( j_sig_pk_2, j_edh_pk_2, nr_2, s_dh_pk_2, m
        ) @ #x2)
      ∧
       ¬(#x2 = #t1)))) ∧
  (∀ #x. (Reveal_Source_DH_Key( s_dh_pk ) @ #x) ⇒ ⊥) ∧
  (∀ #x. (Reveal_Journalist_SIG_Key( j_sig_pk ) @ #x) ⇒ ⊥) ∧
  (∀ #x. (Reveal_Journalist_EDH_Key( j_edh_pk ) @ #x) ⇒ ⊥)"
*/
simplify
solve( Journalist_Ephemeral_Key( $J, ~j_edh_sk, ~j_epke_sk,
                                 ~j_ekem_sk
       ) ▶₁ #t1 )
  case Journalist_Register_Ephemeral_Key
  solve( !Ltk_Journalist_SIG_Key( $J, ~j_sig_sk ) ▶₂ #t1 )
    case Journalist_Enrollment
    solve( !Journalist_Enrolled( $NR, $J ) ▶₃ #t1 )
      case Journalist_Enrollment
      solve( !KU( senc(<'msg_s2j', ~msg, 'g'^kdf(<'DH', ~passphrase>), 
                        s_pke_pk, s_kem_pk, pk(~j_sig_sk), $NR>,
                       H(kdf(<'g'^(~j_edh_sk*kdf(<'DH', ~passphrase>)), 
                              'g'^(~j_edh_sk*~x), 'g'^~x, j_edh_pk, 'g'^kdf(<'DH', ~passphrase>)
                             >),
                         'g'^~x, z, c_pq))
             ) @ #vk.2 )
        case Source_Send
        solve( Journalist_Ephemeral_Key( $J.1, ~j_edh_sk.1, ~j_epke_sk.1,
                                         ~j_ekem_sk.1
               ) ▶₁ #x2 )
          case Journalist_Register_Ephemeral_Key
          solve( !Ltk_Journalist_SIG_Key( $J.1, ~j_sig_sk ) ▶₂ #x2 )
            case Journalist_Enrollment
            solve( !Journalist_Enrolled( $NR, $J ) ▶₃ #x2 )
              case Journalist_Enrollment
              solve( !KU( senc(<'msg_s2j', ~msg, 'g'^kdf(<'DH', ~passphrase>), 
                                pk(kdf(<'PKE', ~passphrase>)), pqpk(kdf(<'KEM', ~passphrase>)), 
                                pk(~j_sig_sk), $NR>,
                               H(kdf(<'g'^(~j_edh_sk.1*kdf(<'DH', ~passphrase>)), 
                                      'g'^(~j_edh_sk.1*~x.1), 'g'^~x.1, j_edh_pk, 
                                      'g'^kdf(<'DH', ~passphrase>)>),
                                 'g'^~x.1, z, c_pq))
                     ) @ #vk.18 )
                case Source_Send
                by contradiction /* from formulas */
              next
                case c_senc
                solve( (#x2 < #t1)  ∥ (#t1 < #x2) )
                  case case_1
                  solve( !KU( H(kdf(<'g'^(~j_edh_sk.1*kdf(<'DH', ~passphrase>)), 
                                     'g'^(~j_edh_sk.1*~x.1), 'g'^~x.1, j_edh_pk, 
                                     'g'^kdf(<'DH', ~passphrase>)>),
                                'g'^~x.1, z, c_pq)
                         ) @ #vk.22 )
                    case c_H
                    solve( !KU( ~msg ) @ #vk.26 )
                      case Source_Send
                      solve( !KU( kdf(<'g'^(~j_edh_sk*kdf(<'DH', ~passphrase>)), 
                                       'g'^(~j_edh_sk*~x), 'g'^~x, 'g'^~j_edh_sk, 
                                       'g'^kdf(<'DH', ~passphrase>)>)
                             ) @ #vk.37 )
                        case c_kdf
                        solve( !KU( 'g'^(~j_edh_sk*kdf(<'DH', ~passphrase>)) ) @ #vk.44 )
                          case Journalist_Register_Ephemeral_Key
                          solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.47 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Source_DH_Key
                            by contradiction /* from formulas */
                          next
                            case c_kdf
                            by solve( !KU( ~passphrase ) @ #vk.50 )
                          qed
                        next
                          case Journalist_Send_case_01
                          solve( !KU( aenc(<'cipher_s2j', 
                                            'g'^(~j_edh_sk*kdf(<'DH', ~passphrase>)), 'g'^~x.2, 
                                            c_pq.1>,
                                           pk(~j_epke_sk.2))
                                 ) @ #vk.49 )
                            case c_aenc
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_02
                          solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.51 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Source_DH_Key
                            by contradiction /* from formulas */
                          next
                            case c_kdf
                            by solve( !KU( ~passphrase ) @ #vk.58 )
                          qed
                        next
                          case Journalist_Send_case_03
                          solve( !KU( ~j_edh_sk ) @ #vk.51 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_04
                          solve( !KU( aenc(<'cipher_s2j', 
                                            'g'^(~j_edh_sk*x.2*kdf(<'DH', ~passphrase>)), 'g'^~x.3, 
                                            c_pq.1>,
                                           pk(~j_epke_sk.2))
                                 ) @ #vk.49 )
                            case c_aenc
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_05
                          solve( !KU( aenc(<'cipher_s2j', 
                                            'g'^(~j_edh_sk*inv(x.2)*kdf(<'DH', ~passphrase>)), 
                                            'g'^~x.3, c_pq.1>,
                                           pk(~j_epke_sk.2))
                                 ) @ #vk.49 )
                            case c_aenc
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_06
                          solve( !KU( ~j_edh_sk ) @ #vk.52 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_07
                          solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.52 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Source_DH_Key
                            by contradiction /* from formulas */
                          next
                            case c_kdf
                            by solve( !KU( ~passphrase ) @ #vk.61 )
                          qed
                        next
                          case Journalist_Send_case_08
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_09
                          solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Source_DH_Key
                            by contradiction /* from formulas */
                          next
                            case c_kdf
                            by solve( !KU( ~passphrase ) @ #vk.60 )
                          qed
                        next
                          case Journalist_Send_case_10
                          solve( !KU( aenc(<'cipher_s2j', 
                                            'g'^(~j_edh_sk*x.2*inv(x.3)*kdf(<'DH', ~passphrase>)), 
                                            'g'^~x.4, c_pq.1>,
                                           pk(~j_epke_sk.2))
                                 ) @ #vk.49 )
                            case c_aenc
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_11
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_12
                          solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Source_DH_Key
                            by contradiction /* from formulas */
                          next
                            case c_kdf
                            by solve( !KU( ~passphrase ) @ #vk.62 )
                          qed
                        next
                          case Journalist_Send_case_13
                          solve( !KU( ~me_sk ) @ #vk.51 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_14
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_15
                          solve( !KU( ~me_sk ) @ #vk.52 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_16
                          solve( !KU( ~me_sk ) @ #vk.52 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_17
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_18
                          solve( !KU( ~me_sk ) @ #vk.52 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_19
                          solve( !KU( ~me_sk ) @ #vk.52 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_20
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_21
                          solve( !KU( ~me_sk ) @ #vk.54 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_22
                          solve( !KU( ~me_sk ) @ #vk.55 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_23
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_24
                          solve( !KU( ~me_sk ) @ #vk.56 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_25
                          solve( !KU( aenc(<'cipher_s2j', 
                                            'g'^(~j_edh_sk*inv(~j_dh_sk.1)*kdf(<'DH', ~passphrase>)
                                                ), 
                                            'g'^~x.2, c_pq.1>,
                                           pk(~j_epke_sk.2))
                                 ) @ #vk.49 )
                            case c_aenc
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_26
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_27
                          solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Source_DH_Key
                            by contradiction /* from formulas */
                          next
                            case c_kdf
                            by solve( !KU( ~passphrase ) @ #vk.60 )
                          qed
                        next
                          case Journalist_Send_case_28
                          solve( !KU( aenc(<'cipher_s2j', 
                                            'g'^(~j_edh_sk*x.2*inv(~j_dh_sk.1)*
                                                 kdf(<'DH', ~passphrase>)), 
                                            'g'^~x.3, c_pq.1>,
                                           pk(~j_epke_sk.2))
                                 ) @ #vk.49 )
                            case c_aenc
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_29
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_30
                          solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Source_DH_Key
                            by contradiction /* from formulas */
                          next
                            case c_kdf
                            by solve( !KU( ~passphrase ) @ #vk.62 )
                          qed
                        next
                          case Journalist_Send_case_31
                          solve( !KU( ~me_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_32
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_33
                          solve( !KU( ~me_sk ) @ #vk.55 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_34
                          solve( !KU( ~me_sk ) @ #vk.56 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_35
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_36
                          solve( !KU( ~me_sk ) @ #vk.57 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_37
                          solve( !KU( ~me_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_38
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_39
                          solve( !KU( ~me_sk ) @ #vk.55 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_40
                          solve( !KU( ~me_sk ) @ #vk.56 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_41
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_42
                          solve( !KU( ~me_sk ) @ #vk.57 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_43
                          solve( !KU( aenc(<'cipher_s2j', 
                                            'g'^(~j_edh_sk*inv((~j_dh_sk.1*x.2))*
                                                 kdf(<'DH', ~passphrase>)), 
                                            'g'^~x.3, c_pq.1>,
                                           pk(~j_epke_sk.2))
                                 ) @ #vk.49 )
                            case c_aenc
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_44
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_45
                          solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Source_DH_Key
                            by contradiction /* from formulas */
                          next
                            case c_kdf
                            by solve( !KU( ~passphrase ) @ #vk.62 )
                          qed
                        next
                          case Journalist_Send_case_46
                          solve( !KU( aenc(<'cipher_s2j', 
                                            'g'^(~j_edh_sk*x.2*inv((~j_dh_sk.1*x.3))*
                                                 kdf(<'DH', ~passphrase>)), 
                                            'g'^~x.4, c_pq.1>,
                                           pk(~j_epke_sk.2))
                                 ) @ #vk.49 )
                            case c_aenc
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_47
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_48
                          solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Source_DH_Key
                            by contradiction /* from formulas */
                          next
                            case c_kdf
                            by solve( !KU( ~passphrase ) @ #vk.64 )
                          qed
                        next
                          case Register_Source_Passphrase
                          solve( !KU( ~j_edh_sk ) @ #vk.47 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Source_Send_case_1
                          solve( !KU( ~j_edh_sk ) @ #vk.61 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Source_Send_case_2
                          solve( !KU( ~j_edh_sk ) @ #vk.61 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case c_exp
                          solve( !KU( ~j_edh_sk ) @ #vk.49 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        qed
                      qed
                    qed
                  qed
                next
                  case case_2
                  solve( !KU( H(kdf(<'g'^(~j_edh_sk.1*kdf(<'DH', ~passphrase>)), 
                                     'g'^(~j_edh_sk.1*~x.1), 'g'^~x.1, j_edh_pk, 
                                     'g'^kdf(<'DH', ~passphrase>)>),
                                'g'^~x.1, z, c_pq)
                         ) @ #vk.22 )
                    case c_H
                    solve( !KU( ~msg ) @ #vk.26 )
                      case Source_Send
                      solve( !KU( kdf(<'g'^(~j_edh_sk*kdf(<'DH', ~passphrase>)), 
                                       'g'^(~j_edh_sk*~x), 'g'^~x, 'g'^~j_edh_sk, 
                                       'g'^kdf(<'DH', ~passphrase>)>)
                             ) @ #vk.37 )
                        case c_kdf
                        solve( !KU( 'g'^(~j_edh_sk*kdf(<'DH', ~passphrase>)) ) @ #vk.44 )
                          case Journalist_Register_Ephemeral_Key
                          solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.47 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Source_DH_Key
                            by contradiction /* from formulas */
                          next
                            case c_kdf
                            by solve( !KU( ~passphrase ) @ #vk.50 )
                          qed
                        next
                          case Journalist_Send_case_01
                          solve( !KU( aenc(<'cipher_s2j', 
                                            'g'^(~j_edh_sk*kdf(<'DH', ~passphrase>)), 'g'^~x.2, 
                                            c_pq.1>,
                                           pk(~j_epke_sk.2))
                                 ) @ #vk.49 )
                            case c_aenc
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_02
                          solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.51 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Source_DH_Key
                            by contradiction /* from formulas */
                          next
                            case c_kdf
                            by solve( !KU( ~passphrase ) @ #vk.58 )
                          qed
                        next
                          case Journalist_Send_case_03
                          solve( !KU( ~j_edh_sk ) @ #vk.51 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_04
                          solve( !KU( aenc(<'cipher_s2j', 
                                            'g'^(~j_edh_sk*x.2*kdf(<'DH', ~passphrase>)), 'g'^~x.3, 
                                            c_pq.1>,
                                           pk(~j_epke_sk.2))
                                 ) @ #vk.49 )
                            case c_aenc
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_05
                          solve( !KU( aenc(<'cipher_s2j', 
                                            'g'^(~j_edh_sk*inv(x.2)*kdf(<'DH', ~passphrase>)), 
                                            'g'^~x.3, c_pq.1>,
                                           pk(~j_epke_sk.2))
                                 ) @ #vk.49 )
                            case c_aenc
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_06
                          solve( !KU( ~j_edh_sk ) @ #vk.52 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_07
                          solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.52 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Source_DH_Key
                            by contradiction /* from formulas */
                          next
                            case c_kdf
                            by solve( !KU( ~passphrase ) @ #vk.61 )
                          qed
                        next
                          case Journalist_Send_case_08
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_09
                          solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Source_DH_Key
                            by contradiction /* from formulas */
                          next
                            case c_kdf
                            by solve( !KU( ~passphrase ) @ #vk.60 )
                          qed
                        next
                          case Journalist_Send_case_10
                          solve( !KU( aenc(<'cipher_s2j', 
                                            'g'^(~j_edh_sk*x.2*inv(x.3)*kdf(<'DH', ~passphrase>)), 
                                            'g'^~x.4, c_pq.1>,
                                           pk(~j_epke_sk.2))
                                 ) @ #vk.49 )
                            case c_aenc
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_11
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_12
                          solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Source_DH_Key
                            by contradiction /* from formulas */
                          next
                            case c_kdf
                            by solve( !KU( ~passphrase ) @ #vk.62 )
                          qed
                        next
                          case Journalist_Send_case_13
                          solve( !KU( ~me_sk ) @ #vk.51 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_14
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_15
                          solve( !KU( ~me_sk ) @ #vk.52 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_16
                          solve( !KU( ~me_sk ) @ #vk.52 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_17
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_18
                          solve( !KU( ~me_sk ) @ #vk.52 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_19
                          solve( !KU( ~me_sk ) @ #vk.52 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_20
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_21
                          solve( !KU( ~me_sk ) @ #vk.54 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_22
                          solve( !KU( ~me_sk ) @ #vk.55 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_23
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_24
                          solve( !KU( ~me_sk ) @ #vk.56 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_25
                          solve( !KU( aenc(<'cipher_s2j', 
                                            'g'^(~j_edh_sk*inv(~j_dh_sk.1)*kdf(<'DH', ~passphrase>)
                                                ), 
                                            'g'^~x.2, c_pq.1>,
                                           pk(~j_epke_sk.2))
                                 ) @ #vk.49 )
                            case c_aenc
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_26
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_27
                          solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Source_DH_Key
                            by contradiction /* from formulas */
                          next
                            case c_kdf
                            by solve( !KU( ~passphrase ) @ #vk.60 )
                          qed
                        next
                          case Journalist_Send_case_28
                          solve( !KU( aenc(<'cipher_s2j', 
                                            'g'^(~j_edh_sk*x.2*inv(~j_dh_sk.1)*
                                                 kdf(<'DH', ~passphrase>)), 
                                            'g'^~x.3, c_pq.1>,
                                           pk(~j_epke_sk.2))
                                 ) @ #vk.49 )
                            case c_aenc
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_29
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_30
                          solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Source_DH_Key
                            by contradiction /* from formulas */
                          next
                            case c_kdf
                            by solve( !KU( ~passphrase ) @ #vk.62 )
                          qed
                        next
                          case Journalist_Send_case_31
                          solve( !KU( ~me_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_32
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_33
                          solve( !KU( ~me_sk ) @ #vk.55 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_34
                          solve( !KU( ~me_sk ) @ #vk.56 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_35
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_36
                          solve( !KU( ~me_sk ) @ #vk.57 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_37
                          solve( !KU( ~me_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_38
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_39
                          solve( !KU( ~me_sk ) @ #vk.55 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_40
                          solve( !KU( ~me_sk ) @ #vk.56 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_41
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_42
                          solve( !KU( ~me_sk ) @ #vk.57 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_43
                          solve( !KU( aenc(<'cipher_s2j', 
                                            'g'^(~j_edh_sk*inv((~j_dh_sk.1*x.2))*
                                                 kdf(<'DH', ~passphrase>)), 
                                            'g'^~x.3, c_pq.1>,
                                           pk(~j_epke_sk.2))
                                 ) @ #vk.49 )
                            case c_aenc
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_44
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_45
                          solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Source_DH_Key
                            by contradiction /* from formulas */
                          next
                            case c_kdf
                            by solve( !KU( ~passphrase ) @ #vk.62 )
                          qed
                        next
                          case Journalist_Send_case_46
                          solve( !KU( aenc(<'cipher_s2j', 
                                            'g'^(~j_edh_sk*x.2*inv((~j_dh_sk.1*x.3))*
                                                 kdf(<'DH', ~passphrase>)), 
                                            'g'^~x.4, c_pq.1>,
                                           pk(~j_epke_sk.2))
                                 ) @ #vk.49 )
                            case c_aenc
                            by contradiction /* cyclic */
                          qed
                        next
                          case Journalist_Send_case_47
                          solve( !KU( ~j_edh_sk ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Journalist_Send_case_48
                          solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.53 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Source_DH_Key
                            by contradiction /* from formulas */
                          next
                            case c_kdf
                            by solve( !KU( ~passphrase ) @ #vk.64 )
                          qed
                        next
                          case Register_Source_Passphrase
                          solve( !KU( ~j_edh_sk ) @ #vk.47 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Source_Send_case_1
                          solve( !KU( ~j_edh_sk ) @ #vk.61 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case Source_Send_case_2
                          solve( !KU( ~j_edh_sk ) @ #vk.61 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        next
                          case c_exp
                          solve( !KU( ~j_edh_sk ) @ #vk.49 )
                            case PQAttacker
                            by contradiction /* cyclic */
                          next
                            case Reveal_Journalist_EDH_Key
                            by contradiction /* from formulas */
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      next
        case c_senc
        solve( !KU( H(kdf(<'g'^(~j_edh_sk*kdf(<'DH', ~passphrase>)), 
                           'g'^(~j_edh_sk*~x), 'g'^~x, j_edh_pk, 'g'^kdf(<'DH', ~passphrase>)
                          >),
                      'g'^~x, z, c_pq)
               ) @ #vk.4 )
          case c_H
          solve( !KU( kdf(<'g'^(~j_edh_sk*kdf(<'DH', ~passphrase>)), 
                           'g'^(~j_edh_sk*~x), 'g'^~x, j_edh_pk, 'g'^kdf(<'DH', ~passphrase>)
                          >)
                 ) @ #vk.17 )
            case c_kdf
            solve( !KU( 'g'^(~j_edh_sk*kdf(<'DH', ~passphrase>)) ) @ #vk.24 )
              case Journalist_Register_Ephemeral_Key
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.28 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.31 )
              qed
            next
              case Journalist_Send_case_01
              solve( !KU( aenc(<'cipher_s2j', 
                                'g'^(~j_edh_sk*kdf(<'DH', ~passphrase>)), 'g'^~x.1, c_pq.1>,
                               pk(~j_epke_sk.1))
                     ) @ #vk.30 )
                case c_aenc
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_02
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.32 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.39 )
              qed
            next
              case Journalist_Send_case_03
              solve( !KU( ~j_edh_sk ) @ #vk.32 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_EDH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_04
              solve( !KU( aenc(<'cipher_s2j', 
                                'g'^(~j_edh_sk*x.1*kdf(<'DH', ~passphrase>)), 'g'^~x.2, c_pq.1>,
                               pk(~j_epke_sk.1))
                     ) @ #vk.30 )
                case c_aenc
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_05
              solve( !KU( aenc(<'cipher_s2j', 
                                'g'^(~j_edh_sk*inv(x.1)*kdf(<'DH', ~passphrase>)), 'g'^~x.2, c_pq.1
                               >,
                               pk(~j_epke_sk.1))
                     ) @ #vk.30 )
                case c_aenc
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_06
              solve( !KU( ~j_edh_sk ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_EDH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_07
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.42 )
              qed
            next
              case Journalist_Send_case_08
              solve( !KU( ~j_edh_sk ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_EDH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_09
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.41 )
              qed
            next
              case Journalist_Send_case_10
              solve( !KU( aenc(<'cipher_s2j', 
                                'g'^(~j_edh_sk*x.1*inv(x.2)*kdf(<'DH', ~passphrase>)), 'g'^~x.3, 
                                c_pq.1>,
                               pk(~j_epke_sk.1))
                     ) @ #vk.30 )
                case c_aenc
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_11
              solve( !KU( ~j_edh_sk ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_EDH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_12
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.43 )
              qed
            next
              case Journalist_Send_case_13
              solve( !KU( ~me_sk ) @ #vk.32 )
                case PQAttacker
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_14
              solve( !KU( ~j_edh_sk ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_EDH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_15
              solve( !KU( ~me_sk ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_16
              solve( !KU( ~me_sk ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_17
              solve( !KU( ~j_edh_sk ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_EDH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_18
              solve( !KU( ~me_sk ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_19
              solve( !KU( ~me_sk ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_20
              solve( !KU( ~j_edh_sk ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_EDH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_21
              solve( !KU( ~me_sk ) @ #vk.35 )
                case PQAttacker
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_22
              solve( !KU( ~me_sk ) @ #vk.36 )
                case PQAttacker
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_23
              solve( !KU( ~j_edh_sk ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_EDH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_24
              solve( !KU( ~me_sk ) @ #vk.37 )
                case PQAttacker
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_25
              solve( !KU( aenc(<'cipher_s2j', 
                                'g'^(~j_edh_sk*inv(~j_dh_sk.1)*kdf(<'DH', ~passphrase>)), 
                                'g'^~x.1, c_pq.1>,
                               pk(~j_epke_sk.1))
                     ) @ #vk.30 )
                case c_aenc
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_26
              solve( !KU( ~j_edh_sk ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_EDH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_27
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.41 )
              qed
            next
              case Journalist_Send_case_28
              solve( !KU( aenc(<'cipher_s2j', 
                                'g'^(~j_edh_sk*x.1*inv(~j_dh_sk.1)*kdf(<'DH', ~passphrase>)), 
                                'g'^~x.2, c_pq.1>,
                               pk(~j_epke_sk.1))
                     ) @ #vk.30 )
                case c_aenc
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_29
              solve( !KU( ~j_edh_sk ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_EDH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_30
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.43 )
              qed
            next
              case Journalist_Send_case_31
              solve( !KU( ~me_sk ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_32
              solve( !KU( ~j_edh_sk ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_EDH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_33
              solve( !KU( ~me_sk ) @ #vk.36 )
                case PQAttacker
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_34
              solve( !KU( ~me_sk ) @ #vk.37 )
                case PQAttacker
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_35
              solve( !KU( ~j_edh_sk ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_EDH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_36
              solve( !KU( ~me_sk ) @ #vk.38 )
                case PQAttacker
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_37
              solve( !KU( ~me_sk ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_38
              solve( !KU( ~j_edh_sk ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_EDH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_39
              solve( !KU( ~me_sk ) @ #vk.36 )
                case PQAttacker
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_40
              solve( !KU( ~me_sk ) @ #vk.37 )
                case PQAttacker
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_41
              solve( !KU( ~j_edh_sk ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_EDH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_42
              solve( !KU( ~me_sk ) @ #vk.38 )
                case PQAttacker
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_43
              solve( !KU( aenc(<'cipher_s2j', 
                                'g'^(~j_edh_sk*inv((~j_dh_sk.1*x.1))*kdf(<'DH', ~passphrase>)), 
                                'g'^~x.2, c_pq.1>,
                               pk(~j_epke_sk.1))
                     ) @ #vk.30 )
                case c_aenc
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_44
              solve( !KU( ~j_edh_sk ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_EDH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_45
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.43 )
              qed
            next
              case Journalist_Send_case_46
              solve( !KU( aenc(<'cipher_s2j', 
                                'g'^(~j_edh_sk*x.1*inv((~j_dh_sk.1*x.2))*kdf(<'DH', ~passphrase>)
                                    ), 
                                'g'^~x.3, c_pq.1>,
                               pk(~j_epke_sk.1))
                     ) @ #vk.30 )
                case c_aenc
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_47
              solve( !KU( ~j_edh_sk ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_EDH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_48
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.45 )
              qed
            next
              case Register_Source_Passphrase
              solve( !KU( ~j_edh_sk ) @ #vk.28 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_EDH_Key
                by contradiction /* from formulas */
              qed
            next
              case Source_Send_case_1
              solve( !KU( ~j_edh_sk ) @ #vk.42 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_EDH_Key
                by contradiction /* from formulas */
              qed
            next
              case Source_Send_case_2
              solve( !KU( ~j_edh_sk ) @ #vk.42 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_EDH_Key
                by contradiction /* from formulas */
              qed
            next
              case c_exp
              solve( !KU( ~j_edh_sk ) @ #vk.30 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_EDH_Key
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma Executability_Journalist_Response:
  exists-trace
  "∃ #t1 #t2 s_dh_pk s_kem_pk j_sig_pk j_dh_pk nr m_old m.
    ((Journalist_Response( j_sig_pk, j_dh_pk, nr, s_dh_pk, s_kem_pk,
                           m_old, m
      ) @ #t1) ∧
     (Source_Received( s_dh_pk, j_dh_pk, nr, m ) @ #t2)) ∧
    (¬(∃ #x. SomeCompromise( ) @ #x))"
/*
guarded formula characterizing all satisfying traces:
"∃ #t1 #t2 s_dh_pk s_kem_pk j_sig_pk j_dh_pk nr m_old m.
  (Journalist_Response( j_sig_pk, j_dh_pk, nr, s_dh_pk, s_kem_pk,
                        m_old, m
   ) @ #t1) ∧
  (Source_Received( s_dh_pk, j_dh_pk, nr, m ) @ #t2)
 ∧
  ∀ #x. (SomeCompromise( ) @ #x) ⇒ ⊥"
*/
simplify
solve( Journalist_Recv( $J, $NR, 'g'^kdf(<'DH', ~passphrase>),
                        s_pke_pk, s_kem_pk, m_old
       ) ▶₀ #t1 )
  case Journalist_Recv
  solve( !Ltk_Journalist_DH_Key( $J, ~j_dh_sk ) ▶₁ #t1 )
    case Journalist_Enrollment
    solve( !Journalist_Signature( $NR, $J, <j_sig_pk, 'g'^~j_dh_sk>,
                                  sign(<'signature', j_sig_pk, 'g'^~j_dh_sk>, x)
           ) ▶₂ #t1 )
      case Journalist_Enrollment
      solve( !KU( aenc(<'cipher_j2s', 'g'^~j_dh_sk, c_dhkem, c_pq>,
                       pk(kdf(<'PKE', ~passphrase>)))
             ) @ #vk.1 )
        case Journalist_Send
        solve( !KU( senc(<'msg_j2s', ~msg.1, 'g'^kdf(<'DH', ~passphrase>), 
                          pk(~j_sig_sk), 'g'^~j_dh_sk, 
                          sign(<'signature', pk(~j_sig_sk), 'g'^~j_dh_sk>, ~nr_sk), $NR>,
                         H(kdf(<'g'^(~j_dh_sk*kdf(<'DH', ~passphrase>)), 
                                'g'^(~me_sk.1*kdf(<'DH', ~passphrase>)), 'g'^~me_sk.1, 
                                'g'^kdf(<'DH', ~passphrase>), 'g'^~j_dh_sk>),
                           'g'^~me_sk.1, z, encap(~k_pq.1, s_kem_pk.1)))
               ) @ #vk.2 )
          case Journalist_Send
          solve( !Ltk_Source_Passphrase( $S, ~passphrase ) ▶₁ #t2 )
            case Register_Source_Passphrase
            solve( !Pk_Newsroom( $NR, pk(~nr_sk) ) ▶₂ #t2 )
              case Register_Newsroom_Key
              solve( !KU( aenc(<'cipher_s2j', 'g'^kdf(<'DH', ~passphrase>), 
                                'g'^~x, c_pq>,
                               pk(~j_epke_sk))
                     ) @ #vk.4 )
                case Source_Send
                solve( !KU( senc(<'msg_s2j', ~msg, 'g'^kdf(<'DH', ~passphrase>), 
                                  pk(kdf(<'PKE', ~passphrase>)), pqpk(kdf(<'KEM', ~passphrase>)), 
                                  pk(~j_sig_sk), $NR>,
                                 H(kdf(<'g'^(~j_edh_sk*kdf(<'DH', ~passphrase>)), 
                                        'g'^(~j_edh_sk*~x), 'g'^~x, j_edh_pk, 
                                        'g'^kdf(<'DH', ~passphrase>)>),
                                   'g'^~x, z, encap(~k_pq.1, j_ekem_pk)))
                       ) @ #vk.5 )
                  case Source_Send
                  solve( !KU( pk(~j_sig_sk) ) @ #vk.8 )
                    case Journalist_Enrollment
                    solve( !KU( sign(<'signature', pk(~j_sig_sk), j_dh_pk>, ~ltk)
                           ) @ #vk.11 )
                      case Journalist_Enrollment
                      solve( !KU( pk(~j_epke_sk) ) @ #vk.16 )
                        case Journalist_Register_Ephemeral_Key
                        solve( !KU( sign(<'ephemeral', 'g'^~j_edh_sk, pk(~j_epke_sk), 
                                          pqpk(~j_ekem_sk)>,
                                         ~j_sig_sk)
                               ) @ #vk.18 )
                          case Journalist_Register_Ephemeral_Key
                          solve( !KU( 'g'^~j_edh_sk ) @ #vk.17 )
                            case Journalist_Register_Ephemeral_Key
                            solve( !KU( pqpk(~j_ekem_sk) ) @ #vk.18 )
                              case Journalist_Register_Ephemeral_Key
                              solve( !KU( 'g'^~j_dh_sk ) @ #vk.18 )
                                case Journalist_Enrollment
                                SOLVED // trace found
                              next
                                case Journalist_Send_case_01
                                by sorry
                              next
                                case Journalist_Send_case_02
                                by sorry
                              next
                                case Journalist_Send_case_03
                                by sorry
                              next
                                case Journalist_Send_case_04
                                by sorry
                              next
                                case Journalist_Send_case_05
                                by sorry
                              next
                                case Journalist_Send_case_06
                                by sorry
                              next
                                case Journalist_Send_case_07
                                by sorry
                              next
                                case Journalist_Send_case_08
                                by sorry
                              next
                                case Journalist_Send_case_09
                                by sorry
                              next
                                case Journalist_Send_case_10
                                by sorry
                              next
                                case Journalist_Send_case_11
                                by sorry
                              next
                                case Journalist_Send_case_12
                                by sorry
                              next
                                case Journalist_Send_case_13
                                by sorry
                              next
                                case Journalist_Send_case_14
                                by sorry
                              next
                                case Journalist_Send_case_15
                                by sorry
                              next
                                case Journalist_Send_case_16
                                by sorry
                              next
                                case Journalist_Send_case_17
                                by sorry
                              next
                                case Journalist_Send_case_18
                                by sorry
                              next
                                case c_exp
                                by sorry
                              qed
                            next
                              case c_pqpk
                              by sorry
                            qed
                          next
                            case Journalist_Send_case_01
                            by sorry
                          next
                            case Journalist_Send_case_02
                            by sorry
                          next
                            case Journalist_Send_case_03
                            by sorry
                          next
                            case Journalist_Send_case_04
                            by sorry
                          next
                            case Journalist_Send_case_05
                            by sorry
                          next
                            case Journalist_Send_case_06
                            by sorry
                          next
                            case Journalist_Send_case_07
                            by sorry
                          next
                            case Journalist_Send_case_08
                            by sorry
                          next
                            case Journalist_Send_case_09
                            by sorry
                          next
                            case Journalist_Send_case_10
                            by sorry
                          next
                            case Journalist_Send_case_11
                            by sorry
                          next
                            case Journalist_Send_case_12
                            by sorry
                          next
                            case Journalist_Send_case_13
                            by sorry
                          next
                            case Journalist_Send_case_14
                            by sorry
                          next
                            case Journalist_Send_case_15
                            by sorry
                          next
                            case Journalist_Send_case_16
                            by sorry
                          next
                            case c_exp
                            by sorry
                          qed
                        next
                          case c_sign
                          by sorry
                        qed
                      next
                        case c_pk
                        by sorry
                      qed
                    next
                      case Journalist_Send
                      by sorry
                    next
                      case c_sign
                      by sorry
                    qed
                  next
                    case Journalist_Send
                    by sorry
                  next
                    case c_pk
                    by sorry
                  qed
                next
                  case c_senc
                  by sorry
                qed
              next
                case c_aenc
                by sorry
              qed
            qed
          qed
        next
          case c_senc
          by sorry
        qed
      next
        case c_aenc
        by sorry
      qed
    qed
  qed
qed

lemma Auto_Secrecy_Journalist_Message:
  all-traces
  "∀ #t1 #t2 #t3 s_dh_pk s_kem_pk j_sig_pk j_edh_pk j_ekem_pk j_dh_pk
     nr m_old m.
    (((Source_Sent( s_dh_pk, j_sig_pk, j_edh_pk, j_ekem_pk, nr, m_old
       ) @ #t1) ∧
      (Journalist_Received( j_sig_pk, j_edh_pk, nr, s_dh_pk, m_old
       ) @ #t2)) ∧
     (Journalist_Response( j_sig_pk, j_dh_pk, nr, s_dh_pk, s_kem_pk,
                           m_old, m
      ) @ #t3)) ⇒
    ((¬(∃ #x. K( m ) @ #x)) ∨
     ((∃ #x. Reveal_Source_KEM_Key( s_kem_pk ) @ #x) ∧
      ((∃ #x. PQAttack( ) @ #x) ∨
       (∃ #x. Reveal_Source_DH_Key( s_dh_pk ) @ #x))))"
/*
guarded formula characterizing all counter-examples:
"∃ #t1 #t2 #t3 s_dh_pk s_kem_pk j_sig_pk j_edh_pk j_ekem_pk j_dh_pk
   nr m_old m.
  (Source_Sent( s_dh_pk, j_sig_pk, j_edh_pk, j_ekem_pk, nr, m_old
   ) @ #t1) ∧
  (Journalist_Received( j_sig_pk, j_edh_pk, nr, s_dh_pk, m_old
   ) @ #t2) ∧
  (Journalist_Response( j_sig_pk, j_dh_pk, nr, s_dh_pk, s_kem_pk,
                        m_old, m
   ) @ #t3)
 ∧
  (∃ #x. (K( m ) @ #x)) ∧
  (((∀ #x. (Reveal_Source_KEM_Key( s_kem_pk ) @ #x) ⇒ ⊥) ∨
    ((∀ #x. (PQAttack( ) @ #x) ⇒ ⊥) ∧
     (∀ #x. (Reveal_Source_DH_Key( s_dh_pk ) @ #x) ⇒ ⊥))))"
*/
simplify
solve( Journalist_Ephemeral_Key( $J, ~j_edh_sk, ~j_epke_sk,
                                 ~j_ekem_sk
       ) ▶₁ #t2 )
  case Journalist_Register_Ephemeral_Key
  solve( !Ltk_Journalist_SIG_Key( $J, ~j_sig_sk ) ▶₂ #t2 )
    case Journalist_Enrollment
    solve( !Journalist_Enrolled( $NR, $J ) ▶₃ #t2 )
      case Journalist_Enrollment
      solve( Journalist_Recv( $J.1, $NR, 'g'^kdf(<'DH', ~passphrase>),
                              s_pke_pk, s_kem_pk,
                              <'msg_s2j', ~msg, 'g'^kdf(<'DH', ~passphrase>), 
                               pk(kdf(<'PKE', ~passphrase>)), pqpk(kdf(<'KEM', ~passphrase>)), 
                               pk(~j_sig_sk), $NR>
             ) ▶₀ #t3 )
        case Journalist_Recv
        solve( !Ltk_Journalist_DH_Key( $J, ~j_dh_sk ) ▶₁ #t3 )
          case Journalist_Enrollment
          solve( !Journalist_Signature( $NR, $J,
                                        <pk(~j_sig_sk), 'g'^~j_dh_sk>, sig_j_pk
                 ) ▶₂ #t3 )
            case Journalist_Enrollment
            solve( !Ltk_Source_Passphrase( $S, ~passphrase ) ▶₀ #t1 )
              case Register_Source_Passphrase
              solve( !Pk_Newsroom( $NR, pk(x) ) ▶₁ #t1 )
                case Register_Newsroom_Key
                solve( !KU( ~msg.1 ) @ #vk.21 )
                  case Journalist_Send
                  solve( !KU( ~k_pq.1 ) @ #vk.34 )
                    case Journalist_Send
                    solve( !KU( kdf(<'KEM', ~passphrase>) ) @ #vk.37 )
                      case Reveal_Source_KEM_Key
                      solve( !KU( kdf(<'g'^(~j_dh_sk*kdf(<'DH', ~passphrase>)), 
                                       'g'^(~me_sk.1*kdf(<'DH', ~passphrase>)), 'g'^~me_sk.1, 
                                       'g'^kdf(<'DH', ~passphrase>), 'g'^~j_dh_sk>)
                             ) @ #vk.35 )
                        case c_kdf
                        solve( (∀ #x.
                                 (Reveal_Source_KEM_Key( pqpk(kdf(<'KEM', ~passphrase>)) ) @ #x)
                                ⇒
                                 ⊥)  ∥
                               ((∀ #x. (PQAttack( ) @ #x) ⇒ ⊥) ∧
                                (∀ #x.
                                  (Reveal_Source_DH_Key( 'g'^kdf(<'DH', ~passphrase>) ) @ #x)
                                 ⇒
                                  ⊥)) )
                          case case_1
                          by contradiction /* from formulas */
                        next
                          case case_2
                          solve( !KU( 'g'^(~me_sk.1*kdf(<'DH', ~passphrase>)) ) @ #vk.43 )
                            case Journalist_Send_case_01
                            solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.44 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            next
                              case Reveal_Source_DH_Key
                              by contradiction /* from formulas */
                            next
                              case c_kdf
                              by solve( !KU( ~passphrase ) @ #vk.47 )
                            qed
                          next
                            case Journalist_Send_case_02
                            solve( !KU( kdf(<
                                             'g'^(~j_dh_sk.1*~me_sk.1*kdf(<'DH', ~passphrase>)), 
                                             'g'^(~me_sk.1*~me_sk.2*kdf(<'DH', ~passphrase>)), 
                                             'g'^~me_sk.2, 'g'^(~me_sk.1*kdf(<'DH', ~passphrase>)), 
                                             'g'^~j_dh_sk.1>)
                                   ) @ #vk.48 )
                              case c_kdf
                              by contradiction /* cyclic */
                            qed
                          next
                            case Journalist_Send_case_03
                            solve( !KU( ~me_sk.1 ) @ #vk.48 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_04
                            solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.48 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            next
                              case Reveal_Source_DH_Key
                              by contradiction /* from formulas */
                            next
                              case c_kdf
                              by solve( !KU( ~passphrase ) @ #vk.55 )
                            qed
                          next
                            case Journalist_Send_case_05
                            solve( !KU( kdf(<
                                             'g'^(~j_dh_sk.1*~me_sk.1*x.3*kdf(<'DH', ~passphrase>)
                                                 ), 
                                             'g'^(~me_sk.1*~me_sk.2*x.3*kdf(<'DH', ~passphrase>)), 
                                             'g'^~me_sk.2, 
                                             'g'^(~me_sk.1*x.3*kdf(<'DH', ~passphrase>)), 
                                             'g'^~j_dh_sk.1>)
                                   ) @ #vk.50 )
                              case c_kdf
                              by contradiction /* cyclic */
                            qed
                          next
                            case Journalist_Send_case_06
                            solve( !KU( kdf(<
                                             'g'^(~j_dh_sk.1*~me_sk.1*inv(x.3)*
                                                  kdf(<'DH', ~passphrase>)), 
                                             'g'^(~me_sk.1*~me_sk.2*inv(x.3)*
                                                  kdf(<'DH', ~passphrase>)), 
                                             'g'^~me_sk.2, 
                                             'g'^(~me_sk.1*inv(x.3)*kdf(<'DH', ~passphrase>)), 
                                             'g'^~j_dh_sk.1>)
                                   ) @ #vk.49 )
                              case c_kdf
                              by contradiction /* cyclic */
                            qed
                          next
                            case Journalist_Send_case_07
                            solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.49 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            next
                              case Reveal_Source_DH_Key
                              by contradiction /* from formulas */
                            next
                              case c_kdf
                              by solve( !KU( ~passphrase ) @ #vk.58 )
                            qed
                          next
                            case Journalist_Send_case_08
                            solve( !KU( ~me_sk.1 ) @ #vk.49 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_09
                            solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.50 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            next
                              case Reveal_Source_DH_Key
                              by contradiction /* from formulas */
                            next
                              case c_kdf
                              by solve( !KU( ~passphrase ) @ #vk.57 )
                            qed
                          next
                            case Journalist_Send_case_10
                            solve( !KU( ~me_sk.1 ) @ #vk.50 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_11
                            solve( !KU( kdf(<
                                             'g'^(~j_dh_sk.1*~me_sk.1*x.3*inv(x.4)*
                                                  kdf(<'DH', ~passphrase>)), 
                                             'g'^(~me_sk.1*~me_sk.2*x.3*inv(x.4)*
                                                  kdf(<'DH', ~passphrase>)), 
                                             'g'^~me_sk.2, 
                                             'g'^(~me_sk.1*x.3*inv(x.4)*kdf(<'DH', ~passphrase>)), 
                                             'g'^~j_dh_sk.1>)
                                   ) @ #vk.52 )
                              case c_kdf
                              by contradiction /* cyclic */
                            qed
                          next
                            case Journalist_Send_case_12
                            solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.50 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            next
                              case Reveal_Source_DH_Key
                              by contradiction /* from formulas */
                            next
                              case c_kdf
                              by solve( !KU( ~passphrase ) @ #vk.59 )
                            qed
                          next
                            case Journalist_Send_case_13
                            solve( !KU( ~me_sk.1 ) @ #vk.50 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_14
                            solve( !KU( ~me_sk.2 ) @ #vk.48 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_15
                            solve( !KU( ~me_sk.2 ) @ #vk.49 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_16
                            solve( !KU( ~me_sk.2 ) @ #vk.49 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_17
                            solve( !KU( ~me_sk.2 ) @ #vk.49 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_18
                            solve( !KU( ~me_sk.2 ) @ #vk.49 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_19
                            solve( !KU( ~me_sk.2 ) @ #vk.49 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_20
                            solve( !KU( ~me_sk.2 ) @ #vk.49 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_21
                            solve( !KU( ~me_sk.2 ) @ #vk.51 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_22
                            solve( !KU( ~me_sk.1 ) @ #vk.50 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_23
                            solve( !KU( ~me_sk.2 ) @ #vk.52 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_24
                            solve( !KU( ~me_sk.2 ) @ #vk.53 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_25
                            solve( !KU( ~me_sk.1 ) @ #vk.50 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_26
                            solve( !KU( kdf(<'g'^(~me_sk.1*kdf(<'DH', ~passphrase>)), 
                                             'g'^(~me_sk.1*~me_sk.2*inv(~j_dh_sk.1)*
                                                  kdf(<'DH', ~passphrase>)), 
                                             'g'^~me_sk.2, 
                                             'g'^(~me_sk.1*inv(~j_dh_sk.1)*kdf(<'DH', ~passphrase>)
                                                 ), 
                                             'g'^~j_dh_sk.1>)
                                   ) @ #vk.49 )
                              case c_kdf
                              by contradiction /* cyclic */
                            qed
                          next
                            case Journalist_Send_case_27
                            solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.50 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            next
                              case Reveal_Source_DH_Key
                              by contradiction /* from formulas */
                            next
                              case c_kdf
                              by solve( !KU( ~passphrase ) @ #vk.57 )
                            qed
                          next
                            case Journalist_Send_case_28
                            solve( !KU( ~me_sk.1 ) @ #vk.50 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_29
                            solve( !KU( kdf(<'g'^(~me_sk.1*x.3*kdf(<'DH', ~passphrase>)), 
                                             'g'^(~me_sk.1*~me_sk.2*x.3*inv(~j_dh_sk.1)*
                                                  kdf(<'DH', ~passphrase>)), 
                                             'g'^~me_sk.2, 
                                             'g'^(~me_sk.1*x.3*inv(~j_dh_sk.1)*
                                                  kdf(<'DH', ~passphrase>)), 
                                             'g'^~j_dh_sk.1>)
                                   ) @ #vk.52 )
                              case c_kdf
                              by contradiction /* cyclic */
                            qed
                          next
                            case Journalist_Send_case_30
                            solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.50 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            next
                              case Reveal_Source_DH_Key
                              by contradiction /* from formulas */
                            next
                              case c_kdf
                              by solve( !KU( ~passphrase ) @ #vk.59 )
                            qed
                          next
                            case Journalist_Send_case_31
                            solve( !KU( ~me_sk.1 ) @ #vk.50 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_32
                            solve( !KU( ~me_sk.2 ) @ #vk.50 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_33
                            solve( !KU( ~me_sk.2 ) @ #vk.52 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_34
                            solve( !KU( ~me_sk.1 ) @ #vk.50 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_35
                            solve( !KU( ~me_sk.2 ) @ #vk.53 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_36
                            solve( !KU( ~me_sk.2 ) @ #vk.54 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_37
                            solve( !KU( ~me_sk.1 ) @ #vk.50 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_38
                            solve( !KU( ~me_sk.2 ) @ #vk.50 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_39
                            solve( !KU( ~me_sk.2 ) @ #vk.52 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_40
                            solve( !KU( ~me_sk.1 ) @ #vk.50 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_41
                            solve( !KU( ~me_sk.2 ) @ #vk.53 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_42
                            solve( !KU( ~me_sk.2 ) @ #vk.54 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_43
                            solve( !KU( ~me_sk.1 ) @ #vk.50 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_44
                            solve( !KU( kdf(<'g'^(~me_sk.1*inv(x.3)*kdf(<'DH', ~passphrase>)), 
                                             'g'^(~me_sk.1*~me_sk.2*inv((~j_dh_sk.1*x.3))*
                                                  kdf(<'DH', ~passphrase>)), 
                                             'g'^~me_sk.2, 
                                             'g'^(~me_sk.1*inv((~j_dh_sk.1*x.3))*
                                                  kdf(<'DH', ~passphrase>)), 
                                             'g'^~j_dh_sk.1>)
                                   ) @ #vk.51 )
                              case c_kdf
                              by contradiction /* cyclic */
                            qed
                          next
                            case Journalist_Send_case_45
                            solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.50 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            next
                              case Reveal_Source_DH_Key
                              by contradiction /* from formulas */
                            next
                              case c_kdf
                              by solve( !KU( ~passphrase ) @ #vk.59 )
                            qed
                          next
                            case Journalist_Send_case_46
                            solve( !KU( ~me_sk.1 ) @ #vk.50 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Journalist_Send_case_47
                            solve( !KU( kdf(<
                                             'g'^(~me_sk.1*x.3*inv(x.4)*kdf(<'DH', ~passphrase>)), 
                                             'g'^(~me_sk.1*~me_sk.2*x.3*inv((~j_dh_sk.1*x.4))*
                                                  kdf(<'DH', ~passphrase>)), 
                                             'g'^~me_sk.2, 
                                             'g'^(~me_sk.1*x.3*inv((~j_dh_sk.1*x.4))*
                                                  kdf(<'DH', ~passphrase>)), 
                                             'g'^~j_dh_sk.1>)
                                   ) @ #vk.54 )
                              case c_kdf
                              by contradiction /* cyclic */
                            qed
                          next
                            case Journalist_Send_case_48
                            solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.50 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            next
                              case Reveal_Source_DH_Key
                              by contradiction /* from formulas */
                            next
                              case c_kdf
                              by solve( !KU( ~passphrase ) @ #vk.61 )
                            qed
                          next
                            case Journalist_Send_case_49
                            solve( !KU( ~me_sk.1 ) @ #vk.50 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Register_Source_Passphrase
                            solve( !KU( ~me_sk.1 ) @ #vk.44 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Source_Send_case_1
                            solve( !KU( ~me_sk.1 ) @ #vk.58 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case Source_Send_case_2
                            solve( !KU( ~me_sk.1 ) @ #vk.58 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          next
                            case c_exp
                            solve( !KU( ~me_sk.1 ) @ #vk.46 )
                              case PQAttacker
                              by contradiction /* from formulas */
                            qed
                          qed
                        qed
                      qed
                    next
                      case c_kdf
                      by solve( !KU( ~passphrase ) @ #vk.40 )
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma Auto_Non_Injective_Agreement_Journalist_Message:
  all-traces
  "∀ #t1 s_dh_pk j_dh_pk nr m.
    (Source_Received( s_dh_pk, j_dh_pk, nr, m ) @ #t1) ⇒
    ((((∃ j_sig_pk s_kem_pk m_old #x.
         (Journalist_Response( j_sig_pk, j_dh_pk, nr, s_dh_pk, s_kem_pk,
                               m_old, m
          ) @ #x) ∧
         (#x < #t1)) ∨
       (∃ #x. Reveal_Newsroom_Key( nr ) @ #x)) ∨
      (∃ #x. Reveal_Journalist_DH_Key( j_dh_pk ) @ #x)) ∨
     (∃ #x. Reveal_Source_DH_Key( s_dh_pk ) @ #x))"
/*
guarded formula characterizing all counter-examples:
"∃ #t1 s_dh_pk j_dh_pk nr m.
  (Source_Received( s_dh_pk, j_dh_pk, nr, m ) @ #t1)
 ∧
  (∀ j_sig_pk s_kem_pk m_old #x.
    (Journalist_Response( j_sig_pk, j_dh_pk, nr, s_dh_pk, s_kem_pk,
                          m_old, m
     ) @ #x)
   ⇒
    ¬(#x < #t1)) ∧
  (∀ #x. (Reveal_Newsroom_Key( nr ) @ #x) ⇒ ⊥) ∧
  (∀ #x. (Reveal_Journalist_DH_Key( j_dh_pk ) @ #x) ⇒ ⊥) ∧
  (∀ #x. (Reveal_Source_DH_Key( s_dh_pk ) @ #x) ⇒ ⊥)"
*/
simplify
solve( !Pk_Newsroom( $NR, pk(x) ) ▶₂ #t1 )
  case Register_Newsroom_Key
  solve( !Ltk_Source_Passphrase( $S, ~passphrase ) ▶₁ #t1 )
    case Register_Source_Passphrase
    solve( !KU( senc(<'msg_j2s', ~msg, 'g'^kdf(<'DH', ~passphrase>), 
                      j_sig_pk, j_dh_pk, sign(<'signature', j_sig_pk, j_dh_pk>, ~ltk), 
                      $NR>,
                     H(kdf(<z, z.1, c_dhkem, 'g'^kdf(<'DH', ~passphrase>), j_dh_pk>),
                       c_dhkem, z.2, c_pq))
           ) @ #vk.2 )
      case Journalist_Send
      by contradiction /* from formulas */
    next
      case c_senc
      solve( !KU( sign(<'signature', j_sig_pk, j_dh_pk>, ~ltk)
             ) @ #vk.15 )
        case Journalist_Enrollment
        solve( !KU( H(kdf(<'g'^(~j_dh_sk*kdf(<'DH', ~passphrase>)), z, 
                           c_dhkem, 'g'^kdf(<'DH', ~passphrase>), 'g'^~j_dh_sk>),
                      c_dhkem, z.1, c_pq)
               ) @ #vk.5 )
          case c_H
          solve( !KU( kdf(<'g'^(~j_dh_sk*kdf(<'DH', ~passphrase>)), z, 
                           c_dhkem, 'g'^kdf(<'DH', ~passphrase>), 'g'^~j_dh_sk>)
                 ) @ #vk.17 )
            case c_kdf
            solve( !KU( 'g'^(~j_dh_sk*kdf(<'DH', ~passphrase>)) ) @ #vk.24 )
              case Journalist_Enrollment
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.27 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.30 )
              qed
            next
              case Journalist_Send_case_01
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.28 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.34 )
              qed
            next
              case Journalist_Send_case_02
              solve( !KU( kdf(<
                               'g'^(~j_dh_sk*~j_dh_sk.1*kdf(<'DH', ~passphrase>)), 
                               'g'^(~j_dh_sk*~me_sk*kdf(<'DH', ~passphrase>)), 'g'^~me_sk, 
                               'g'^(~j_dh_sk*kdf(<'DH', ~passphrase>)), 'g'^~j_dh_sk.1>)
                     ) @ #vk.31 )
                case c_kdf
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_03
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.31 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.38 )
              qed
            next
              case Journalist_Send_case_04
              solve( !KU( ~j_dh_sk ) @ #vk.31 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_05
              solve( !KU( kdf(<
                               'g'^(~j_dh_sk*x*~j_dh_sk.1*kdf(<'DH', ~passphrase>)), 
                               'g'^(~j_dh_sk*~me_sk*x*kdf(<'DH', ~passphrase>)), 'g'^~me_sk, 
                               'g'^(~j_dh_sk*x*kdf(<'DH', ~passphrase>)), 'g'^~j_dh_sk.1>)
                     ) @ #vk.33 )
                case c_kdf
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_06
              solve( !KU( kdf(<
                               'g'^(~j_dh_sk*~j_dh_sk.1*inv(x)*kdf(<'DH', ~passphrase>)), 
                               'g'^(~j_dh_sk*~me_sk*inv(x)*kdf(<'DH', ~passphrase>)), 'g'^~me_sk, 
                               'g'^(~j_dh_sk*inv(x)*kdf(<'DH', ~passphrase>)), 'g'^~j_dh_sk.1>)
                     ) @ #vk.32 )
                case c_kdf
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_07
              solve( !KU( ~j_dh_sk ) @ #vk.32 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_08
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.32 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.41 )
              qed
            next
              case Journalist_Send_case_09
              solve( !KU( ~j_dh_sk ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_10
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.40 )
              qed
            next
              case Journalist_Send_case_11
              solve( !KU( kdf(<
                               'g'^(~j_dh_sk*x*~j_dh_sk.1*inv(x.1)*kdf(<'DH', ~passphrase>)), 
                               'g'^(~j_dh_sk*~me_sk*x*inv(x.1)*kdf(<'DH', ~passphrase>)), 
                               'g'^~me_sk, 'g'^(~j_dh_sk*x*inv(x.1)*kdf(<'DH', ~passphrase>)), 
                               'g'^~j_dh_sk.1>)
                     ) @ #vk.35 )
                case c_kdf
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_12
              solve( !KU( ~j_dh_sk ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_13
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.42 )
              qed
            next
              case Journalist_Send_case_14
              solve( !KU( kdf(<
                               'g'^(~j_dh_sk*~j_dh_sk.1*inv(~me_sk)*kdf(<'DH', ~passphrase>)), 
                               'g'^(~j_dh_sk*kdf(<'DH', ~passphrase>)), 'g'^~me_sk, 
                               'g'^(~j_dh_sk*inv(~me_sk)*kdf(<'DH', ~passphrase>)), 'g'^~j_dh_sk.1
                              >)
                     ) @ #vk.32 )
                case c_kdf
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_15
              solve( !KU( ~j_dh_sk ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_16
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.40 )
              qed
            next
              case Journalist_Send_case_17
              solve( !KU( kdf(<
                               'g'^(~j_dh_sk*x*~j_dh_sk.1*inv(~me_sk)*kdf(<'DH', ~passphrase>)), 
                               'g'^(~j_dh_sk*x*kdf(<'DH', ~passphrase>)), 'g'^~me_sk, 
                               'g'^(~j_dh_sk*x*inv(~me_sk)*kdf(<'DH', ~passphrase>)), 
                               'g'^~j_dh_sk.1>)
                     ) @ #vk.35 )
                case c_kdf
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_18
              solve( !KU( ~j_dh_sk ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_19
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.42 )
              qed
            next
              case Journalist_Send_case_20
              solve( !KU( kdf(<
                               'g'^(~j_dh_sk*~j_dh_sk.1*inv((~me_sk*x))*kdf(<'DH', ~passphrase>)
                                   ), 
                               'g'^(~j_dh_sk*inv(x)*kdf(<'DH', ~passphrase>)), 'g'^~me_sk, 
                               'g'^(~j_dh_sk*inv((~me_sk*x))*kdf(<'DH', ~passphrase>)), 
                               'g'^~j_dh_sk.1>)
                     ) @ #vk.34 )
                case c_kdf
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_21
              solve( !KU( ~j_dh_sk ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_22
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.42 )
              qed
            next
              case Journalist_Send_case_23
              solve( !KU( kdf(<
                               'g'^(~j_dh_sk*x*~j_dh_sk.1*inv((~me_sk*x.1))*
                                    kdf(<'DH', ~passphrase>)), 
                               'g'^(~j_dh_sk*x*inv(x.1)*kdf(<'DH', ~passphrase>)), 'g'^~me_sk, 
                               'g'^(~j_dh_sk*x*inv((~me_sk*x.1))*kdf(<'DH', ~passphrase>)), 
                               'g'^~j_dh_sk.1>)
                     ) @ #vk.37 )
                case c_kdf
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_24
              solve( !KU( ~j_dh_sk ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_25
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.44 )
              qed
            next
              case Journalist_Send_case_26
              solve( !KU( ~j_dh_sk.1 ) @ #vk.31 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'g'^(~j_dh_sk*kdf(<'DH', ~passphrase>)), 
                                 'g'^(~j_dh_sk*~me_sk*inv(~j_dh_sk.1)*kdf(<'DH', ~passphrase>)), 
                                 'g'^~me_sk, 
                                 'g'^(~j_dh_sk*inv(~j_dh_sk.1)*kdf(<'DH', ~passphrase>)), 
                                 'g'^~j_dh_sk.1>)
                       ) @ #vk.32 )
                  case c_kdf
                  by contradiction /* cyclic */
                qed
              qed
            next
              case Journalist_Send_case_27
              solve( !KU( ~j_dh_sk.1 ) @ #vk.32 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( ~j_dh_sk ) @ #vk.33 )
                  case PQAttacker
                  by contradiction /* cyclic */
                next
                  case Reveal_Journalist_DH_Key
                  by contradiction /* from formulas */
                qed
              qed
            next
              case Journalist_Send_case_28
              solve( !KU( ~j_dh_sk.1 ) @ #vk.32 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.33 )
                  case PQAttacker
                  by contradiction /* cyclic */
                next
                  case Reveal_Source_DH_Key
                  by contradiction /* from formulas */
                next
                  case c_kdf
                  by solve( !KU( ~passphrase ) @ #vk.40 )
                qed
              qed
            next
              case Journalist_Send_case_29
              solve( !KU( ~j_dh_sk.1 ) @ #vk.32 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'g'^(~j_dh_sk*x*kdf(<'DH', ~passphrase>)), 
                                 'g'^(~j_dh_sk*~me_sk*x*inv(~j_dh_sk.1)*kdf(<'DH', ~passphrase>)), 
                                 'g'^~me_sk, 
                                 'g'^(~j_dh_sk*x*inv(~j_dh_sk.1)*kdf(<'DH', ~passphrase>)), 
                                 'g'^~j_dh_sk.1>)
                       ) @ #vk.35 )
                  case c_kdf
                  by contradiction /* cyclic */
                qed
              qed
            next
              case Journalist_Send_case_30
              solve( !KU( ~j_dh_sk.1 ) @ #vk.32 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( ~j_dh_sk ) @ #vk.33 )
                  case PQAttacker
                  by contradiction /* cyclic */
                next
                  case Reveal_Journalist_DH_Key
                  by contradiction /* from formulas */
                qed
              qed
            next
              case Journalist_Send_case_31
              solve( !KU( ~j_dh_sk.1 ) @ #vk.32 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.33 )
                  case PQAttacker
                  by contradiction /* cyclic */
                next
                  case Reveal_Source_DH_Key
                  by contradiction /* from formulas */
                next
                  case c_kdf
                  by solve( !KU( ~passphrase ) @ #vk.42 )
                qed
              qed
            next
              case Journalist_Send_case_32
              solve( !KU( ~j_dh_sk.1 ) @ #vk.32 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<
                                 'g'^(~j_dh_sk*inv(~me_sk)*kdf(<'DH', ~passphrase>)), 
                                 'g'^(~j_dh_sk*inv(~j_dh_sk.1)*kdf(<'DH', ~passphrase>)), 
                                 'g'^~me_sk, 
                                 'g'^(~j_dh_sk*inv((~me_sk*~j_dh_sk.1))*kdf(<'DH', ~passphrase>)), 
                                 'g'^~j_dh_sk.1>)
                       ) @ #vk.34 )
                  case c_kdf
                  by contradiction /* cyclic */
                qed
              qed
            next
              case Journalist_Send_case_33
              solve( !KU( ~j_dh_sk ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_34
              solve( !KU( ~j_dh_sk.1 ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.34 )
                  case PQAttacker
                  by contradiction /* cyclic */
                next
                  case Reveal_Source_DH_Key
                  by contradiction /* from formulas */
                next
                  case c_kdf
                  by solve( !KU( ~passphrase ) @ #vk.42 )
                qed
              qed
            next
              case Journalist_Send_case_35
              solve( !KU( ~j_dh_sk.1 ) @ #vk.35 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<
                                 'g'^(~j_dh_sk*x*inv(~me_sk)*kdf(<'DH', ~passphrase>)), 
                                 'g'^(~j_dh_sk*x*inv(~j_dh_sk.1)*kdf(<'DH', ~passphrase>)), 
                                 'g'^~me_sk, 
                                 'g'^(~j_dh_sk*x*inv((~me_sk*~j_dh_sk.1))*kdf(<'DH', ~passphrase>)
                                     ), 
                                 'g'^~j_dh_sk.1>)
                       ) @ #vk.37 )
                  case c_kdf
                  by contradiction /* cyclic */
                qed
              qed
            next
              case Journalist_Send_case_36
              solve( !KU( ~j_dh_sk ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_37
              solve( !KU( ~j_dh_sk.1 ) @ #vk.36 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.34 )
                  case PQAttacker
                  by contradiction /* cyclic */
                next
                  case Reveal_Source_DH_Key
                  by contradiction /* from formulas */
                next
                  case c_kdf
                  by solve( !KU( ~passphrase ) @ #vk.44 )
                qed
              qed
            next
              case Journalist_Send_case_38
              solve( !KU( ~j_dh_sk.1 ) @ #vk.32 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<
                                 'g'^(~j_dh_sk*inv((~me_sk*x))*kdf(<'DH', ~passphrase>)), 
                                 'g'^(~j_dh_sk*inv((x*~j_dh_sk.1))*kdf(<'DH', ~passphrase>)), 
                                 'g'^~me_sk, 
                                 'g'^(~j_dh_sk*inv((~me_sk*x*~j_dh_sk.1))*kdf(<'DH', ~passphrase>)
                                     ), 
                                 'g'^~j_dh_sk.1>)
                       ) @ #vk.35 )
                  case c_kdf
                  by contradiction /* cyclic */
                qed
              qed
            next
              case Journalist_Send_case_39
              solve( !KU( ~j_dh_sk ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_40
              solve( !KU( ~j_dh_sk.1 ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.34 )
                  case PQAttacker
                  by contradiction /* cyclic */
                next
                  case Reveal_Source_DH_Key
                  by contradiction /* from formulas */
                next
                  case c_kdf
                  by solve( !KU( ~passphrase ) @ #vk.43 )
                qed
              qed
            next
              case Journalist_Send_case_41
              solve( !KU( ~j_dh_sk.1 ) @ #vk.35 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<
                                 'g'^(~j_dh_sk*x*inv((~me_sk*x.1))*kdf(<'DH', ~passphrase>)), 
                                 'g'^(~j_dh_sk*x*inv((~j_dh_sk.1*x.1))*kdf(<'DH', ~passphrase>)), 
                                 'g'^~me_sk, 
                                 'g'^(~j_dh_sk*x*inv((~me_sk*~j_dh_sk.1*x.1))*
                                      kdf(<'DH', ~passphrase>)), 
                                 'g'^~j_dh_sk.1>)
                       ) @ #vk.38 )
                  case c_kdf
                  by contradiction /* cyclic */
                qed
              qed
            next
              case Journalist_Send_case_42
              solve( !KU( ~j_dh_sk ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_43
              solve( !KU( ~j_dh_sk.1 ) @ #vk.36 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.34 )
                  case PQAttacker
                  by contradiction /* cyclic */
                next
                  case Reveal_Source_DH_Key
                  by contradiction /* from formulas */
                next
                  case c_kdf
                  by solve( !KU( ~passphrase ) @ #vk.45 )
                qed
              qed
            next
              case Journalist_Send_case_44
              solve( !KU( ~j_dh_sk.1 ) @ #vk.32 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'g'^(~j_dh_sk*inv(x)*kdf(<'DH', ~passphrase>)), 
                                 'g'^(~j_dh_sk*~me_sk*inv((x*~j_dh_sk.1))*kdf(<'DH', ~passphrase>)
                                     ), 
                                 'g'^~me_sk, 
                                 'g'^(~j_dh_sk*inv((x*~j_dh_sk.1))*kdf(<'DH', ~passphrase>)), 
                                 'g'^~j_dh_sk.1>)
                       ) @ #vk.34 )
                  case c_kdf
                  by contradiction /* cyclic */
                qed
              qed
            next
              case Journalist_Send_case_45
              solve( !KU( ~j_dh_sk ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_46
              solve( !KU( ~j_dh_sk.1 ) @ #vk.34 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.34 )
                  case PQAttacker
                  by contradiction /* cyclic */
                next
                  case Reveal_Source_DH_Key
                  by contradiction /* from formulas */
                next
                  case c_kdf
                  by solve( !KU( ~passphrase ) @ #vk.42 )
                qed
              qed
            next
              case Journalist_Send_case_47
              solve( !KU( ~j_dh_sk.1 ) @ #vk.35 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<
                                 'g'^(~j_dh_sk*x*inv(x.1)*kdf(<'DH', ~passphrase>)), 
                                 'g'^(~j_dh_sk*~me_sk*x*inv((~j_dh_sk.1*x.1))*
                                      kdf(<'DH', ~passphrase>)), 
                                 'g'^~me_sk, 
                                 'g'^(~j_dh_sk*x*inv((~j_dh_sk.1*x.1))*kdf(<'DH', ~passphrase>)), 
                                 'g'^~j_dh_sk.1>)
                       ) @ #vk.37 )
                  case c_kdf
                  by contradiction /* cyclic */
                qed
              qed
            next
              case Journalist_Send_case_48
              solve( !KU( ~j_dh_sk ) @ #vk.33 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_49
              solve( !KU( ~j_dh_sk.1 ) @ #vk.36 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.34 )
                  case PQAttacker
                  by contradiction /* cyclic */
                next
                  case Reveal_Source_DH_Key
                  by contradiction /* from formulas */
                next
                  case c_kdf
                  by solve( !KU( ~passphrase ) @ #vk.44 )
                qed
              qed
            next
              case Journalist_Send_case_50
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.28 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.38 )
              qed
            next
              case Register_Source_Passphrase
              solve( !KU( ~j_dh_sk ) @ #vk.27 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Source_Send_case_1
              solve( !KU( ~j_dh_sk ) @ #vk.41 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Source_Send_case_2
              solve( !KU( ~j_dh_sk ) @ #vk.41 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case c_exp
              solve( !KU( ~j_dh_sk ) @ #vk.29 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      next
        case Journalist_Send
        solve( !KU( H(kdf(<'g'^(~j_dh_sk*kdf(<'DH', ~passphrase>)), z, 
                           c_dhkem, 'g'^kdf(<'DH', ~passphrase>), 'g'^~j_dh_sk>),
                      c_dhkem, z.1, c_pq)
               ) @ #vk.6 )
          case c_H
          solve( !KU( kdf(<'g'^(~j_dh_sk*kdf(<'DH', ~passphrase>)), z, 
                           c_dhkem, 'g'^kdf(<'DH', ~passphrase>), 'g'^~j_dh_sk>)
                 ) @ #vk.25 )
            case c_kdf
            solve( !KU( 'g'^(~j_dh_sk*kdf(<'DH', ~passphrase>)) ) @ #vk.32 )
              case Journalist_Enrollment
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.35 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.38 )
              qed
            next
              case Journalist_Send_case_01
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.36 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.42 )
              qed
            next
              case Journalist_Send_case_02
              solve( !KU( kdf(<
                               'g'^(~j_dh_sk*~j_dh_sk.1*kdf(<'DH', ~passphrase>)), 
                               'g'^(~j_dh_sk*~me_sk.1*kdf(<'DH', ~passphrase>)), 'g'^~me_sk.1, 
                               'g'^(~j_dh_sk*kdf(<'DH', ~passphrase>)), 'g'^~j_dh_sk.1>)
                     ) @ #vk.39 )
                case c_kdf
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_03
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.39 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.46 )
              qed
            next
              case Journalist_Send_case_04
              solve( !KU( ~j_dh_sk ) @ #vk.39 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_05
              solve( !KU( kdf(<
                               'g'^(~j_dh_sk*~j_dh_sk.1*x.1*kdf(<'DH', ~passphrase>)), 
                               'g'^(~j_dh_sk*~me_sk.1*x.1*kdf(<'DH', ~passphrase>)), 
                               'g'^~me_sk.1, 'g'^(~j_dh_sk*x.1*kdf(<'DH', ~passphrase>)), 
                               'g'^~j_dh_sk.1>)
                     ) @ #vk.41 )
                case c_kdf
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_06
              solve( !KU( kdf(<
                               'g'^(~j_dh_sk*~j_dh_sk.1*inv(x.1)*kdf(<'DH', ~passphrase>)), 
                               'g'^(~j_dh_sk*~me_sk.1*inv(x.1)*kdf(<'DH', ~passphrase>)), 
                               'g'^~me_sk.1, 'g'^(~j_dh_sk*inv(x.1)*kdf(<'DH', ~passphrase>)), 
                               'g'^~j_dh_sk.1>)
                     ) @ #vk.40 )
                case c_kdf
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_07
              solve( !KU( ~j_dh_sk ) @ #vk.40 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_08
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.40 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.49 )
              qed
            next
              case Journalist_Send_case_09
              solve( !KU( ~j_dh_sk ) @ #vk.41 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_10
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.41 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.48 )
              qed
            next
              case Journalist_Send_case_11
              solve( !KU( kdf(<
                               'g'^(~j_dh_sk*~j_dh_sk.1*x.1*inv(x.2)*kdf(<'DH', ~passphrase>)), 
                               'g'^(~j_dh_sk*~me_sk.1*x.1*inv(x.2)*kdf(<'DH', ~passphrase>)), 
                               'g'^~me_sk.1, 
                               'g'^(~j_dh_sk*x.1*inv(x.2)*kdf(<'DH', ~passphrase>)), 
                               'g'^~j_dh_sk.1>)
                     ) @ #vk.43 )
                case c_kdf
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_12
              solve( !KU( ~j_dh_sk ) @ #vk.41 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_13
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.41 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.50 )
              qed
            next
              case Journalist_Send_case_14
              solve( !KU( kdf(<
                               'g'^(~j_dh_sk*~j_dh_sk.1*inv(~me_sk.1)*kdf(<'DH', ~passphrase>)), 
                               'g'^(~j_dh_sk*kdf(<'DH', ~passphrase>)), 'g'^~me_sk.1, 
                               'g'^(~j_dh_sk*inv(~me_sk.1)*kdf(<'DH', ~passphrase>)), 
                               'g'^~j_dh_sk.1>)
                     ) @ #vk.40 )
                case c_kdf
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_15
              solve( !KU( ~j_dh_sk ) @ #vk.41 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_16
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.41 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.48 )
              qed
            next
              case Journalist_Send_case_17
              solve( !KU( kdf(<
                               'g'^(~j_dh_sk*~j_dh_sk.1*x.1*inv(~me_sk.1)*kdf(<'DH', ~passphrase>)
                                   ), 
                               'g'^(~j_dh_sk*x.1*kdf(<'DH', ~passphrase>)), 'g'^~me_sk.1, 
                               'g'^(~j_dh_sk*x.1*inv(~me_sk.1)*kdf(<'DH', ~passphrase>)), 
                               'g'^~j_dh_sk.1>)
                     ) @ #vk.43 )
                case c_kdf
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_18
              solve( !KU( ~j_dh_sk ) @ #vk.41 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_19
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.41 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.50 )
              qed
            next
              case Journalist_Send_case_20
              solve( !KU( kdf(<
                               'g'^(~j_dh_sk*~j_dh_sk.1*inv((~me_sk.1*x.1))*
                                    kdf(<'DH', ~passphrase>)), 
                               'g'^(~j_dh_sk*inv(x.1)*kdf(<'DH', ~passphrase>)), 'g'^~me_sk.1, 
                               'g'^(~j_dh_sk*inv((~me_sk.1*x.1))*kdf(<'DH', ~passphrase>)), 
                               'g'^~j_dh_sk.1>)
                     ) @ #vk.42 )
                case c_kdf
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_21
              solve( !KU( ~j_dh_sk ) @ #vk.41 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_22
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.41 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.50 )
              qed
            next
              case Journalist_Send_case_23
              solve( !KU( kdf(<
                               'g'^(~j_dh_sk*~j_dh_sk.1*x.1*inv((~me_sk.1*x.2))*
                                    kdf(<'DH', ~passphrase>)), 
                               'g'^(~j_dh_sk*x.1*inv(x.2)*kdf(<'DH', ~passphrase>)), 
                               'g'^~me_sk.1, 
                               'g'^(~j_dh_sk*x.1*inv((~me_sk.1*x.2))*kdf(<'DH', ~passphrase>)), 
                               'g'^~j_dh_sk.1>)
                     ) @ #vk.45 )
                case c_kdf
                by contradiction /* cyclic */
              qed
            next
              case Journalist_Send_case_24
              solve( !KU( ~j_dh_sk ) @ #vk.41 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_25
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.41 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.52 )
              qed
            next
              case Journalist_Send_case_26
              solve( !KU( ~j_dh_sk.1 ) @ #vk.39 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'g'^(~j_dh_sk*kdf(<'DH', ~passphrase>)), 
                                 'g'^(~j_dh_sk*~me_sk.1*inv(~j_dh_sk.1)*kdf(<'DH', ~passphrase>)), 
                                 'g'^~me_sk.1, 
                                 'g'^(~j_dh_sk*inv(~j_dh_sk.1)*kdf(<'DH', ~passphrase>)), 
                                 'g'^~j_dh_sk.1>)
                       ) @ #vk.40 )
                  case c_kdf
                  by contradiction /* cyclic */
                qed
              qed
            next
              case Journalist_Send_case_27
              solve( !KU( ~j_dh_sk.1 ) @ #vk.40 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( ~j_dh_sk ) @ #vk.41 )
                  case PQAttacker
                  by contradiction /* cyclic */
                next
                  case Reveal_Journalist_DH_Key
                  by contradiction /* from formulas */
                qed
              qed
            next
              case Journalist_Send_case_28
              solve( !KU( ~j_dh_sk.1 ) @ #vk.40 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.41 )
                  case PQAttacker
                  by contradiction /* cyclic */
                next
                  case Reveal_Source_DH_Key
                  by contradiction /* from formulas */
                next
                  case c_kdf
                  by solve( !KU( ~passphrase ) @ #vk.48 )
                qed
              qed
            next
              case Journalist_Send_case_29
              solve( !KU( ~j_dh_sk.1 ) @ #vk.40 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'g'^(~j_dh_sk*x*kdf(<'DH', ~passphrase>)), 
                                 'g'^(~j_dh_sk*x*~me_sk.1*inv(~j_dh_sk.1)*kdf(<'DH', ~passphrase>)
                                     ), 
                                 'g'^~me_sk.1, 
                                 'g'^(~j_dh_sk*x*inv(~j_dh_sk.1)*kdf(<'DH', ~passphrase>)), 
                                 'g'^~j_dh_sk.1>)
                       ) @ #vk.43 )
                  case c_kdf
                  by contradiction /* cyclic */
                qed
              qed
            next
              case Journalist_Send_case_30
              solve( !KU( ~j_dh_sk.1 ) @ #vk.40 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( ~j_dh_sk ) @ #vk.41 )
                  case PQAttacker
                  by contradiction /* cyclic */
                next
                  case Reveal_Journalist_DH_Key
                  by contradiction /* from formulas */
                qed
              qed
            next
              case Journalist_Send_case_31
              solve( !KU( ~j_dh_sk.1 ) @ #vk.40 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.41 )
                  case PQAttacker
                  by contradiction /* cyclic */
                next
                  case Reveal_Source_DH_Key
                  by contradiction /* from formulas */
                next
                  case c_kdf
                  by solve( !KU( ~passphrase ) @ #vk.50 )
                qed
              qed
            next
              case Journalist_Send_case_32
              solve( !KU( ~j_dh_sk.1 ) @ #vk.40 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<
                                 'g'^(~j_dh_sk*inv(~me_sk.1)*kdf(<'DH', ~passphrase>)), 
                                 'g'^(~j_dh_sk*inv(~j_dh_sk.1)*kdf(<'DH', ~passphrase>)), 
                                 'g'^~me_sk.1, 
                                 'g'^(~j_dh_sk*inv((~j_dh_sk.1*~me_sk.1))*kdf(<'DH', ~passphrase>)
                                     ), 
                                 'g'^~j_dh_sk.1>)
                       ) @ #vk.42 )
                  case c_kdf
                  by contradiction /* cyclic */
                qed
              qed
            next
              case Journalist_Send_case_33
              solve( !KU( ~j_dh_sk ) @ #vk.41 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_34
              solve( !KU( ~j_dh_sk.1 ) @ #vk.42 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.42 )
                  case PQAttacker
                  by contradiction /* cyclic */
                next
                  case Reveal_Source_DH_Key
                  by contradiction /* from formulas */
                next
                  case c_kdf
                  by solve( !KU( ~passphrase ) @ #vk.50 )
                qed
              qed
            next
              case Journalist_Send_case_35
              solve( !KU( ~j_dh_sk.1 ) @ #vk.43 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<
                                 'g'^(~j_dh_sk*x*inv(~me_sk.1)*kdf(<'DH', ~passphrase>)), 
                                 'g'^(~j_dh_sk*x*inv(~j_dh_sk.1)*kdf(<'DH', ~passphrase>)), 
                                 'g'^~me_sk.1, 
                                 'g'^(~j_dh_sk*x*inv((~j_dh_sk.1*~me_sk.1))*kdf(<'DH', ~passphrase>)
                                     ), 
                                 'g'^~j_dh_sk.1>)
                       ) @ #vk.45 )
                  case c_kdf
                  by contradiction /* cyclic */
                qed
              qed
            next
              case Journalist_Send_case_36
              solve( !KU( ~j_dh_sk ) @ #vk.41 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_37
              solve( !KU( ~j_dh_sk.1 ) @ #vk.44 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.42 )
                  case PQAttacker
                  by contradiction /* cyclic */
                next
                  case Reveal_Source_DH_Key
                  by contradiction /* from formulas */
                next
                  case c_kdf
                  by solve( !KU( ~passphrase ) @ #vk.52 )
                qed
              qed
            next
              case Journalist_Send_case_38
              solve( !KU( ~j_dh_sk.1 ) @ #vk.40 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<
                                 'g'^(~j_dh_sk*inv((x*~me_sk.1))*kdf(<'DH', ~passphrase>)), 
                                 'g'^(~j_dh_sk*inv((x*~j_dh_sk.1))*kdf(<'DH', ~passphrase>)), 
                                 'g'^~me_sk.1, 
                                 'g'^(~j_dh_sk*inv((x*~j_dh_sk.1*~me_sk.1))*kdf(<'DH', ~passphrase>)
                                     ), 
                                 'g'^~j_dh_sk.1>)
                       ) @ #vk.43 )
                  case c_kdf
                  by contradiction /* cyclic */
                qed
              qed
            next
              case Journalist_Send_case_39
              solve( !KU( ~j_dh_sk ) @ #vk.41 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_40
              solve( !KU( ~j_dh_sk.1 ) @ #vk.42 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.42 )
                  case PQAttacker
                  by contradiction /* cyclic */
                next
                  case Reveal_Source_DH_Key
                  by contradiction /* from formulas */
                next
                  case c_kdf
                  by solve( !KU( ~passphrase ) @ #vk.51 )
                qed
              qed
            next
              case Journalist_Send_case_41
              solve( !KU( ~j_dh_sk.1 ) @ #vk.43 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<
                                 'g'^(~j_dh_sk*x*inv((~me_sk.1*x.1))*kdf(<'DH', ~passphrase>)), 
                                 'g'^(~j_dh_sk*x*inv((~j_dh_sk.1*x.1))*kdf(<'DH', ~passphrase>)), 
                                 'g'^~me_sk.1, 
                                 'g'^(~j_dh_sk*x*inv((~j_dh_sk.1*~me_sk.1*x.1))*
                                      kdf(<'DH', ~passphrase>)), 
                                 'g'^~j_dh_sk.1>)
                       ) @ #vk.46 )
                  case c_kdf
                  by contradiction /* cyclic */
                qed
              qed
            next
              case Journalist_Send_case_42
              solve( !KU( ~j_dh_sk ) @ #vk.41 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_43
              solve( !KU( ~j_dh_sk.1 ) @ #vk.44 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.42 )
                  case PQAttacker
                  by contradiction /* cyclic */
                next
                  case Reveal_Source_DH_Key
                  by contradiction /* from formulas */
                next
                  case c_kdf
                  by solve( !KU( ~passphrase ) @ #vk.53 )
                qed
              qed
            next
              case Journalist_Send_case_44
              solve( !KU( ~j_dh_sk.1 ) @ #vk.40 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'g'^(~j_dh_sk*inv(x)*kdf(<'DH', ~passphrase>)), 
                                 'g'^(~j_dh_sk*~me_sk.1*inv((x*~j_dh_sk.1))*kdf(<'DH', ~passphrase>)
                                     ), 
                                 'g'^~me_sk.1, 
                                 'g'^(~j_dh_sk*inv((x*~j_dh_sk.1))*kdf(<'DH', ~passphrase>)), 
                                 'g'^~j_dh_sk.1>)
                       ) @ #vk.42 )
                  case c_kdf
                  by contradiction /* cyclic */
                qed
              qed
            next
              case Journalist_Send_case_45
              solve( !KU( ~j_dh_sk ) @ #vk.41 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_46
              solve( !KU( ~j_dh_sk.1 ) @ #vk.42 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.42 )
                  case PQAttacker
                  by contradiction /* cyclic */
                next
                  case Reveal_Source_DH_Key
                  by contradiction /* from formulas */
                next
                  case c_kdf
                  by solve( !KU( ~passphrase ) @ #vk.50 )
                qed
              qed
            next
              case Journalist_Send_case_47
              solve( !KU( ~j_dh_sk.1 ) @ #vk.43 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<
                                 'g'^(~j_dh_sk*x*inv(x.1)*kdf(<'DH', ~passphrase>)), 
                                 'g'^(~j_dh_sk*x*~me_sk.1*inv((~j_dh_sk.1*x.1))*
                                      kdf(<'DH', ~passphrase>)), 
                                 'g'^~me_sk.1, 
                                 'g'^(~j_dh_sk*x*inv((~j_dh_sk.1*x.1))*kdf(<'DH', ~passphrase>)), 
                                 'g'^~j_dh_sk.1>)
                       ) @ #vk.45 )
                  case c_kdf
                  by contradiction /* cyclic */
                qed
              qed
            next
              case Journalist_Send_case_48
              solve( !KU( ~j_dh_sk ) @ #vk.41 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Journalist_Send_case_49
              solve( !KU( ~j_dh_sk.1 ) @ #vk.44 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.42 )
                  case PQAttacker
                  by contradiction /* cyclic */
                next
                  case Reveal_Source_DH_Key
                  by contradiction /* from formulas */
                next
                  case c_kdf
                  by solve( !KU( ~passphrase ) @ #vk.52 )
                qed
              qed
            next
              case Journalist_Send_case_50
              solve( !KU( kdf(<'DH', ~passphrase>) ) @ #vk.35 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Source_DH_Key
                by contradiction /* from formulas */
              next
                case c_kdf
                by solve( !KU( ~passphrase ) @ #vk.38 )
              qed
            next
              case Register_Source_Passphrase
              solve( !KU( ~j_dh_sk ) @ #vk.35 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Source_Send_case_1
              solve( !KU( ~j_dh_sk ) @ #vk.49 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case Source_Send_case_2
              solve( !KU( ~j_dh_sk ) @ #vk.49 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            next
              case c_exp
              solve( !KU( ~j_dh_sk ) @ #vk.37 )
                case PQAttacker
                by contradiction /* cyclic */
              next
                case Reveal_Journalist_DH_Key
                by contradiction /* from formulas */
              qed
            qed
          qed
        qed
      next
        case c_sign
        solve( !KU( ~ltk ) @ #vk.19 )
          case PQAttacker
          by contradiction /* cyclic */
        next
          case Reveal_Newsroom_Key
          by contradiction /* from formulas */
        qed
      qed
    qed
  qed
qed

































/*
WARNING: the following wellformedness checks failed!

Derivation Checks
=================

  Derivation checks timed out. Use --derivcheck-timeout=INT to configure timeout, 0 to deactivate.
*/

/*
Generated from:
Tamarin version 1.8.0
Maude version 2.7.1
Git revision: UNKNOWN, branch: UNKNOWN
Compiled at: 2023-08-30 13:15:41.590881948 UTC
*/

end